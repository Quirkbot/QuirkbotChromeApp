var requirejs,require,define;(function(e){function h(e,t){return f.call(e,t)}function p(e,t){var n,r,i,s,o,a,f,l,h,p,d,v=t&&t.split("/"),m=u.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,u.nodeIdCompat&&c.test(e[o])&&(e[o]=e[o].replace(c,"")),e=v.concat(e);for(h=0;h<e.length;h+=1){d=e[h];if(d===".")e.splice(h,1),h-=1;else if(d===".."){if(h===1&&(e[2]===".."||e[0]===".."))break;h>0&&(e.splice(h-1,2),h-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(h=n.length;h>0;h-=1){r=n.slice(0,h).join("/");if(v)for(p=v.length;p>0;p-=1){i=m[v.slice(0,p).join("/")];if(i){i=i[r];if(i){s=i,a=h;break}}}if(s)break;!f&&g&&g[r]&&(f=g[r],l=h)}!s&&f&&(s=f,a=l),s&&(n.splice(0,a,s),e=n.join("/"))}return e}function d(t,r){return function(){var i=l.call(arguments,0);return typeof i[0]!="string"&&i.length===1&&i.push(null),n.apply(e,i.concat([t,r]))}}function v(e){return function(t){return p(t,e)}}function m(e){return function(t){s[e]=t}}function g(n){if(h(o,n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!h(s,n)&&!h(a,n))throw new Error("No "+n);return s[n]}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function b(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=Object.prototype.hasOwnProperty,l=[].slice,c=/\.js$/;r=function(e,t){var n,r=y(e),i=r[0];return e=r[1],i&&(i=p(i,t),n=g(i)),i?n&&n.normalize?e=n.normalize(e,v(t)):e=p(e,t):(e=p(e,t),r=y(e),i=r[0],e=r[1],i&&(n=g(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return d(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:b(e)}}},t=function(t,n,u,f){var l,c,p,v,y,b=[],w=typeof u,E;f=f||t;if(w==="undefined"||w==="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(y=0;y<n.length;y+=1){v=r(n[y],f),c=v.f;if(c==="require")b[y]=i.require(t);else if(c==="exports")b[y]=i.exports(t),E=!0;else if(c==="module")l=b[y]=i.module(t);else if(h(s,c)||h(o,c)||h(a,c))b[y]=g(c);else{if(!v.p)throw new Error(t+" missing "+c);v.p.load(v.n,d(f,!0),m(c),{}),b[y]=s[c]}}p=u?u.apply(s[t],b):undefined;if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(p!==e||!E)s[t]=p}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){if(typeof s=="string")return i[s]?i[s](o):g(r(s,o).f);if(!s.splice){u=s,u.deps&&n(u.deps,u.callback);if(!o)return;o.splice?(s=o,o=a,a=null):s=e}return o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},4),n},n.config=function(e){return n(e)},requirejs._defined=s,define=function(e,t,n){t.splice||(n=t,t=[]),!h(s,e)&&!h(o,e)&&(o[e]=[e,t,n])},define.amd={jQuery:!0}})(),define("almond",function(){}),define("happy/app/BaseApp",[],function(){var e=function(){var e=this,t=function(){};e.container=document.body,e.setup=t,e.update=t,e.draw=t,e.onKeyUp=t,e.onKeyDown=t,e.onMouseOver=t,e.onMouseOut=t,e.onMouseDown=t,e.onMouseUp=t,e.onMouseMove=t,e.onClick=t,e.onDoubleClick=t,e.onResize=t,e.onReposition=t};return e}),define("happy/utils/Network",[],function(){var e=function(){var e=this,t=function(e){if(!e)return;if(!e.url)return;e.method=e.method||"GET",e.headers=e.headers||{};var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}if(!t)return;t.onload=function(){t.status===200?e.onSuccess&&e.onSuccess.apply(e.context,[t]):e.onError&&e.onError.apply(e.context,[t])},t.onerror=function(){e.onError&&e.onError.apply(e.context,[t])},t.onabort=function(){e.onError&&e.onError.apply(e.context,[t])},t.ontimeout=function(){e.onError&&e.onError.apply(e.context,[t])},e.responseType&&(t.responseType=e.responseType),t.open(e.method,e.url);for(key in e.headers)t.setRequestHeader(key,e.headers[key]);t.send(e.data)};Object.defineProperty(e,"ajax",{value:t})};return e}),function(e){function t(e,t,n,r,i){this._listener=t,this._isOnce=n,this.context=r,this._signal=e,this._priority=i||0}function n(e,t){if(typeof e!="function")throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function r(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){r.prototype.dispatch.apply(e,arguments)}}t.prototype={active:!0,params:null,execute:function(e){var t,n;return this.active&&!!this._listener&&(n=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},r.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(e,n,r,i){var s=this._indexOfListener(e,r),o;if(s!==-1){o=this._bindings[s];if(o.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else o=new t(this,e,n,r,i),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(e){var t=this._bindings.length;do--t;while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){var n=this._bindings.length,r;while(n--){r=this._bindings[n];if(r._listener===e&&r.context===t)return n}return-1},has:function(e,t){return this._indexOfListener(e,t)!==-1},add:function(e,t,r){return n(e,"add"),this._registerListener(e,!1,t,r)},addOnce:function(e,t,r){return n(e,"addOnce"),this._registerListener(e,!0,t,r)},remove:function(e,t){n(e,"remove");var r=this._indexOfListener(e,t);return r!==-1&&(this._bindings[r]._destroy(),this._bindings.splice(r,1)),e},removeAll:function(){var e=this._bindings.length;while(e--)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(!this.active)return;var t=Array.prototype.slice.call(arguments),n=this._bindings.length,r;this.memorize&&(this._prevParams=t);if(!n)return;r=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(r[n]&&this._shouldPropagate&&r[n].execute(t)!==!1)},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var i=r;i.Signal=r,typeof define=="function"&&define.amd?define("happy/_libs/signals",[],function(){return i}):typeof module!="undefined"&&module.exports?module.exports=i:e.signals=i}(this),define("happy/polyfill/console",[],function(){return window.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}}}),define("happy/_libs/mout/array/forEach",[],function(){function e(e,t,n){if(e==null)return;var r=-1,i=e.length;while(++r<i)if(t.call(n,e[r],r,e)===!1)break}return e}),define("happy/_libs/mout/array/indexOf",[],function(){function e(e,t,n){n=n||0;if(e==null)return-1;var r=e.length,i=n<0?r+n:n;while(i<r){if(e[i]===t)return i;i++}return-1}return e}),define("happy/_libs/mout/array/combine",["./indexOf"],function(e){function t(t,n){if(n==null)return t;var r=-1,i=n.length;while(++r<i)e(t,n[r])===-1&&t.push(n[r]);return t}return t}),define("happy/_libs/mout/lang/toString",[],function(){function e(e){return e==null?"":e.toString()}return e}),define("happy/_libs/mout/string/replaceAccents",["../lang/toString"],function(e){function t(t){return t=e(t),t.search(/[\xC0-\xFF]/g)>-1&&(t=t.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),t}return t}),define("happy/_libs/mout/string/removeNonWord",["../lang/toString"],function(e){function t(t){return t=e(t),t.replace(/[^0-9a-zA-Z\xC0-\xFF \-_]/g,"")}return t}),define("happy/_libs/mout/string/upperCase",["../lang/toString"],function(e){function t(t){return t=e(t),t.toUpperCase()}return t}),define("happy/_libs/mout/string/lowerCase",["../lang/toString"],function(e){function t(t){return t=e(t),t.toLowerCase()}return t}),define("happy/_libs/mout/string/camelCase",["../lang/toString","./replaceAccents","./removeNonWord","./upperCase","./lowerCase"],function(e,t,n,r,i){function s(s){return s=e(s),s=t(s),s=n(s).replace(/[\-_]/g," ").replace(/\s[a-z]/g,r).replace(/\s+/g,"").replace(/^[A-Z]/g,i),s}return s}),define("happy/_libs/mout/string/pascalCase",["../lang/toString","./camelCase","./upperCase"],function(e,t,n){function r(r){return r=e(r),t(r).replace(/^[a-z]/,n)}return r}),define("happy/utils/Vendor",["../polyfill/console","../_libs/mout/array/forEach","../_libs/mout/array/combine","../_libs/mout/string/pascalCase"],function(e,t,n,r){var i=["WebKit","Moz","O","Ms"],s=[],o=[];t(i,function(e){s.push(r(e)),o.push(e.toLowerCase())});var u=n(s,o),a=function(){var t=this,n=function(t,n){if(!t)return;var i=r(t);n=n||window;var s=t,o=n[s];if(typeof o=="undefined")for(var a=0;a<u.length;a++){s=u[a]+i,o=n[s];if(typeof o!="undefined")break}if(typeof o=="undefined"){e.log(t+" is not implemented.");return}return{name:s,context:n}},i=function(e,t){var r=n(e,t);if(!r)return;return function(){r.context[r.name].apply(r.context,arguments)}},s=function(e,t){var r=n(e,t);if(!r)return;return r.context[r.name]},o=function(e,t){var r=n(e,t);if(!r)return;return r.name};Object.defineProperty(t,"validateMethod",{value:i}),Object.defineProperty(t,"validateConstructor",{value:s}),Object.defineProperty(t,"validateName",{value:o})};return a}),define("Tree",["happy/_libs/signals","happy/utils/Vendor"],function(e,t){var n=new t,r=n.validateMethod("requestAnimationFrame"),i=function(){var t=this,n={},i={},s,o,u,a,f,l=function(){s=new e,o=new e,u=new e,a=new e,r(c)},c=function(){r(c);for(var e in i)if(!t.source[e]){for(var n in i[e])a.dispatch({to:e+"."+n,from:i[e][n]});o.dispatch(e)}for(var e in t.source)if(!i[e]){s.dispatch(e);for(var n in t.source[e])u.dispatch({to:e+"."+n,from:t.source[e][n]})}else{for(var n in i[e])t.source[e][n]||a.dispatch({to:e+"."+n,from:i[e][n]});for(var n in t.source[e])i[e][n]?JSON.stringify(i[e][n])!=JSON.stringify(t.source[e][n])&&(a.dispatch({to:e+"."+n,from:i[e][n]}),u.dispatch({to:e+"."+n,from:t.source[e][n]})):u.dispatch({to:e+"."+n,from:t.source[e][n]})}i=JSON.parse(JSON.stringify(t.source))},h=function(){return n},p=function(e){n=e},d=function(){return s},v=function(){return o},m=function(){return u},g=function(){return a};Object.defineProperty(t,"source",{get:h,set:p}),Object.defineProperty(t,"nodeAdded",{get:d}),Object.defineProperty(t,"nodeRemoved",{get:v}),Object.defineProperty(t,"connectionAdded",{get:m}),Object.defineProperty(t,"connectionRemoved",{get:g}),l()};return i}),define("jsPlumb",[],function(){return function(){typeof Math.sgn=="undefined"&&(Math.sgn=function(e){return e==0?0:e>0?1:-1});var e={subtract:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},dotProduct:function(e,t){return e.x*t.x+e.y*t.y},square:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},scale:function(e,t){return{x:e.x*t,y:e.y*t}}},t=64,n=Math.pow(2,-t-1),r=function(t,n){var r=[],i=s(t,n),u=n.length-1,a=2*u-1,f=o(i,a,r,0),c=e.subtract(t,n[0]),h=e.square(c),p=0;for(var d=0;d<f;d++){c=e.subtract(t,l(n,u,r[d],null,null));var v=e.square(c);v<h&&(h=v,p=r[d])}return c=e.subtract(t,n[u]),v=e.square(c),v<h&&(h=v,p=1),{location:p,distance:h}},i=function(e,t){var n=r(e,t);return{point:l(t,t.length-1,n.location,null,null),location:n.location}},s=function(t,n){var r=n.length-1,i=2*r-1,s=[],o=[],u=[],a=[],f=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];for(var l=0;l<=r;l++)s[l]=e.subtract(n[l],t);for(var l=0;l<=r-1;l++)o[l]=e.subtract(n[l+1],n[l]),o[l]=e.scale(o[l],3);for(var c=0;c<=r-1;c++)for(var h=0;h<=r;h++)u[c]||(u[c]=[]),u[c][h]=e.dotProduct(o[c],s[h]);for(l=0;l<=i;l++)a[l]||(a[l]=[]),a[l].y=0,a[l].x=parseFloat(l)/i;var p=r,d=r-1;for(var v=0;v<=p+d;v++){var m=Math.max(0,v-d),g=Math.min(v,p);for(l=m;l<=g;l++)j=v-l,a[l+j].y+=u[j][l]*f[j][l]}return a},o=function(e,n,r,i){var s=[],c=[],h,p,d=[],v=[];switch(u(e,n)){case 0:return 0;case 1:if(i>=t)return r[0]=(e[0].x+e[n].x)/2,1;if(a(e,n))return r[0]=f(e,n),1}l(e,n,.5,s,c),h=o(s,n,d,i+1),p=o(c,n,v,i+1);for(var m=0;m<h;m++)r[m]=d[m];for(var m=0;m<p;m++)r[m+h]=v[m];return h+p},u=function(e,t){var n=0,r,i;r=i=Math.sgn(e[0].y);for(var s=1;s<=t;s++)r=Math.sgn(e[s].y),r!=i&&n++,i=r;return n},a=function(e,t){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;a=e[0].y-e[t].y,f=e[t].x-e[0].x,l=e[0].x*e[t].y-e[t].x*e[0].y;var b=max_distance_below=0;for(var w=1;w<t;w++){var E=a*e[w].x+f*e[w].y+l;E>b?b=E:E<max_distance_below&&(max_distance_below=E)}return p=0,d=1,v=0,m=a,g=f,y=l-b,c=p*g-m*d,h=1/c,i=(d*y-g*v)*h,m=a,g=f,y=l-max_distance_below,c=p*g-m*d,h=1/c,s=(d*y-g*v)*h,o=Math.min(i,s),u=Math.max(i,s),r=u-o,r<n?1:0},f=function(e,t){var n=1,r=0,i=e[t].x-e[0].x,s=e[t].y-e[0].y,o=e[0].x-0,u=e[0].y-0,a=i*r-s*n,f=1/a,l=(i*u-s*o)*f;return 0+n*l},l=function(e,t,n,r,i){var s=[[]];for(var o=0;o<=t;o++)s[0][o]=e[o];for(var u=1;u<=t;u++)for(var o=0;o<=t-u;o++)s[u]||(s[u]=[]),s[u][o]||(s[u][o]={}),s[u][o].x=(1-n)*s[u-1][o].x+n*s[u-1][o+1].x,s[u][o].y=(1-n)*s[u-1][o].y+n*s[u-1][o+1].y;if(r!=null)for(o=0;o<=t;o++)r[o]=s[o][0];if(i!=null)for(o=0;o<=t;o++)i[o]=s[t-o][o];return s[t][0]},c={},h=function(e){var t=c[e];if(!t){t=[];var n=function(){return function(t){return Math.pow(t,e)}},r=function(){return function(t){return Math.pow(1-t,e)}},i=function(e){return function(t){return e}},s=function(){return function(e){return e}},o=function(){return function(e){return 1-e}},u=function(e){return function(t){var n=1;for(var r=0;r<e.length;r++)n*=e[r](t);return n}};t.push(new n);for(var a=1;a<e;a++){var f=[new i(e)];for(var l=0;l<e-a;l++)f.push(new s);for(var l=0;l<a;l++)f.push(new o);t.push(new u(f))}t.push(new r),c[e]=t}return t},p=function(e,t){var n=h(e.length-1),r=0,i=0;for(var s=0;s<e.length;s++)r+=e[s].x*n[s](t),i+=e[s].y*n[s](t);return{x:r,y:i}},d=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},v=function(e){return e[0].x==e[1].x&&e[0].y==e[1].y},m=function(e,t,n){if(v(e))return{point:e[0],location:t};var r=p(e,t),i=0,s=t,o=n>0?1:-1,u=null;while(i<Math.abs(n))s+=.005*o,u=p(e,s),i+=d(u,r),r=u;return{point:u,location:s}},g=function(e){if(v(e))return 0;var t=p(e,0),n=0,r=0,i=1,s=null;while(r<1)r+=.005*i,s=p(e,r),n+=d(s,t),t=s;return n},y=function(e,t,n){return m(e,t,n).point},b=function(e,t,n){return m(e,t,n).location},w=function(e,t){var n=p(e,t),r=p(e.slice(0,e.length-1),t),i=r.y-n.y,s=r.x-n.x;return i==0?Infinity:Math.atan(i/s)},E=function(e,t,n){var r=m(e,t,n);return r.location>1&&(r.location=1),r.location<0&&(r.location=0),w(e,r.location)},S=function(e,t,n,r){r=r==null?0:r;var i=m(e,t,r),s=w(e,i.location),o=Math.atan(-1/s),u=n/2*Math.sin(o),a=n/2*Math.cos(o);return[{x:i.point.x+a,y:i.point.y+u},{x:i.point.x-a,y:i.point.y-u}]},x=window.jsBezier={distanceFromCurve:r,gradientAtPoint:w,gradientAtPointAlongCurveFrom:E,nearestPointOnCurve:i,pointOnCurve:p,pointAlongCurveFrom:y,perpendicularToCurveAt:S,locationAlongCurveFrom:b,getLength:g}}(),function(){var e=this.Biltong={},t=function(e){return Object.prototype.toString.call(e)==="[object Array]"},n=function(e,n,r){return e=t(e)?e:[e.x,e.y],n=t(n)?n:[n.x,n.y],r(e,n)},r=e.gradient=function(e,t){return n(e,t,function(e,t){return t[0]==e[0]?t[1]>e[1]?Infinity:-Infinity:t[1]==e[1]?t[0]>e[0]?0:0:(t[1]-e[1])/(t[0]-e[0])})},i=e.normal=function(e,t){return-1/r(e,t)},s=e.lineLength=function(e,t){return n(e,t,function(e,t){return Math.sqrt(Math.pow(t[1]-e[1],2)+Math.pow(t[0]-e[0],2))})},o=e.quadrant=function(e,t){return n(e,t,function(e,t){return t[0]>e[0]?t[1]>e[1]?2:1:t[0]==e[0]?t[1]>e[1]?2:1:t[1]>e[1]?3:4})},u=e.theta=function(e,t){return n(e,t,function(e,t){var n=r(e,t),i=Math.atan(n),s=o(e,t);if(s==4||s==3)i+=Math.PI;return i<0&&(i+=2*Math.PI),i})},a=e.intersects=function(e,t){var n=e.x,r=e.x+e.w,i=e.y,s=e.y+e.h,o=t.x,u=t.x+t.w,a=t.y,f=t.y+t.h;return n<=o&&o<=r&&i<=a&&a<=s||n<=u&&u<=r&&i<=a&&a<=s||n<=o&&o<=r&&i<=f&&f<=s||n<=u&&o<=r&&i<=f&&f<=s||o<=n&&n<=u&&a<=i&&i<=f||o<=r&&r<=u&&a<=i&&i<=f||o<=n&&n<=u&&a<=s&&s<=f||o<=r&&n<=u&&a<=s&&s<=f},f=e.encloses=function(e,t,n){var r=e.x,i=e.x+e.w,s=e.y,o=e.y+e.h,u=t.x,a=t.x+t.w,f=t.y,l=t.y+t.h,c=function(e,t,r,i){return n?e<=t&&r>=i:e<t&&r>i};return c(r,u,i,a)&&c(s,f,o,l)},l=[null,[1,-1],[1,1],[-1,1],[-1,-1]],c=[null,[-1,-1],[-1,1],[1,1],[1,-1]],h=e.pointOnLine=function(e,t,n){var i=r(e,t),s=o(e,t),u=n>0?l[s]:c[s],a=Math.atan(i),f=Math.abs(n*Math.sin(a))*u[1],h=Math.abs(n*Math.cos(a))*u[0];return{x:e.x+h,y:e.y+f}},p=e.perpendicularLineTo=function(e,t,n){var i=r(e,t),s=Math.atan(-1/i),o=n/2*Math.sin(s),u=n/2*Math.cos(s);return[{x:t.x+u,y:t.y+o},{x:t.x-u,y:t.y-o}]}}.call(this),function(){var e={android:navigator.userAgent.toLowerCase().indexOf("android")>-1},t=function(e,t,n){n=n||e.parentNode;var r=n.querySelectorAll(t);for(var i=0;i<r.length;i++)if(r[i]===e)return!0;return!1},n=function(e){return typeof e=="string"?document.getElementById(e):e},r=function(e){return e.srcElement||e.target},i=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]==t)break;n<e.length&&e.splice(n,1)},s=1,o=function(e,t,n){var r=s++;return e.__ta=e.__ta||{},e.__ta[t]=e.__ta[t]||{},e.__ta[t][r]=n,n.__tauid=r,r},u=function(e,t,n){e.__ta&&e.__ta[t]&&delete e.__ta[t][n.__tauid];if(n.__taExtra){for(var r=0;r<n.__taExtra.length;r++)B(e,n.__taExtra[r][0],n.__taExtra[r][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()},a=function(e,n,i,s){if(e==null)return i;var o=e.split(","),u=function(e){u.__tauid=i.__tauid;var s=r(e);for(var a=0;a<o.length;a++)t(s,o[a],n)&&i.apply(s,arguments)};return f(i,s,u),u},f=function(e,t,n){e.__taExtra=e.__taExtra||[],e.__taExtra.push([t,n])},l=function(e,t,n,r){m&&y[t]?H(e,y[t],a(r,e,n,y[t]),n):H(e,t,a(r,e,n,t),n)},c=function(e,t,n,s){if(e.__taSmartClicks==null){var o=function(t){e.__tad=A(t)},u=function(t){e.__tau=A(t)},a=function(t){if(e.__tad&&e.__tau&&e.__tad[0]===e.__tau[0]&&e.__tad[1]===e.__tau[1])for(var n=0;n<e.__taSmartClicks.length;n++)e.__taSmartClicks[n].apply(r(t),[t])};l(e,"mousedown",o,s),l(e,"mouseup",u,s),l(e,"click",a,s),e.__taSmartClicks=[]}e.__taSmartClicks.push(n),n.__taUnstore=function(){i(e.__taSmartClicks,n)}},h={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},p=function(e,t){return function(n,s,o,u){if(s=="contextmenu"&&g)l(n,s,o,u);else{if(n.__taTapHandler==null){var a=n.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0},f=function(n){a.down=!0,setTimeout(p,e),setTimeout(d,t)},c=function(e){if(a.down){a.taps++;var t=P(e);for(var n in h){var i=h[n];if(i.touches===t&&(i.taps===1||i.taps===a.taps))for(var s=0;s<a[n].length;s++)a[n][s].apply(r(e),[e])}}},p=function(){a.down=!1},d=function(){a.taps=0};l(n,"mousedown",f,u),l(n,"mouseup",c,u)}n.__taTapHandler[s].push(o),o.__taUnstore=function(){i(n.__taTapHandler[s],o)}}}},d=function(e,t,n,r){for(var i in n.__tamee[e])n.__tamee[e][i].apply(r,[t])},v=function(){var e=[];return function(n,i,s,u){if(!n.__tamee){n.__tamee={over:!1,mouseenter:[],mouseexit:[]};var f=function(i){var s=r(i);if(u==null&&s==n&&!n.__tamee.over||t(s,u,n)&&(s.__tamee==null||!s.__tamee.over))d("mouseenter",i,n,s),s.__tamee=s.__tamee||{},s.__tamee.over=!0,e.push(s)},l=function(i){var s=r(i);for(var o=0;o<e.length;o++)s==e[o]&&!t(i.relatedTarget||i.toElement,"*",s)&&(s.__tamee.over=!1,e.splice(o,1),d("mouseexit",i,n,s))};H(n,"mouseover",a(u,n,f,"mouseover"),f),H(n,"mouseout",a(u,n,l,"mouseout"),l)}s.__taUnstore=function(){delete n.__tamee[i][s.__tauid]},o(n,i,s),n.__tamee[i][s.__tauid]=s}},m="ontouchstart"in document.documentElement,g="onmousedown"in document.documentElement,y={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},b="touchstart",w="touchend",E="touchmove",S="__MottleDown",x="__MottleUp",T="__MottleContextDown",N="__MottleContextUp",C=function(){var e=-1;if(navigator.appName=="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(t)!=null&&(e=parseFloat(RegExp.$1))}return e}(),k=C>-1&&C<9,L=function(e,t){if(e==null)return[0,0];var n=D(e),r=_(n,0);return[r[t+"X"],r[t+"Y"]]},A=function(e){return e==null?[0,0]:k?[e.clientX+document.documentElement.scrollLeft,e.clientY+document.documentElement.scrollTop]:L(e,"page")},O=function(e){return L(e,"screen")},M=function(e){return L(e,"client")},_=function(e,t){return e.item?e.item(t):e[t]},D=function(e){return e.touches&&e.touches.length>0?e.touches:e.changedTouches&&e.changedTouches.length>0?e.changedTouches:e.targetTouches&&e.targetTouches.length>0?e.targetTouches:[e]},P=function(e){return D(e).length},H=function(e,t,n,r){o(e,t,n),r.__tauid=n.__tauid;if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent){var i=t+n.__tauid;e["e"+i]=n,e[i]=function(){e["e"+i]&&e["e"+i](window.event)},e.attachEvent("on"+t,e[i])}},B=function(e,t,r){if(r==null)return;F(e,function(){var e=n(this);u(e,t,r);if(r.__tauid!=null)if(e.removeEventListener)e.removeEventListener(t,r,!1);else if(this.detachEvent){var i=t+r.__tauid;e[i]&&e.detachEvent("on"+t,e[i]),e[i]=null,e["e"+i]=null}})},j=function(){},F=function(e,t){if(e==null)return;e=typeof e!="string"&&e.tagName==null&&e.length!=null?e:typeof e=="string"?document.querySelectorAll(e):[e];for(var n=0;n<e.length;n++)t.apply(e[n])};this.Mottle=function(t){t=t||{};var r=this,i=t.clickThreshold||150,s=t.dblClickThreshold||350,o=new v,u=new p(i,s),a=t.smartClicks,f=function(e,t,r,i){if(r==null)return;F(e,function(){var e=n(this);a&&t==="click"?c(e,t,r,i):t==="tap"||t==="dbltap"||t==="contextmenu"?u(e,t,r,i):t==="mouseenter"||t=="mouseexit"?o(e,t,r,i):l(e,t,r,i)})};this.remove=function(e){return F(e,function(){var e=n(this);if(e.__ta)for(var t in e.__ta)for(var r in e.__ta[t])B(e,t,e.__ta[t][r]);e.parentNode&&e.parentNode.removeChild(e)}),this},this.on=function(e,t,n,r){var i=arguments[0],s=arguments.length==4?arguments[2]:null,o=arguments[1],u=arguments[arguments.length-1];return f(i,o,u,s),this},this.off=function(e,t,n){return B(e,t,n),this},this.trigger=function(t,r,i,s){var o=m&&y[r]?y[r]:r,u=A(i),a=O(i),f=M(i);return F(t,function(){var t=n(this),l;i=i||{screenX:a[0],screenY:a[1],clientX:f[0],clientY:f[1]};var c=function(e){s&&(e.payload=s)},h={TouchEvent:function(e){var n=document.createTouch(window,t,0,u[0],u[1],a[0],a[1],f[0],f[1],0,0,0,0);e.initTouchEvent(o,!0,!0,window,0,a[0],a[1],f[0],f[1],!1,!1,!1,!1,document.createTouchList(n))},MouseEvents:function(n){n.initMouseEvent(o,!0,!0,window,0,a[0],a[1],f[0],f[1],!1,!1,!1,!1,1,t);if(e.android){var r=document.createTouch(window,t,0,u[0],u[1],a[0],a[1],f[0],f[1],0,0,0,0);n.touches=n.targetTouches=n.changedTouches=document.createTouchList(r)}}};if(document.createEvent){var p=m&&y[r]&&!e.android,d=p?"TouchEvent":"MouseEvents";l=document.createEvent(d),h[d](l),c(l),t.dispatchEvent(l)}else document.createEventObject&&(l=document.createEventObject(),l.eventType=l.eventName=o,l.screenX=a[0],l.screenY=a[1],l.clientX=f[0],l.clientY=f[1],c(l),t.fireEvent("on"+o,l))}),this}},Mottle.consume=function(e,t){e.stopPropagation?e.stopPropagation():e.returnValue=!1,!t&&e.preventDefault&&e.preventDefault()},Mottle.pageLocation=A}.call(this),function(){var e=function(e){var t=e.getBoundingClientRect(),n=document.body,r=document.documentElement,i=window.pageYOffset||r.scrollTop||n.scrollTop,s=window.pageXOffset||r.scrollLeft||n.scrollLeft,o=r.clientTop||n.clientTop||0,u=r.clientLeft||n.clientLeft||0,a=t.top+i-o,f=t.left+s-u;return{top:Math.round(a),left:Math.round(f)}},t=function(e,t,n){n=n||e.parentNode;var r=n.querySelectorAll(t);for(var i=0;i<r.length;i++)if(r[i]===e)return!0;return!1},n=function(){var e=-1;if(navigator.appName=="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(t)!=null&&(e=parseFloat(RegExp.$1))}return e}(),r=n>-1&&n<9,i=function(e){if(r)return[e.clientX+document.documentElement.scrollLeft,e.clientY+document.documentElement.scrollTop];var t=o(e),n=s(t,0);return[n.pageX,n.pageY]},s=function(e,t){return e.item?e.item(t):e[t]},o=function(e){return e.touches&&e.touches.length>0?e.touches:e.changedTouches&&e.changedTouches.length>0?e.changedTouches:e.targetTouches&&e.targetTouches.length>0?e.targetTouches:[e]},u={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select"},a="katavorio-drag-scope",f=["stop","start","drag","drop","over","out"],l=function(){},c=function(){return!0},h=function(e,t,n){for(var r=0;r<e.length;r++)e[r]!=n&&t(e[r])},p=function(e,t,n,r){h(e,function(e){e.setActive(t),t&&e.updatePosition(),n&&e.setHover(r,t)})},d=function(e,t){if(e==null)return;e=typeof e!="string"&&e.tagName==null&&e.length!=null?e:[e];for(var n=0;n<e.length;n++)t.apply(e[n])},v=function(e){e.stopPropagation?(e.stopPropagation(),e.preventDefault()):e.returnValue=!1},m="input,textarea,select,button",g=function(e,n,r){var i=e.srcElement||e.target;return!t(i,r.getInputFilterSelector(),n)},y=function(e,t,n,r){t.addClass(e,this._class),this.el=e;var i=!0;return this.setEnabled=function(e){i=e},this.isEnabled=function(){return i},this.toggleEnabled=function(){i=!i},this.setScope=function(e){this.scopes=e?e.split(/\s+/):[r]},this.setScope(t.scope),this.k=t.katavorio,t.katavorio},b=function(n,r,s,o){this._class=s.draggable;var u=y.apply(this,arguments),a=[0,0],f=null,l=!1,h=r.consumeStartEvent!==!1,d=n,m=r.clone,b=function(e){return r.grid==null?e:[r.grid[0]*Math.floor(e[0]/r.grid[0]),r.grid[1]*Math.floor(e[1]/r.grid[1])]},w=r.constrain||r.containment?function(e){var t={x:e[0],y:e[1],w:this.size[0],h:this.size[1]};return[Math.max(0,Math.min(T.w-this.size[0],e[0])),Math.max(0,Math.min(T.h-this.size[1],e[1]))]}.bind(this):function(e){return e},E=c,S=this.setFilter=function(e){e&&(E=function(r){var i=r.srcElement||r.target;return!t(i,e,n)})},x=r.canDrag||c,T,N=[],C=[],k=function(t){if(this.isEnabled()&&x()){var o=E(t)&&g(t,n,this.k);if(o){if(!m)d=n;else{d=n.cloneNode(!0),d.setAttribute("id",null),d.style.position="absolute";var l=e(n);d.style.left=l.left+"px",d.style.top=l.top+"px",document.body.appendChild(d)}h&&v(t),a=i(t),r.events.start({el:n,pos:f,e:t,drag:this}),r.bind(document,"mousemove",L),r.bind(document,"mouseup",A),u.markSelection(this),r.addClass(document.body,s.noSelect)}else r.consumeFilteredEvents&&v(t)}}.bind(this),L=function(e){if(a){l||(this.mark(),l=!0),C.length=0;var t=i(e),n=t[0]-a[0],s=t[1]-a[1],o=r.ignoreZoom?1:u.getZoom();n/=o,s/=o,this.moveBy(n,s,e),u.updateSelection(n,s,this)}}.bind(this),A=function(e){a=null,l=!1,r.unbind(document,"mousemove",L),r.unbind(document,"mouseup",A),r.removeClass(document.body,s.noSelect),this.unmark(e),u.unmarkSelection(this,e),r.events.stop({el:d,pos:r.getPosition(d),e:e,drag:this}),m&&(d&&d.parentNode&&d.parentNode.removeChild(d),d=null)}.bind(this);this.abort=function(){a!=null&&A()},this.getDragElement=function(){return d||n},this.mark=function(){f=r.getPosition(d),this.size=r.getSize(d),N=u.getMatchingDroppables(this),p(N,!0,!1,this),r.addClass(d,r.dragClass||s.drag);if(r.constrain||r.containment){var e=r.getSize(d.parentNode);T={w:e[0],h:e[1]}}},this.unmark=function(e){p(N,!1,!0,this),N.length=0;for(var t=0;t<C.length;t++)C[t].drop(this,e);r.removeClass(d,r.dragClass||s.drag)},this.moveBy=function(e,t,i){C.length=0;var s=w(b([f[0]+e,f[1]+t])),o={x:s[0],y:s[1],w:this.size[0],h:this.size[1]};r.setPosition(d,s);for(var u=0;u<N.length;u++){var a={x:N[u].position[0],y:N[u].position[1],w:N[u].size[0],h:N[u].size[1]};r.intersects(o,a)&&N[u].canDrop(this)?(C.push(N[u]),N[u].setHover(this,!0,i)):N[u].el._katavorioDragHover&&N[u].setHover(this,!1,i)}r.events.drag({el:n,pos:s,e:i,drag:this})},this.destroy=function(){r.unbind(n,"mousedown",k)},r.bind(n,"mousedown",k),S(r.filter)},w=function(e,t,n,r){this._class=n.droppable,this._activeClass=t.activeClass||n.active,this._hoverClass=t.hoverClass||n.hover;var i=y.apply(this,arguments),s=!1;this.setActive=function(n){t[n?"addClass":"removeClass"](e,this._activeClass)},this.updatePosition=function(){this.position=t.getPosition(e),this.size=t.getSize(e)},this.canDrop=t.canDrop||function(e){return!0},this.setHover=function(n,r,i){if(r||e._katavorioDragHover==null||e._katavorioDragHover==n.el._katavorio)t[r?"addClass":"removeClass"](e,this._hoverClass),e._katavorioDragHover=r?n.el._katavorio:null,s!==r&&t.events[r?"over":"out"]({el:e,e:i,drag:n,drop:this}),s=r},this.drop=function(e,n){t.events.drop({drag:e,e:n,drop:this})},this.destroy=function(){}},E=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})},S=function(e){return e==null?null:(e=typeof e=="string"?document.getElementById(e):e,e==null?null:(e._katavorio=e._katavorio||E(),e))};this.Katavorio=function(e){var t=[],n={},r={},i={},s=1,o=this,c=function(e,t){for(var n=0;n<e.scopes.length;n++)t[e.scopes[n]]=t[e.scopes[n]]||[],t[e.scopes[n]].push(e)},p=function(t,n){for(var r=0;r<t.scopes.length;r++)if(n[t.scopes[r]]){var i=e.indexOf(n[t.scopes[r]],t);i!=-1&&n[t.scopes[r]].splice(i,1)}},v=this.getMatchingDroppables=function(e){var t=[],n={};for(var r=0;r<e.scopes.length;r++){var s=i[e.scopes[r]];if(s)for(var o=0;o<s.length;o++)s[o].canDrop(e)&&!n[s[o].el._katavorio]&&s[o].el!==e.el&&(n[s[o].el._katavorio]=!0,t.push(s[o]))}return t},g=function(t){t=t||{};var n={events:{}};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];for(var r=0;r<f.length;r++)n.events[f[r]]=t[f[r]]||l;return n.katavorio=this,n}.bind(this),y={},E=e.css||{},x=e.scope||a;for(var T in u)y[T]=u[T];for(var T in E)y[T]=E[T];var N=e.inputFilterSelector||m;this.getInputFilterSelector=function(){return N},this.setInputFilterSelector=function(e){return N=e,this},this.draggable=function(e,t){var n=[];return d(e,function(){var e=S(this);if(e!=null){var i=g(t);e._katavorioDrag=new b(e,i,y,x),c(e._katavorioDrag,r),n.push(e._katavorioDrag)}}),n},this.droppable=function(e,t){var n=[];return d(e,function(){var e=S(this);e!=null&&(e._katavorioDrop=new w(e,g(t),y,x),c(e._katavorioDrop,i),n.push(e._katavorioDrop))}),n},this.select=function(r){return d(r,function(){var r=S(this);r&&r._katavorioDrag&&(n[r._katavorio]||(t.push(r._katavorioDrag),n[r._katavorio]=[r,t.length-1],e.addClass(r,y.selected)))}),this},this.deselect=function(r){return d(r,function(){var r=S(this);if(r&&r._katavorio){var i=n[r._katavorio];if(i){var s=[];for(var o=0;o<t.length;o++)t[o].el!==r&&s.push(t[o]);t=s,delete n[r._katavorio],e.removeClass(r,y.selected)}}}),this},this.deselectAll=function(){for(var r in n){var i=n[r];e.removeClass(i[0],y.selected)}t.length=0,n={}},this.markSelection=function(e){h(t,function(e){e.mark()},e)},this.unmarkSelection=function(e,n){h(t,function(e){e.unmark(n)},e)},this.getSelection=function(){return t.slice(0)},this.updateSelection=function(e,n,r){h(t,function(t){t.moveBy(e,n)},r)},this.setZoom=function(e){s=e},this.getZoom=function(){return s};var C=function(e,t,n){e!=null&&(p(e,n),e.setScope(t),c(e,n))};this.setScope=function(e,t){C(e._katavorioDrag,t,r),C(e._katavorioDrop,t,i)},this.setDragScope=function(e,t){C(e._katavorioDrag,t,r)},this.setDropScope=function(e,t){C(e._katavorioDrop,t,i)},this.getDragsForScope=function(e){return r[e]},this.getDropsForScope=function(e){return i[e]};var k=function(e,t,n){e=S(e),e[t]&&(e[t].destroy(),p(e[t],n),e[t]=null)};this.elementRemoved=function(e){this.destroyDraggable(e),this.destroyDroppable(e)},this.destroyDraggable=function(e){k(e,"_katavorioDrag",r)},this.destroyDroppable=function(e){k(e,"_katavorioDrop",i)}}}.call(this),function(){var e=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t=function(e){return Object.prototype.toString.call(e)==="[object Number]"},n=function(e){return typeof e=="string"},r=function(e){return typeof e=="boolean"},i=function(e){return e==null},s=function(e){return e==null?!1:Object.prototype.toString.call(e)==="[object Object]"},o=function(e){return Object.prototype.toString.call(e)==="[object Date]"},u=function(e){return Object.prototype.toString.call(e)==="[object Function]"},a=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},f=function(t,n,r){return t=e(t)?t:[t.x,t.y],n=e(n)?n:[n.x,n.y],r(t,n)};jsPlumbUtil={isArray:e,isString:n,isBoolean:r,isNull:i,isObject:s,isDate:o,isFunction:u,isEmpty:a,isNumber:t,clone:function(t){if(n(t))return""+t;if(r(t))return!!t;if(o(t))return new Date(t.getTime());if(u(t))return t;if(e(t)){var i=[];for(var a=0;a<t.length;a++)i.push(this.clone(t[a]));return i}if(s(t)){var f={};for(var l in t)f[l]=this.clone(t[l]);return f}return t},matchesSelector:function(e,t,n){n=n||e.parentNode;var r=n.querySelectorAll(t);for(var i=0;i<r.length;i++)if(r[i]===e)return!0;return!1},merge:function(t,i){var o=this.clone(t);for(var u in i)if(o[u]==null||n(i[u])||r(i[u]))o[u]=i[u];else if(e(i[u])){var a=[];e(o[u])&&a.push.apply(a,o[u]),a.push.apply(a,i[u]),o[u]=a}else if(s(i[u])){s(o[u])||(o[u]={});for(var f in i[u])o[u][f]=i[u][f]}return o},replace:function(e,t,n){var r=e,i=r;return t.replace(/([^\.])+/g,function(e,t,r,s){var o=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),u=r+e.length>=s.length,a=function(){return i[o[1]]||function(){return i[o[1]]=[],i[o[1]]}()};if(u)o?a()[o[3]]=n:i[e]=n;else if(o){var f=a();i=f[o[3]]||function(){return f[o[3]]={},f[o[3]]}()}else i=i[e]||function(){return i[e]={},i[e]}()}),e},functionChain:function(e,t,n){for(var r=0;r<n.length;r++){var i=n[r][0][n[r][1]].apply(n[r][0],n[r][2]);if(i===t)return i}return e},populate:function(t,r){var i=function(e){var t=e.match(/(\${.*?})/g);if(t!=null)for(var n=0;n<t.length;n++){var i=r[t[n].substring(2,t[n].length-1)];i!=null&&(e=e.replace(t[n],i))}return e},o=function(t){if(t!=null){if(n(t))return i(t);if(e(t)){var r=[];for(var u=0;u<t.length;u++)r.push(o(t[u]));return r}if(s(t)){var a={};for(var f in t)a[f]=o(t[f]);return a}return t}};return o(t)},convertStyle:function(e,t){if("transparent"===e)return e;var n=e,r=function(e){return e.length==1?"0"+e:e},i=function(e){return r(Number(e).toString(16))},s=/(rgb[a]?\()(.*)(\))/;if(e.match(s)){var o=e.match(s)[2].split(",");n="#"+i(o[0])+i(o[1])+i(o[2]),!t&&o.length==4&&(n+=i(o[3]))}return n},findWithFunction:function(e,t){if(e)for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1},indexOf:function(e,t){return e.indexOf?e.indexOf(t):jsPlumbUtil.findWithFunction(e,function(e){return e==t})},removeWithFunction:function(e,t){var n=jsPlumbUtil.findWithFunction(e,t);return n>-1&&e.splice(n,1),n!=-1},remove:function(e,t){var n=jsPlumbUtil.indexOf(e,t);return n>-1&&e.splice(n,1),n!=-1},addWithFunction:function(e,t,n){jsPlumbUtil.findWithFunction(e,n)==-1&&e.push(t)},addToList:function(e,t,n,r){var i=e[t];return i==null&&(i=[],e[t]=i),i[r?"unshift":"push"](n),i},consume:function(e,t){e.stopPropagation?e.stopPropagation():e.returnValue=!1,!t&&e.preventDefault&&e.preventDefault()},extend:function(t,n,r){var i;n=e(n)?n:[n];for(i=0;i<n.length;i++)for(var s in n[i].prototype)n[i].prototype.hasOwnProperty(s)&&(t.prototype[s]=n[i].prototype[s]);var o=function(e,t){return function(){for(i=0;i<n.length;i++)n[i].prototype[e]&&n[i].prototype[e].apply(this,arguments);return t.apply(this,arguments)}},u=function(e){for(var n in e)t.prototype[n]=o(n,e[n])};if(arguments.length>2)for(i=2;i<arguments.length;i++)u(arguments[i]);return t},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&typeof console!="undefined")try{var e=arguments[arguments.length-1];console.log(e)}catch(t){}},sizeElement:function(e,t,n,r,i){e&&(e.style.height=i+"px",e.height=i,e.style.width=r+"px",e.width=r,e.style.left=t+"px",e.style.top=n+"px")},wrap:function(e,t,n){return e=e||function(){},t=t||function(){},function(){var r=null;try{r=t.apply(this,arguments)}catch(i){jsPlumbUtil.log("jsPlumb function failed : "+i)}if(n==null||r!==n)try{r=e.apply(this,arguments)}catch(i){jsPlumbUtil.log("wrapped function failed : "+i)}return r}},ieVersion:/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1},jsPlumbUtil.oldIE=jsPlumbUtil.ieVersion>-1&&jsPlumbUtil.ieVersion<9,jsPlumbUtil.EventGenerator=function(){var e={},t=!1,n={ready:!0};this.bind=function(t,n,r){return jsPlumbUtil.addToList(e,t,n,r),this},this.fire=function(r,i,s){if(!t&&e[r]){var o=e[r].length,u=0,a=!1,f=null;if(!this.shouldFireEvent||this.shouldFireEvent(r,i,s))while(!a&&u<o&&f!==!1){if(n[r])e[r][u].apply(this,[i,s]);else try{f=e[r][u].apply(this,[i,s])}catch(l){jsPlumbUtil.log("jsPlumb: fire failed for event "+r+" : "+l)}u++;if(e==null||e[r]==null)a=!0}}return this},this.unbind=function(t){return t?delete e[t]:e={},this},this.getListener=function(t){return e[t]},this.setSuspendEvents=function(e){t=e},this.isSuspendEvents=function(){return t},this.cleanupListeners=function(){for(var t in e)e[t]=null}},jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}},Function.prototype.bind||(Function.prototype.bind=function(e){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i})}(),function(){var e=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),t=function(){if(t.vml===undefined){var e=document.body.appendChild(document.createElement("div"));e.innerHTML='<v:shape id="vml_flag1" adj="1" />';var n=e.firstChild;n!=null&&n.style!=null?(n.style.behavior="url(#default#VML)",t.vml=n?typeof n.adj=="object":!0):t.vml=!1,e.parentNode.removeChild(e)}return t.vml},n=function(){var e=-1;if(navigator.appName=="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(t)!=null&&(e=parseFloat(RegExp.$1))}return e}(),r=n>-1&&n<9,i=function(e,t){if(e==null)return[0,0];var n=f(e),r=a(n,0);return[r[t+"X"],r[t+"Y"]]},s=function(e){return e==null?[0,0]:r?[e.clientX+document.documentElement.scrollLeft,e.clientY+document.documentElement.scrollTop]:i(e,"page")},o=function(e){return i(e,"screen")},u=function(e){return i(e,"client")},a=function(e,t){return e.item?e.item(t):e[t]},f=function(e){return e.touches&&e.touches.length>0?e.touches:e.changedTouches&&e.changedTouches.length>0?e.changedTouches:e.targetTouches&&e.targetTouches.length>0?e.targetTouches:[e]},l=function(e){var t={},n=[],r={},i={},s={};this.register=function(o){var u=e.getId(o),a=jsPlumbAdapter.getOffset(o,e);t[u]||(t[u]=o,n.push(o),r[u]={});var f=function(t,n){if(t)for(var o=0;o<t.childNodes.length;o++)if(t.childNodes[o].nodeType!=3&&t.childNodes[o].nodeType!=8){var l=jsPlumb.getElementObject(t.childNodes[o]),c=e.getId(t.childNodes[o],null,!0);if(c&&i[c]&&i[c]>0){var h=jsPlumbAdapter.getOffset(l,e);r[u][c]={id:c,offset:{left:h.left-a.left,top:h.top-a.top}},s[c]=u}f(t.childNodes[o])}};f(o)},this.updateOffsets=function(t){if(t!=null){var n=jsPlumb.getDOMElement(t),i=e.getId(n),o=r[i],u=jsPlumbAdapter.getOffset(n,e);if(o)for(var a in o){var f=jsPlumb.getElementObject(a),l=jsPlumbAdapter.getOffset(f,e);r[i][a]={id:a,offset:{left:l.left-u.left,top:l.top-u.top}},s[a]=i}}},this.endpointAdded=function(n){var o=document.body,u=e.getId(n),a=jsPlumbAdapter.getOffset(n,e),f=n.parentNode,l=f==o;i[u]=i[u]?i[u]+1:1;while(f!=null&&f!=o){var c=e.getId(f,null,!0);if(c&&t[c]){var h=-1,p=jsPlumbAdapter.getOffset(f,e);r[c][u]==null&&(r[c][u]={id:u,offset:{left:a.left-p.left,top:a.top-p.top}},s[u]=c);break}f=f.parentNode}},this.endpointDeleted=function(e){if(i[e.elementId]){i[e.elementId]--;if(i[e.elementId]<=0)for(var t in r)r[t]&&(delete r[t][e.elementId],delete s[e.elementId])}},this.changeId=function(e,t){r[t]=r[e],r[e]={},s[t]=s[e],s[e]=null},this.getElementsForDraggable=function(e){return r[e]},this.elementRemoved=function(e){var t=s[e];t&&(delete r[t][e],delete s[e])},this.reset=function(){t={},n=[],r={},i={}},this.dragEnded=function(t){var n=e.getId(t),r=s[n];r&&this.updateOffsets(r)},this.setParent=function(t,n,i,o){var u=s[n];if(u){r[o]||(r[o]={}),r[o][n]=r[u][n],delete r[u][n];var a=jsPlumbAdapter.getOffset(i,e),f=jsPlumbAdapter.getOffset(t,e);r[o][n].offset={left:f.left-a.left,top:f.top-a.top},s[n]=o}}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}});var c=function(e){return e==null?null:e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},h=function(e,t){t=c(t),typeof e.className.baseVal!="undefined"?e.className.baseVal=t:e.className=t},p=function(e){return typeof e.className.baseVal=="undefined"?e.className:e.className.baseVal},d=function(e,t,n){var r=n.split(/\s+/),i=p(e),s=i.split(/\s+/);for(var o=0;o<r.length;o++)if(t)jsPlumbUtil.indexOf(s,r[o])==-1&&s.push(r[o]);else{var u=jsPlumbUtil.indexOf(s,r[o]);u!=-1&&s.splice(u,1)}h(e,s.join(" "))},v=function(e,t){if(e==null)return;if(typeof e=="string")t(jsPlumb.getDOMElement(e));else if(e.length!=null)for(var n=0;n<e.length;n++)t(jsPlumb.getDOMElement(e[n]));else t(e)};window.jsPlumbAdapter={headless:!1,pageLocation:s,screenLocation:o,clientLocation:u,getAttribute:function(e,t){return e.getAttribute(t)},setAttribute:function(e,t,n){e.setAttribute(t,n)},appendToRoot:function(e){document.body.appendChild(e)},getRenderModes:function(){return["svg","vml"]},isRenderModeAvailable:function(n){return{svg:e,vml:t()}[n]},getDragManager:function(e){return new l(e)},setRenderMode:function(e){var t;if(e){e=e.toLowerCase();var n=this.isRenderModeAvailable("svg"),r=this.isRenderModeAvailable("vml");e==="svg"?n?t="svg":r&&(t="vml"):r&&(t="vml")}return t},addClass:function(e,t){v(e,function(e){d(e,!0,t)})},hasClass:function(e,t){return e=jsPlumb.getDOMElement(e),e.classList?e.classList.contains(t):p(e).indexOf(t)!=-1},removeClass:function(e,t){v(e,function(e){d(e,!1,t)})},setClass:function(e,t){v(e,function(e){h(e,t)})},setPosition:function(e,t){e.style.left=t.left+"px",e.style.top=t.top+"px"},getPosition:function(e){var t=function(t){var n=e.style[t];return n?n.substring(0,n.length-2):0};return{left:t("left"),top:t("top")}},getOffset:function(e,t,n){e=jsPlumb.getDOMElement(e);var r=t.getContainer(),i=e.offsetLeft,s=e.offsetTop,o=n||r!=null&&e.offsetParent!=r?e.offsetParent:null;while(o!=null)i+=o.offsetLeft,s+=o.offsetTop,o=n?o.offsetParent:o.offsetParent==r?null:o.offsetParent;return{left:i,top:s}},getPositionOnElement:function(e,t,n){var r=typeof t.getBoundingClientRect!="undefined"?t.getBoundingClientRect():{left:0,top:0,width:0,height:0},i=document.body,s=document.documentElement,o=t.offsetParent,u=window.pageYOffset||s.scrollTop||i.scrollTop,a=window.pageXOffset||s.scrollLeft||i.scrollLeft,f=s.clientTop||i.clientTop||0,l=s.clientLeft||i.clientLeft||0,c=0,h=0,p=r.top+u-f+c*n,d=r.left+a-l+h*n,v=jsPlumbAdapter.pageLocation(e),m=r.width||t.offsetWidth*n,g=r.height||t.offsetHeight*n,y=(v[0]-d)/m,b=(v[1]-p)/g;return[y,b]}}}(),function(){var e=jsPlumbUtil,t=function(e,t,n){return jsPlumbAdapter.getOffset(e,t,n)},n=function(){return""+(new Date).getTime()},r=function(e){if(e._jsPlumb.paintStyle&&e._jsPlumb.hoverPaintStyle){var t={};b.extend(t,e._jsPlumb.paintStyle),b.extend(t,e._jsPlumb.hoverPaintStyle),delete e._jsPlumb.hoverPaintStyle,t.gradient&&e._jsPlumb.paintStyle.fillStyle&&delete t.gradient,e._jsPlumb.hoverPaintStyle=t}},i=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],s={mouseout:"mouseleave",mouseexit:"mouseleave"},o=function(e,t,n,r){var i=e.getAttachedElements();if(i)for(var s=0,o=i.length;s<o;s++)(!r||r!=i[s])&&i[s].setHover(t,!0,n)},u=function(e){return e==null?null:e.split(" ")},a=function(t,n,r){if(t.getDefaultType){var i=t.getTypeDescriptor(),s=e.merge({},t.getDefaultType());for(var o=0,u=t._jsPlumb.types.length;o<u;o++)s=e.merge(s,t._jsPlumb.instance.getType(t._jsPlumb.types[o],i));n&&(s=e.populate(s,n)),t.applyType(s,r),r||t.repaint()}},f=window.jsPlumbUIComponent=function(t){jsPlumbUtil.EventGenerator.apply(this,arguments);var n=this,r=arguments,o=n.idPrefix,u=o+(new Date).getTime();this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[]},this.getId=function(){return u};if(t.events)for(var a in t.events)n.bind(a,t.events[a]);this.clone=function(){var e={};return this.constructor.apply(e,r),e}.bind(this),this.isDetachAllowed=function(t){var n=!0;if(this._jsPlumb.beforeDetach)try{n=this._jsPlumb.beforeDetach(t)}catch(r){e.log("jsPlumb: beforeDetach callback failed",r)}return n},this.isDropAllowed=function(t,n,r,i,s,o,u){var a=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:n,scope:r,connection:i,dropEndpoint:s,source:o,target:u});if(this._jsPlumb.beforeDrop)try{a=this._jsPlumb.beforeDrop({sourceId:t,targetId:n,scope:r,connection:i,dropEndpoint:s,source:o,target:u})}catch(f){e.log("jsPlumb: beforeDrop callback failed",f)}return a};var f=[],l=function(e,t,n){f.push([e,t,n]),e.bind(t,n)},c=[],h=function(e,t,n,r){var i=s[n]||n,o=function(e){if(r&&r(e)===!1)return;t.fire(i,t,e)};c.push([e,n,o,t]),t._jsPlumb.instance.on(e,n,o)},p=function(e,t,n,r){var i=s[t]||t;r._jsPlumb.instance.off(e,t,n)};this.bindListeners=function(e,t,n){l(e,"click",function(e,n){t.fire("click",t,n)}),l(e,"dblclick",function(e,n){t.fire("dblclick",t,n)}),l(e,"contextmenu",function(e,n){t.fire("contextmenu",t,n)}),l(e,"mouseleave",function(e,r){t.isHover()&&(n(!1),t.fire("mouseleave",t,r))}),l(e,"mouseenter",function(e,r){t.isHover()||(n(!0),t.fire("mouseenter",t,r))}),l(e,"mousedown",function(e,n){t.fire("mousedown",t,n)}),l(e,"mouseup",function(e,n){t.fire("mouseup",t,n)})},this.unbindListeners=function(){for(var e=0;e<f.length;e++){var t=f[e];t[0].unbind(t[1],t[2])}f=null},this.attachListeners=function(e,t,n){n=n||{};for(var r=0,s=i.length;r<s;r++)h(e,t,i[r],n[i[r]])},this.detachListeners=function(){for(var e=0;e<c.length;e++)p(c[e][0],c[e][1],c[e][2],c[e][3]);c=null},this.reattachListenersForElement=function(e){if(arguments.length>1){for(var t=0,n=i.length;t<n;t++)p(e,i[t]);for(t=1,n=arguments.length;t<n;t++)this.attachListeners(e,arguments[t])}}};jsPlumbUtil.extend(f,jsPlumbUtil.EventGenerator,{getParameter:function(e){return this._jsPlumb.parameters[e]},setParameter:function(e,t){this._jsPlumb.parameters[e]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(e){this._jsPlumb.parameters=e},addClass:function(e){jsPlumbAdapter.addClass(this.canvas,e)},removeClass:function(e){jsPlumbAdapter.removeClass(this.canvas,e)},setType:function(e,t,n){this._jsPlumb.types=u(e)||[],a(this,t,n)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(e,t){a(this,e,t)},hasType:function(e){return jsPlumbUtil.indexOf(this._jsPlumb.types,e)!=-1},addType:function(e,t,n){var r=u(e),i=!1;if(r!=null){for(var s=0,o=r.length;s<o;s++)this.hasType(r[s])||(this._jsPlumb.types.push(r[s]),i=!0);i&&a(this,t,n)}},removeType:function(t,n){var r=u(t),i=!1,s=function(t){var n=e.indexOf(this._jsPlumb.types,t);return n!=-1?(this._jsPlumb.types.splice(n,1),!0):!1}.bind(this);if(r!=null){for(var o=0,f=r.length;o<f;o++)i=s(r[o])||i;i&&a(this,null,n)}},toggleType:function(e,t,n){var r=u(e);if(r!=null){for(var i=0,s=r.length;i<s;i++){var o=jsPlumbUtil.indexOf(this._jsPlumb.types,r[i]);o!=-1?this._jsPlumb.types.splice(o,1):this._jsPlumb.types.push(r[i])}a(this,t,n)}},applyType:function(e,t){this.setPaintStyle(e.paintStyle,t),this.setHoverPaintStyle(e.hoverPaintStyle,t);if(e.parameters)for(var n in e.parameters)this.setParameter(n,e.parameters[n])},setPaintStyle:function(e,t){this._jsPlumb.paintStyle=e,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,r(this),t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(e,t){this._jsPlumb.hoverPaintStyle=e,r(this),t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},cleanup:function(){this.unbindListeners(),this.detachListeners()},destroy:function(){this.cleanupListeners(),this.clone=null,this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(e,t,r){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=e;if(this.canvas!=null){if(this._jsPlumb.instance.hoverClass!=null){var i=e?"addClass":"removeClass";this._jsPlumb.instance[i](this.canvas,this._jsPlumb.instance.hoverClass)}this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[i](this.canvas,this._jsPlumb.hoverClass)}this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=e?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(r=r||n(),this.repaint({timestamp:r,recalc:!1}))),this.getAttachedElements&&!t&&o(this,e,n(),this)}}});var l="__label",c=function(e,t){var n=-1;for(var r=0,i=e._jsPlumb.overlays.length;r<i;r++)if(t===e._jsPlumb.overlays[r].id){n=r;break}return n},h=function(e,t){var n={cssClass:t.cssClass,labelStyle:e.labelStyle,id:l,component:e,_jsPlumb:e._jsPlumb.instance},r=b.extend(n,t);return new(b.Overlays[e._jsPlumb.instance.getRenderMode()].Label)(r)},p=function(t,n){var r=null;if(e.isArray(n)){var i=n[0],s=b.extend({component:t,_jsPlumb:t._jsPlumb.instance},n[1]);n.length==3&&b.extend(s,n[2]),r=new(b.Overlays[t._jsPlumb.instance.getRenderMode()][i])(s)}else n.constructor==String?r=new(b.Overlays[t._jsPlumb.instance.getRenderMode()][n])({component:t,_jsPlumb:t._jsPlumb.instance}):r=n;t._jsPlumb.overlays.push(r)},d=function(e,t){var n=e.defaultOverlayKeys||[],r=t.overlays,i=function(t){return e._jsPlumb.instance.Defaults[t]||b.Defaults[t]||[]};r||(r=[]);for(var s=0,o=n.length;s<o;s++)r.unshift.apply(r,i(n[s]));return r},v=window.OverlayCapableJsPlumbUIComponent=function(e){f.apply(this,arguments),this._jsPlumb.overlays=[];var t=d(this,e);if(t)for(var n=0,r=t.length;n<r;n++)p(this,t[n]);if(e.label){var i=e.labelLocation||this.defaultLabelLocation||.5,s=e.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle;this._jsPlumb.overlays.push(h(this,{label:e.label,location:i,labelStyle:s}))}};jsPlumbUtil.extend(v,f,{applyType:function(e,t){this.removeAllOverlays(t);if(e.overlays)for(var n=0,r=e.overlays.length;n<r;n++)this.addOverlay(e.overlays[n],!0)},setHover:function(e,t,n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var r=0,i=this._jsPlumb.overlays.length;r<i;r++)this._jsPlumb.overlays[r][e?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(e,t){p(this,e),t||this.repaint()},getOverlay:function(e){var t=c(this,e);return t>=0?this._jsPlumb.overlays[t]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(e){var t=this.getOverlay(e);t&&t.hide()},hideOverlays:function(){for(var e=0,t=this._jsPlumb.overlays.length;e<t;e++)this._jsPlumb.overlays[e].hide()},showOverlay:function(e){var t=this.getOverlay(e);t&&t.show()},showOverlays:function(){for(var e=0,t=this._jsPlumb.overlays.length;e<t;e++)this._jsPlumb.overlays[e].show()},removeAllOverlays:function(e){for(var t=0,n=this._jsPlumb.overlays.length;t<n;t++)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length),this._jsPlumb.overlayPositions=null,e||this.repaint()},removeOverlay:function(e){var t=c(this,e);if(t!=-1){var n=this._jsPlumb.overlays[t];n.cleanup&&n.cleanup(),this._jsPlumb.overlays.splice(t,1),this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[e]}},removeOverlays:function(){for(var e=0,t=arguments.length;e<t;e++)this.removeOverlay(arguments[e])},moveParent:function(e){this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),e.appendChild(this.bgCanvas)),this.canvas.parentNode.removeChild(this.canvas),e.appendChild(this.canvas);for(var t=0;t<this._jsPlumb.overlays.length;t++)this._jsPlumb.overlays[t].isAppendedAtTopLevel&&(this._jsPlumb.overlays[t].canvas.parentNode.removeChild(this._jsPlumb.overlays[t].canvas),e.appendChild(this._jsPlumb.overlays[t].canvas))},getLabel:function(){var e=this.getOverlay(l);return e!=null?e.getLabel():null},getLabelOverlay:function(){return this.getOverlay(l)},setLabel:function(e){var t=this.getOverlay(l);if(!t){var n=e.constructor==String||e.constructor==Function?{label:e}:e;t=h(this,n),this._jsPlumb.overlays.push(t)}else e.constructor==String||e.constructor==Function?t.setLabel(e):(e.label&&t.setLabel(e.label),e.location&&t.setLocation(e.location));this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var e=0;e<this._jsPlumb.overlays.length;e++)this._jsPlumb.overlays[e].cleanup(),this._jsPlumb.overlays[e].destroy();this._jsPlumb.overlays.splice(0),this._jsPlumb.overlayPositions=null},setVisible:function(e){this[e?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(e,t){this._jsPlumb.overlayPositions=this._jsPlumb.overlayPositions||{},this._jsPlumb.overlayPositions[e.id]=t},getAbsoluteOverlayPosition:function(e){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[e.id]:null}});var m=0,g=function(){var e=m+1;return m++,e},y=window.jsPlumbInstance=function(r){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},r&&b.extend(this.Defaults,r),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},jsPlumbUtil.EventGenerator.apply(this);var i=this,s=g(),o=i.bind,u={},a=1,l=function(e){var t=i.getDOMElement(e);return{el:t,id:jsPlumbUtil.isString(e)&&t==null?e:G(t)}};this.getInstanceIndex=function(){return s},this.setZoom=function(e,t){return jsPlumbUtil.oldIE||(a=e,i.fire("zoom",a),t&&i.repaintEverything()),!jsPlumbUtil.oldIE},this.getZoom=function(){return a};for(var c in this.Defaults)u[c]=this.Defaults[c];var h;this.setContainer=function(e){e=this.getDOMElement(e),this.select().each(function(t){t.moveParent(e)}),this.selectEndpoints().each(function(t){t.moveParent(e)}),h=e},this.getContainer=function(){return h},this.bind=function(e,t){"ready"===e&&v?t():o.apply(i,[e,t])},i.importDefaults=function(e){for(var t in e)i.Defaults[t]=e[t];return e.Container&&this.setContainer(e.Container),i},i.restoreDefaults=function(){return i.Defaults=b.extend({},u),i};var p=null,d=null,v=!1,m=[],y={},w={},E={},S={},x={},T={},N=!1,C=[],k=!1,L=null,A=this.Defaults.Scope,O=null,M=1,_=function(){return""+M++},D=function(e,t){h?h.appendChild(e):t?b.getDOMElement(t).appendChild(e):i.appendToRoot(e)},P=function(e){return e._nodes?e._nodes:e},H=function(e,t,r,s){if(!jsPlumbAdapter.headless&&!k){var o=G(e),u=i.dragManager.getElementsForDraggable(o);r==null&&(r=n());var a=K({elId:o,offset:t,recalc:!1,timestamp:r});if(u)for(var f in u)K({elId:u[f].id,offset:{left:a.o.left+u[f].offset.left,top:a.o.top+u[f].offset.top},recalc:!1,timestamp:r});i.anchorManager.redraw(o,t,r,null,s);if(u)for(var l in u)i.anchorManager.redraw(u[l].id,t,r,u[l].offset,s,!0)}},B=function(t,n){var r=null,s,o,u;if(e.isArray(t)){r=[];for(var a=0,f=t.length;a<f;a++)s=i.getElementObject(t[a]),u=i.getDOMElement(s),o=i.getAttribute(u,"id"),r.push(n.apply(i,[u,o]))}else s=i.getDOMElement(t),o=i.getId(s),r=n.apply(i,[s,o]);return r},j=function(e){return w[e]},F=function(t,n,r){if(!jsPlumbAdapter.headless){var s=n==null?!1:n;if(s&&b.isDragSupported(t,i)&&!b.isAlreadyDraggable(t,i)){var o=r||i.Defaults.DragOptions;o=b.extend({},o);var u=b.dragEvents.drag,a=b.dragEvents.stop,f=b.dragEvents.start;o[f]=e.wrap(o[f],function(){i.setHoverSuspended(!0),i.select({source:t}).addClass(i.elementDraggingClass+" "+i.sourceElementDraggingClass,!0),i.select({target:t}).addClass(i.elementDraggingClass+" "+i.targetElementDraggingClass,!0),i.setConnectionBeingDragged(!0);if(o.canDrag)return r.canDrag()},!1),o[u]=e.wrap(o[u],function(){var e=i.getUIPosition(arguments,i.getZoom());H(t,e,null,!0),i.addClass(t,"jsPlumb_dragged")}),o[a]=e.wrap(o[a],function(){var e=i.getUIPosition(arguments,i.getZoom(),!0);H(t,e),i.removeClass(t,"jsPlumb_dragged"),i.setHoverSuspended(!1),i.select({source:t}).removeClass(i.elementDraggingClass+" "+i.sourceElementDraggingClass,!0),i.select({target:t}).removeClass(i.elementDraggingClass+" "+i.targetElementDraggingClass,!0),i.setConnectionBeingDragged(!1),i.dragManager.dragEnded(t)});var l=G(t);T[l]=!0;var c=T[l];o.disabled=c==null?!1:!c,i.initDraggable(t,o,!1),i.dragManager.register(t)}}},I=function(t,n){var r=b.extend({},t);n&&b.extend(r,n),r.source&&(r.source.endpoint?r.sourceEndpoint=r.source:r.source=i.getDOMElement(r.source)),r.target&&(r.target.endpoint?r.targetEndpoint=r.target:r.target=i.getDOMElement(r.target)),t.uuids&&(r.sourceEndpoint=j(t.uuids[0]),r.targetEndpoint=j(t.uuids[1]));if(r.sourceEndpoint&&r.sourceEndpoint.isFull()){e.log(i,"could not add connection; source endpoint is full");return}if(r.targetEndpoint&&r.targetEndpoint.isFull()){e.log(i,"could not add connection; target endpoint is full");return}!r.type&&r.sourceEndpoint&&(r.type=r.sourceEndpoint.connectionType);if(r.sourceEndpoint&&r.sourceEndpoint.connectorOverlays){r.overlays=r.overlays||[];for(var s=0,o=r.sourceEndpoint.connectorOverlays.length;s<o;s++)r.overlays.push(r.sourceEndpoint.connectorOverlays[s])}!r["pointer-events"]&&r.sourceEndpoint&&r.sourceEndpoint.connectorPointerEvents&&(r["pointer-events"]=r.sourceEndpoint.connectorPointerEvents);var u,a,f,l;if(r.target&&!r.target.endpoint&&!r.targetEndpoint&&!r.newConnection){u=G(r.target),a=this.targetEndpointDefinitions[u];if(a){if(!a.enabled)return;a.isTarget=!0,l=a.endpoint!=null&&a.endpoint._jsPlumb?a.endpoint:i.addEndpoint(r.target,a.def),a.uniqueEndpoint&&(a.endpoint=l),r.targetEndpoint=l,l._doNotDeleteOnDetach=!1,l._deleteOnDetach=!0}}if(r.source&&!r.source.endpoint&&!r.sourceEndpoint&&!r.newConnection){u=G(r.source),a=this.sourceEndpointDefinitions[u];if(a){if(!a.enabled)return;l=a.endpoint!=null&&a.endpoint._jsPlumb?a.endpoint:i.addEndpoint(r.source,a.def),a.uniqueEndpoint&&(a.endpoint=l),r.sourceEndpoint=l,l._doNotDeleteOnDetach=!1,l._deleteOnDetach=!0}}return r}.bind(i),q=function(e){var t=i.Defaults.ConnectionType||i.getDefaultConnectionType(),n=i.Defaults.EndpointType||b.Endpoint;e._jsPlumb=i,e.newConnection=q,e.newEndpoint=z,e.endpointsByUUID=w,e.endpointsByElement=y,e.finaliseConnection=R;var r=new t(e);return r.id="con_"+_(),U("click","click",r),U("dblclick","dblclick",r),U("contextmenu","contextmenu",r),r.isDetachable()&&(r.endpoints[0].initDraggable(),r.endpoints[1].initDraggable()),r},R=function(e,t,n,r){t=t||{},e.suspendedEndpoint||m.push(e),(e.suspendedEndpoint==null||r)&&i.anchorManager.newConnection(e),H(e.source);if(!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var s={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};i.fire("connection",s,n)}},U=function(e,t,n){n.bind(e,function(e,r){i.fire(t,n,r)})},z=function(e){var t=i.Defaults.EndpointType||b.Endpoint,n=b.extend({},e);n._jsPlumb=i,n.newConnection=q,n.newEndpoint=z,n.endpointsByUUID=w,n.endpointsByElement=y,n.finaliseConnection=R,n.fireDetachEvent=et,n.fireMoveEvent=tt,n.floatingConnections=x,n.elementId=G(n.source);var r=new t(n);return r.id="ep_"+_(),U("click","endpointClick",r),U("dblclick","endpointDblClick",r),U("contextmenu","contextmenu",r),jsPlumbAdapter.headless||i.dragManager.endpointAdded(n.source),r},W=function(e,t,n){var r=y[e];if(r&&r.length)for(var i=0,s=r.length;i<s;i++){for(var o=0,u=r[i].connections.length;o<u;o++){var a=t(r[i].connections[o]);if(a)return}n&&n(r[i])}},X=function(e,t){return B(e,function(e,n){T[n]=t,this.isDragSupported(e)&&this.setElementDraggable(e,t)})},V=function(e,t,n){t=t==="block";var r=null;n&&(t?r=function(e){e.setVisible(!0,!0,!0)}:r=function(e){e.setVisible(!1,!0,!0)});var i=l(e);W(i.id,function(e){if(t&&n){var r=e.sourceId===i.id?1:0;e.endpoints[r].isVisible()&&e.setVisible(!0)}else e.setVisible(t)},r)},$=function(e){return B(e,function(e,t){var n=T[t]==null?!1:T[t];return n=!n,T[t]=n,this.setDraggable(e,n),n})},J=function(e,t){var n=null;t&&(n=function(e){var t=e.isVisible();e.setVisible(!t)}),W(e,function(e){var t=e.isVisible();e.setVisible(!t)},n)},K=this.updateOffset=function(e){var n=e.timestamp,r=e.recalc,s=e.offset,o=e.elId,u;return k&&!n&&(n=L),!r&&n&&n===S[o]?{o:e.offset||E[o],s:C[o]}:(r||!s?(u=document.getElementById(o),u!=null&&(C[o]=i.getSize(u),E[o]=t(u,i),S[o]=n)):(E[o]=s,C[o]==null&&(u=document.getElementById(o),u!=null&&(C[o]=i.getSize(u))),S[o]=n),E[o]&&!E[o].right&&(E[o].right=E[o].left+C[o][0],E[o].bottom=E[o].top+C[o][1],E[o].width=C[o][0],E[o].height=C[o][1],E[o].centerx=E[o].left+E[o].width/2,E[o].centery=E[o].top+E[o].height/2),{o:E[o],s:C[o]})},Q=function(e){var t=E[e];return t?{o:t,s:C[e]}:K({elId:e})},G=function(e,t,n){if(jsPlumbUtil.isString(e))return e;if(e==null)return null;var r=i.getAttribute(e,"id");if(!r||r==="undefined"){if(arguments.length==2&&arguments[1]!==undefined)r=t;else if(arguments.length==1||arguments.length==3&&!arguments[2])r="jsPlumb_"+s+"_"+_();n||i.setAttribute(e,"id",r)}return r};this.setConnectionBeingDragged=function(e){N=e},this.isConnectionBeingDragged=function(){return N},this.connectorClass="_jsPlumb_connector",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.hoverSourceClass="_jsPlumb_source_hover",this.hoverTargetClass="_jsPlumb_target_hover",this.dragSelectClass="_jsPlumb_drag_select",this.Anchors={},this.Connectors={svg:{},vml:{}},this.Endpoints={svg:{},vml:{}},this.Overlays={svg:{},vml:{}},this.ConnectorRenderers={},this.SVG="svg",this.VML="vml",this.addEndpoint=function(t,n,r){r=r||{};var s=b.extend({},r);b.extend(s,n),s.endpoint=s.endpoint||i.Defaults.Endpoint,s.paintStyle=s.paintStyle||i.Defaults.EndpointStyle,t=P(t);var o=[],u=e.isArray(t)||t.length!=null&&!e.isString(t)?t:[t];for(var a=0,f=u.length;a<f;a++){var l=i.getDOMElement(u[a]),c=G(l);s.source=l,gt(s.source),K({elId:c,timestamp:L});var h=z(s);s.parentAnchor&&(h.parentAnchor=s.parentAnchor),e.addToList(y,c,h);var p=E[c],d=C[c],v=h.anchor.compute({xy:[p.left,p.top],wh:d,element:h,timestamp:L}),m={anchorLoc:v,timestamp:L};k&&(m.recalc=!1),k||h.paint(m),o.push(h),h._doNotDeleteOnDetach=!0}return o.length==1?o[0]:o},this.addEndpoints=function(t,n,r){var s=[];for(var o=0,u=n.length;o<u;o++){var a=i.addEndpoint(t,n[o],r);e.isArray(a)?Array.prototype.push.apply(s,a):s.push(a)}return s},this.animate=function(t,n,r){r=r||{};var s=this.getElementObject(t),o=this.getDOMElement(t),u=G(o),a=b.animEvents.step,f=b.animEvents.complete;r[a]=e.wrap(r[a],function(){i.repaint(u)}),r[f]=e.wrap(r[f],function(){i.repaint(u)}),i.doAnimate(s,n,r)},this.checkCondition=function(t,n){var r=i.getListener(t),s=!0;if(r&&r.length>0)try{for(var o=0,u=r.length;o<u;o++)s=s&&r[o](n)}catch(a){e.log(i,"cannot check condition ["+t+"]"+a)}return s},this.checkASyncCondition=function(t,n,r,s){var o=i.getListener(t);if(o&&o.length>0)try{o[0](n,r,s)}catch(u){e.log(i,"cannot asynchronously check condition ["+t+"]"+u)}},this.connect=function(e,t){var n=I(e,t),r;return n&&(gt(n.source),r=q(n),R(r,n)),r};var Y=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],Z=function(e,t,n,r){var i,s=Y[n],o=e[s.elId],u=e[s.el],a,f,l=e.endpoints[n],c={index:n,originalSourceId:n===0?o:e.sourceId,newSourceId:e.sourceId,originalTargetId:n==1?o:e.targetId,newTargetId:e.targetId,connection:e};if(t.constructor==b.Endpoint)i=t,i.addConnection(e);else{a=G(t),f=this[s.epDefs][a];if(a===e[s.elId])i=null;else if(f){if(!f.enabled)return;i=f.endpoint!=null&&f.endpoint._jsPlumb?f.endpoint:this.addEndpoint(t,f.def),f.uniqueEndpoint&&(f.endpoint=i),i._doNotDeleteOnDetach=!1,i._deleteOnDetach=!0,i.addConnection(e)}else i=e.makeEndpoint(n===0,t,a),i._doNotDeleteOnDetach=!1,i._deleteOnDetach=!0}return i!=null&&(l.detachFromConnection(e),e.endpoints[n]=i,e[s.el]=i.element,e[s.elId]=i.elementId,c[n===0?"newSourceId":"newTargetId"]=i.elementId,tt(c),r||e.repaint()),c}.bind(this);this.setSource=function(e,t,n){var r=Z(e,t,0,n);this.anchorManager.sourceChanged(r.originalSourceId,r.newSourceId,e)},this.setTarget=function(e,t,n){var r=Z(e,t,1,n);this.anchorManager.updateOtherEndpoint(r.originalSourceId,r.originalTargetId,r.newTargetId,e)},this.deleteEndpoint=function(e,t){var n=i.setSuspendDrawing(!0),r=typeof e=="string"?w[e]:e;return r&&i.deleteObject({endpoint:r}),n||i.setSuspendDrawing(!1,t),i},this.deleteEveryEndpoint=function(){var e=i.setSuspendDrawing(!0);for(var t in y){var n=y[t];if(n&&n.length)for(var r=0,s=n.length;r<s;r++)i.deleteEndpoint(n[r],!0)}return y={},w={},i.anchorManager.reset(),i.dragManager.reset(),e||i.setSuspendDrawing(!1),i};var et=function(e,t,n){var r=i.Defaults.ConnectionType||i.getDefaultConnectionType(),s=e.constructor==r,o=s?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;t&&i.fire("connectionDetached",o,n),i.anchorManager.connectionDetached(o)},tt=function(e,t){i.fire("connectionMoved",e,t)};this.unregisterEndpoint=function(e){e._jsPlumb.uuid&&(w[e._jsPlumb.uuid]=null),i.anchorManager.deleteEndpoint(e);for(var t in y){var n=y[t];if(n){var r=[];for(var s=0,o=n.length;s<o;s++)n[s]!=e&&r.push(n[s]);y[t]=r}y[t].length<1&&delete y[t]}},this.detach=function(){if(arguments.length===0)return;var e=i.Defaults.ConnectionType||i.getDefaultConnectionType(),t=arguments[0].constructor==e,n=arguments.length==2?t?arguments[1]||{}:arguments[0]:arguments[0],r=n.fireEvent!==!1,s=n.forceDetach,o=t?arguments[0]:n.connection;if(o)(s||jsPlumbUtil.functionChain(!0,!1,[[o.endpoints[0],"isDetachAllowed",[o]],[o.endpoints[1],"isDetachAllowed",[o]],[o,"isDetachAllowed",[o]],[i,"checkCondition",["beforeDetach",o]]]))&&o.endpoints[0].detach(o,!1,!0,r);else{var u=b.extend({},n);if(u.uuids)j(u.uuids[0]).detachFrom(j(u.uuids[1]),r);else if(u.sourceEndpoint&&u.targetEndpoint)u.sourceEndpoint.detachFrom(u.targetEndpoint);else{var a=G(i.getDOMElement(u.source)),f=G(i.getDOMElement(u.target));W(a,function(e){(e.sourceId==a&&e.targetId==f||e.targetId==a&&e.sourceId==f)&&i.checkCondition("beforeDetach",e)&&e.endpoints[0].detach(e,!1,!0,r)})}}},this.detachAllConnections=function(e,t){t=t||{},e=i.getDOMElement(e);var n=G(e),r=y[n];if(r&&r.length)for(var s=0,o=r.length;s<o;s++)r[s].detachAll(t.fireEvent!==!1);return i},this.detachEveryConnection=function(e){return e=e||{},i.doWhileSuspended(function(){for(var t in y){var n=y[t];if(n&&n.length)for(var r=0,i=n.length;r<i;r++)n[r].detachAll(e.fireEvent!==!1)}m.splice(0)}),i},this.deleteObject=function(e){var t={endpoints:{},connections:{},endpointCount:0,connectionCount:0},n=e.fireEvent!==!1,r=e.deleteAttachedObjects!==!1,s=function(e){if(e!=null&&t.connections[e.id]==null){e._jsPlumb!=null&&e.setHover(!1),t.connections[e.id]=e,t.connectionCount++;if(r)for(var n=0;n<e.endpoints.length;n++)e.endpoints[n]._deleteOnDetach&&o(e.endpoints[n])}},o=function(e){if(e!=null&&t.endpoints[e.id]==null){e._jsPlumb!=null&&e.setHover(!1),t.endpoints[e.id]=e,t.endpointCount++;if(r)for(var n=0;n<e.connections.length;n++){var i=e.connections[n];s(i)}}};e.connection?s(e.connection):o(e.endpoint);for(var u in t.connections){var a=t.connections[u];a._jsPlumb&&(jsPlumbUtil.removeWithFunction(m,function(e){return a.id==e.id}),et(a,n,e.originalEvent),a.endpoints[0].detachFromConnection(a),a.endpoints[1].detachFromConnection(a),a.cleanup(),a.destroy())}for(var f in t.endpoints){var l=t.endpoints[f];l._jsPlumb&&(i.unregisterEndpoint(l),l.cleanup(),l.destroy())}return t},this.draggable=function(e,t){var n,r,s;if(typeof e=="object"&&e.length)for(n=0,r=e.length;n<r;n++)s=i.getDOMElement(e[n]),s&&F(s,!0,t);else if(e._nodes)for(n=0,r=e._nodes.length;n<r;n++)s=i.getDOMElement(e._nodes[n]),s&&F(s,!0,t);else s=i.getDOMElement(e),s&&F(s,!0,t);return i};var nt=function(e,t,n,r){for(var i=0,s=e.length;i<s;i++)e[i][t].apply(e[i],n);return r(e)},rt=function(e,t,n){var r=[];for(var i=0,s=e.length;i<s;i++)r.push([e[i][t].apply(e[i],n),e[i]]);return r},it=function(e,t,n){return function(){return nt(e,t,arguments,n)}},st=function(e,t){return function(){return rt(e,t,arguments)}},ot=function(e,t){var n=[];if(e)if(typeof e=="string"){if(e==="*")return e;n.push(e)}else if(t)n=e;else if(e.length)for(var r=0,i=e.length;r<i;r++)n.push(l(e[r]).id);else n.push(l(e).id);return n},ut=function(e,t,n){return e==="*"?!0:e.length>0?jsPlumbUtil.indexOf(e,t)!=-1:!n};this.getConnections=function(e,t){e?e.constructor==String&&(e={scope:e}):e={};var n=e.scope||i.getDefaultScope(),r=ot(n,!0),s=ot(e.source),o=ot(e.target),u=!t&&r.length>1?{}:[],a=function(e,n){if(!t&&r.length>1){var i=u[e];i==null&&(i=u[e]=[]),i.push(n)}else u.push(n)};for(var f=0,l=m.length;f<l;f++){var c=m[f];ut(r,c.scope)&&ut(s,c.sourceId)&&ut(o,c.targetId)&&a(c.scope,c)}return u};var at=function(e,t){return function(n){for(var r=0,i=e.length;r<i;r++)n(e[r]);return t(e)}},ft=function(e){return function(t){return e[t]}},lt=function(e,t){var n={length:e.length,each:at(e,t),get:ft(e)},r=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],i=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],s,o;for(s=0,o=r.length;s<o;s++)n[r[s]]=it(e,r[s],t);for(s=0,o=i.length;s<o;s++)n[i[s]]=st(e,i[s]);return n},ct=function(e){var t=lt(e,ct);return b.extend(t,{setDetachable:it(e,"setDetachable",ct),setReattach:it(e,"setReattach",ct),setConnector:it(e,"setConnector",ct),detach:function(){for(var t=0,n=e.length;t<n;t++)i.detach(e[t])},isDetachable:st(e,"isDetachable"),isReattach:st(e,"isReattach")})},ht=function(e){var t=lt(e,ht);return b.extend(t,{setEnabled:it(e,"setEnabled",ht),setAnchor:it(e,"setAnchor",ht),isEnabled:st(e,"isEnabled"),detachAll:function(){for(var t=0,n=e.length;t<n;t++)e[t].detachAll()},remove:function(){for(var t=0,n=e.length;t<n;t++)i.deleteObject({endpoint:e[t]})}})};this.select=function(e){return e=e||{},e.scope=e.scope||"*",ct(e.connections||i.getConnections(e,!0))},this.selectEndpoints=function(e){e=e||{},e.scope=e.scope||"*";var t=!e.element&&!e.source&&!e.target,n=t?"*":ot(e.element),r=t?"*":ot(e.source),i=t?"*":ot(e.target),s=ot(e.scope,!0),o=[];for(var u in y){var a=ut(n,u,!0),f=ut(r,u,!0),l=r!="*",c=ut(i,u,!0),h=i!="*";if(a||f||c)e:for(var p=0,d=y[u].length;p<d;p++){var v=y[u][p];if(ut(s,v.scope,!0)){var m=l&&r.length>0&&!v.isSource,g=h&&i.length>0&&!v.isTarget;if(m||g)continue e;o.push(v)}}}return ht(o)},this.getAllConnections=function(){return m},this.getDefaultScope=function(){return A},this.getEndpoint=j,this.getEndpoints=function(e){return y[l(e).id]},this.getDefaultEndpointType=function(){return b.Endpoint},this.getDefaultConnectionType=function(){return b.Connection},this.getId=G,this.getOffset=function(e){var t=E[e];return K({elId:e})},this.appendElement=D;var pt=!1;this.isHoverSuspended=function(){return pt},this.setHoverSuspended=function(e){pt=e};var dt=function(e){return function(){return jsPlumbAdapter.isRenderModeAvailable(e)}};this.isSVGAvailable=dt("svg"),this.isVMLAvailable=dt("vml"),this.hide=function(e,t){return V(e,"none",t),i},this.idstamp=_,this.connectorsInitialized=!1;var vt=[],mt=["svg","vml"];this.registerConnectorType=function(e,t){vt.push([e,t])};var gt=function(e){if(!h&&e){var t=i.getDOMElement(e);t.offsetParent&&(h=t.offsetParent)}},yt=function(){i.Defaults.Container&&(h=i.getDOMElement(i.Defaults.Container))};this.init=function(){var e=function(e,t,n){b.Connectors[e][t]=function(){n.apply(this,arguments),b.ConnectorRenderers[e].apply(this,arguments)},jsPlumbUtil.extend(b.Connectors[e][t],[n,b.ConnectorRenderers[e]])};if(!b.connectorsInitialized){for(var t=0;t<vt.length;t++)for(var n=0;n<mt.length;n++)e(mt[n],vt[t][1],vt[t][0]);b.connectorsInitialized=!0}v||(yt(),i.anchorManager=new b.AnchorManager({jsPlumbInstance:i}),i.setRenderMode(i.Defaults.RenderMode),v=!0,i.fire("ready",i))}.bind(this),this.log=p,this.jsPlumbUIComponent=f,this.makeAnchor=function(){var t,n=function(e,t){if(b.Anchors[e])return new b.Anchors[e](t);if(!i.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+e+"'"}};if(arguments.length===0)return null;var r=arguments[0],s=arguments[1],o=arguments[2],u=null;if(r.compute&&r.getOrientation)return r;if(typeof r=="string")u=n(arguments[0],{elementId:s,jsPlumbInstance:i});else if(e.isArray(r))if(e.isArray(r[0])||e.isString(r[0]))r.length==2&&e.isObject(r[1])?e.isString(r[0])?(t=b.extend({elementId:s,jsPlumbInstance:i},r[1]),u=n(r[0],t)):(t=b.extend({elementId:s,jsPlumbInstance:i,anchors:r[0]},r[1]),u=new b.DynamicAnchor(t)):u=new b.DynamicAnchor({anchors:r,selector:null,elementId:s,jsPlumbInstance:o});else{var a={x:r[0],y:r[1],orientation:r.length>=4?[r[2],r[3]]:[0,0],offsets:r.length>=6?[r[4],r[5]]:[0,0],elementId:s,jsPlumbInstance:o,cssClass:r.length==7?r[6]:null};u=new b.Anchor(a),u.clone=function(){return new b.Anchor(a)}}return u.id||(u.id="anchor_"+_()),u},this.makeAnchors=function(t,n,r){var s=[];for(var o=0,u=t.length;o<u;o++)typeof t[o]=="string"?s.push(b.Anchors[t[o]]({elementId:n,jsPlumbInstance:r})):e.isArray(t[o])&&s.push(i.makeAnchor(t[o],n,r));return s},this.makeDynamicAnchor=function(e,t){return new b.DynamicAnchor({anchors:e,selector:t,elementId:null,jsPlumbInstance:i})},this.targetEndpointDefinitions={};var bt=function(e,t,n){e.paintStyle=e.paintStyle||n.Defaults.EndpointStyles[t]||n.Defaults.EndpointStyle,e.hoverPaintStyle=e.hoverPaintStyle||n.Defaults.EndpointHoverStyles[t]||n.Defaults.EndpointHoverStyle,e.anchor=e.anchor||n.Defaults.Anchors[t]||n.Defaults.Anchor,e.endpoint=e.endpoint||n.Defaults.Endpoints[t]||n.Defaults.Endpoint};this.sourceEndpointDefinitions={};var wt=function(e,t,n,r,i){var s=e.target||e.srcElement,o=!1,u=r.getSelector(t,n);for(var a=0;a<u.length;a++)if(u[a]==s){o=!0;break}return i?!o:o};this.makeTarget=function(n,r,s){var o=b.extend({_jsPlumb:this},s);b.extend(o,r),bt(o,1,this);var u=o.scope||i.Defaults.Scope,a=o.deleteEndpointsOnDetach!==!1,c=o.maxConnections||-1,h=o.onMaxConnections,p=function(n){var r=l(n),i=r.id,s=new f(o),p=b.extend({},o.dropOptions||{});gt(i),this.targetEndpointDefinitions[i]={def:o,uniqueEndpoint:o.uniqueEndpoint,maxConnections:c,enabled:!0};var d=function(){this.currentlyDragging=!1;var e=this.getDropEvent(arguments),n=this.select({target:i}).length,u=this.getDOMElement(this.getDragObject(arguments)),f=this.getAttribute(u,"dragId"),l=this.getAttribute(u,"originalScope"),c=x[f],p=c.endpoints[0].isFloating()?0:1,d=c.endpoints[0],v=o.endpoint?b.extend({},o.endpoint):{},m=this.targetEndpointDefinitions[i];if(!m.enabled||m.maxConnections>0&&n>=m.maxConnections)return h&&h({element:r.el,connection:c},e),!1;d.anchor.locked=!1,l&&this.setDragScope(u,l);if(c.suspendedEndpoint==null&&!c.pending)return!1;var g=s.isDropAllowed(p===0?i:c.sourceId,p===0?c.targetId:i,c.scope,c,null,p===0?r.el:c.source,p===0?c.target:r.el);if(c.suspendedEndpoint){c[p?"targetId":"sourceId"]=c.suspendedEndpoint.elementId,c[p?"target":"source"]=c.suspendedEndpoint.element,c.endpoints[p]=c.suspendedEndpoint;var y=c.suspendedEndpoint.getElement(),w=c.suspendedEndpoint.elementId;tt({index:p,originalSourceId:p===0?w:c.sourceId,newSourceId:p===0?i:c.sourceId,originalTargetId:p==1?w:c.targetId,newTargetId:p==1?i:c.targetId,connection:c},e)}if(g){var E=this.getElementObject(r.el),S=m.endpoint;if(S==null||S._jsPlumb==null)S=this.addEndpoint(E,o);o.uniqueEndpoint&&(m.endpoint=S),S._doNotDeleteOnDetach=!1,S._deleteOnDetach=!0;if(S.anchor.positionFinder!=null){var T=this.getUIPosition(arguments,this.getZoom()),N=t(E,this),C=this.getSize(E),k=S.anchor.positionFinder(T,N,C,S.anchor.constructorParams);S.anchor.x=k[0],S.anchor.y=k[1]}c[p?"target":"source"]=S.element,c[p?"targetId":"sourceId"]=S.elementId,c.endpoints[p].detachFromConnection(c),c.endpoints[p]._deleteOnDetach&&(c.endpoints[p].deleteAfterDragStop=!0),S.addConnection(c),c.endpoints[p]=S,c.deleteEndpointsOnDetach=a,p==1?this.anchorManager.updateOtherEndpoint(c.sourceId,c.suspendedElementId,c.targetId,c):this.anchorManager.sourceChanged(c.suspendedEndpoint.elementId,c.sourceId,c),R(c,null,e),c.pending=!1}else c.suspendedEndpoint&&(c.isReattach()?(c.setHover(!1),c.floatingAnchorIndex=null,c.suspendedEndpoint.addConnection(c),this.repaint(d.elementId)):d.detach(c,!1,!0,!0,e))}.bind(this),v=b.dragEvents.drop;p.scope=p.scope||u,p[v]=e.wrap(p[v],d),this.initDroppable(this.getElementObject(r.el),p,!0)}.bind(this);n=P(n);var d=n.length&&n.constructor!=String?n:[n];for(var v=0,m=d.length;v<m;v++)p(d[v]);return this},this.unmakeTarget=function(e,t){var n=l(e);return b.destroyDroppable(n.el),t||delete this.targetEndpointDefinitions[n.id],this},this.makeSource=function(n,r,s){var o=b.extend({},s);b.extend(o,r),bt(o,0,this);var u=o.maxConnections||-1,f=o.onMaxConnections,c=function(n){var r=n.id,s=this.getElementObject(n.el),l=this.getDOMElement(s),c=function(){return o.parent==null?null:o.parent==="parent"?n.el.parentNode:i.getDOMElement(o.parent)},p=o.parent!=null?this.getId(c()):r;gt(p),this.sourceEndpointDefinitions[p]={def:o,uniqueEndpoint:o.uniqueEndpoint,maxConnections:u,enabled:!0};var d=b.dragEvents.stop,v=b.dragEvents.drag,m=b.extend({},o.dragOptions||{}),g=m.drag,y=m.stop,w=null,E=!1;m.scope=m.scope||o.scope,m[v]=e.wrap(m[v],function(){g&&g.apply(this,arguments),E=!1}),m[d]=e.wrap(m[d],function(){y&&y.apply(this,arguments),this.currentlyDragging=!1;if(w._jsPlumb!=null){var e=o.anchor||this.Defaults.Anchor,n=w.anchor,i=w.connections[0],s=this.makeAnchor(e,r,this),u=w.element;if(s.positionFinder!=null){var a=t(u,this),f=this.getSize(u),l={left:a.left+n.x*f[0],top:a.top+n.y*f[1]},p=s.positionFinder(l,a,f,s.constructorParams);s.x=p[0],s.y=p[1]}w.setAnchor(s,!0);if(o.parent){var d=c();if(d){var v=o.container||h;w.setElement(d,v)}}w.repaint(),this.repaint(w.elementId),this.repaint(i.targetId)}}.bind(this));var S=function(e){var t=this.getOriginalEvent(e),n=this.sourceEndpointDefinitions[p];r=this.getId(this.getDOMElement(s));if(!n.enabled)return;if(o.filter){var h=jsPlumbUtil.isString(o.filter)?wt(t,s,o.filter,this,o.filterExclude):o.filter(t,s);if(h===!1)return}var d=this.select({source:p}).length;if(n.maxConnections>=0&&d>=n.maxConnections)return f&&f({element:s,maxConnections:u},e),!1;var v=jsPlumbAdapter.getPositionOnElement(t,l,a),g=v;o.parent&&(g=jsPlumbAdapter.getPositionOnElement(t,c(),a));var y={};b.extend(y,o),y.isSource=!0,y.anchor=[v[0],v[1],0,0],y.parentAnchor=[g[0],g[1],0,0],y.dragOptions=m,w=this.addEndpoint(r,y),E=!0,w.endpointWillMoveTo=o.parent?c():null,w._doNotDeleteOnDetach=!1,w._deleteOnDetach=!0;var S=function(){E&&(E=!1,i.deleteEndpoint(w))};i.registerListener(w.canvas,"mouseup",S),i.registerListener(s,"mouseup",S),i.trigger(w.canvas,"mousedown",e),jsPlumbUtil.consume(e)}.bind(this);this.registerListener(s,"mousedown",S),this.sourceEndpointDefinitions[p].trigger=S,o.filter&&jsPlumbUtil.isString(o.filter)&&i.setDragFilter(s,o.filter)}.bind(this);n=P(n);var p=n.length&&n.constructor!=String?n:[n];for(var d=0,v=p.length;d<v;d++)c(l(p[d]));return this},this.unmakeSource=function(e,t){var n=l(e),r=this.sourceEndpointDefinitions[n.id].trigger;return r&&i.unregisterListener(n.el,"mousedown",r),t||delete this.sourceEndpointDefinitions[n.id],this},this.unmakeEverySource=function(){for(var e in this.sourceEndpointDefinitions)i.unmakeSource(e,!0);return this.sourceEndpointDefinitions={},this},this.unmakeEveryTarget=function(){for(var e in this.targetEndpointDefinitions)i.unmakeTarget(e,!0);return this.targetEndpointDefinitions={},this};var Et=function(t,n,r,i){var s=t=="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;n=P(n);if(e.isString(n))s[n].enabled=i?!s[n].enabled:r;else if(n.length)for(var o=0,u=n.length;o<u;o++){var a=l(n[o]);s[a.id]&&(s[a.id].enabled=i?!s[a.id].enabled:r)}else{var f=l(n).id;s[f].enabled=i?!s[f].enabled:r}return this}.bind(this),St=function(t,n){t=P(t);if(e.isString(t)||!t.length)return n.apply(this,[t]);if(t.length)return n.apply(this,[t[0]])}.bind(this);this.toggleSourceEnabled=function(e){return Et("source",e,null,!0),this.isSourceEnabled(e)},this.setSourceEnabled=function(e,t){return Et("source",e,t)},this.isSource=function(e){return St(e,function(e){return this.sourceEndpointDefinitions[l(e).id]!=null})},this.isSourceEnabled=function(e){return St(e,function(e){var t=this.sourceEndpointDefinitions[l(e).id];return t&&t.enabled===!0})},this.toggleTargetEnabled=function(e){return Et("target",e,null,!0),this.isTargetEnabled(e)},this.isTarget=function(e){return St(e,function(e){return this.targetEndpointDefinitions[l(e).id]!=null})},this.isTargetEnabled=function(e){return St(e,function(e){var t=this.targetEndpointDefinitions[l(e).id];return t&&t.enabled===!0})},this.setTargetEnabled=function(e,t){return Et("target",e,t)},this.ready=function(e){i.bind("ready",e)},this.repaint=function(e,t,n){if(typeof e=="object"&&e.length)for(var r=0,s=e.length;r<s;r++)H(e[r],t,n);else H(e,t,n);return i},this.repaintEverything=function(e){var t=n();for(var r in y)H(r,null,t,e);return this},this.removeAllEndpoints=function(e,t){var n=function(e){var r=l(e),s=y[r.id],o,u;if(s)for(o=0,u=s.length;o<u;o++)i.deleteEndpoint(s[o]);delete y[r.id];if(t&&r.el&&r.el.nodeType!=3&&r.el.nodeType!=8)for(o=0,u=r.el.childNodes.length;o<u;o++)n(r.el.childNodes[o])};return n(e),this},this.remove=function(e,t){var n=l(e);return i.doWhileSuspended(function(){i.removeAllEndpoints(n.id,!0),i.dragManager.elementRemoved(n.id),delete x[n.id],i.anchorManager.clearFor(n.id),i.anchorManager.removeFloatingConnection(n.id)},t===!1),n.el&&i.removeElement(n.el),i};var xt={},Tt=function(){for(var e in xt)for(var t=0,n=xt[e].length;t<n;t++){var r=xt[e][t];i.off(r.el,r.event,r.listener)}xt={}};this.registerListener=function(e,t,n){i.on(e,t,n),jsPlumbUtil.addToList(xt,t,{el:e,event:t,listener:n})},this.unregisterListener=function(e,t,n){i.off(e,t,n),jsPlumbUtil.removeWithFunction(xt,function(e){return e.type==t&&e.listener==n})},this.reset=function(){i.deleteEveryEndpoint(),i.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},m.splice(0),Tt(),i.anchorManager.reset(),jsPlumbAdapter.headless||i.dragManager.reset()},this.setDefaultScope=function(e){return A=e,i},this.setDraggable=X,this.setId=function(e,t,n){var r;jsPlumbUtil.isString(e)?r=e:(e=this.getDOMElement(e),r=this.getId(e));var i=this.getConnections({source:r,scope:"*"},!0),s=this.getConnections({target:r,scope:"*"},!0);t=""+t,n?e=this.getDOMElement(t):(e=this.getDOMElement(r),this.setAttribute(e,"id",t)),y[t]=y[r]||[];for(var o=0,u=y[t].length;o<u;o++)y[t][o].setElementId(t),y[t][o].setReferenceElement(e);delete y[r],this.anchorManager.changeId(r,t),this.dragManager&&this.dragManager.changeId(r,t);var a=function(n,r,i){for(var s=0,o=n.length;s<o;s++)n[s].endpoints[r].setElementId(t),n[s].endpoints[r].setReferenceElement(e),n[s][i+"Id"]=t,n[s][i]=e};a(i,0,"source"),a(s,1,"target"),this.repaint(t)},this.setDebugLog=function(e){p=e},this.setSuspendDrawing=function(e,t){var n=k;return k=e,e?L=(new Date).getTime():L=null,t&&this.repaintEverything(),n},this.isSuspendDrawing=function(){return k},this.getSuspendedAt=function(){return L},this.doWhileSuspended=function(t,n){var r=this.isSuspendDrawing();r||this.setSuspendDrawing(!0);try{t()}catch(i){e.log("Function run while suspended failed",i)}r||this.setSuspendDrawing(!1,!n)},this.getOffset=function(e){return E[e]},this.getCachedData=Q,this.timestamp=n,this.setRenderMode=function(e){if(e!==b.SVG&&e!==b.VML)throw new TypeError("Render mode ["+e+"] not supported");return O=jsPlumbAdapter.setRenderMode(e),O},this.getRenderMode=function(){return O},this.show=function(e,t){return V(e,"block",t),i},this.toggleVisible=J,this.toggleDraggable=$,this.addListener=this.bind,jsPlumbAdapter.headless||(i.dragManager=jsPlumbAdapter.getDragManager(i),i.recalculateOffsets=i.dragManager.updateOffsets)};jsPlumbUtil.extend(y,jsPlumbUtil.EventGenerator,{setAttribute:function(e,t,n){this.setAttribute(e,t,n)},getAttribute:function(e,t){return this.getAttribute(b.getDOMElement(e),t)},registerConnectionType:function(e,t){this._connectionTypes[e]=b.extend({},t)},registerConnectionTypes:function(e){for(var t in e)this._connectionTypes[t]=b.extend({},e[t])},registerEndpointType:function(e,t){this._endpointTypes[e]=b.extend({},t)},registerEndpointTypes:function(e){for(var t in e)this._endpointTypes[t]=b.extend({},e[t])},getType:function(e,t){return t==="connection"?this._connectionTypes[e]:this._endpointTypes[e]},setIdChanged:function(e,t){this.setId(e,t,!0)},setParent:function(e,t){var n=this.getElementObject(e),r=this.getDOMElement(n),i=this.getId(r),s=this.getElementObject(t),o=this.getDOMElement(s),u=this.getId(o);r.parentNode.removeChild(r),o.appendChild(r),this.dragManager.setParent(n,i,s,u)},getSize:function(e){return[e.offsetWidth,e.offsetHeight]},getWidth:function(e){return e.offsetWidth},getHeight:function(e){return e.offsetHeight},extend:function(e,t,n){var r;if(n)for(r=0;r<n.length;r++)e[n[r]]=t[n[r]];else for(r in t)e[r]=t[r];return e}},jsPlumbAdapter);var b=new y;typeof window!="undefined"&&(window.jsPlumb=b),b.getInstance=function(e){var t=new y(e);return t.init(),t},typeof define=="function"&&(define("jsplumb",[],function(){return b}),define("jsplumbinstance",[],function(){return b.getInstance()})),typeof exports!="undefined"&&(exports.jsPlumb=b)}(),function(){var e=function(e,t){var n=!1;return{drag:function(){if(n)return n=!1,!0;var r=jsPlumb.getUIPosition(arguments,t.getZoom());e.element&&(jsPlumbAdapter.setPosition(e.element,r),t.repaint(e.element,r))},stopDrag:function(){n=!0}}},t=function(e,t){var n=document.createElement("div");n.style.position="absolute";var r=t.getContainer()||document.body;r.appendChild(n);var i=t.getId(n);t.updateOffset({elId:i}),e.id=i,e.element=n},n=function(e,t,n,r,i,s,o){var u=new jsPlumb.FloatingAnchor({reference:t,referenceCanvas:r,jsPlumbInstance:s});return o({paintStyle:e,endpoint:n,anchor:u,source:i,scope:"__floating"})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],i=function(e,t){var n=0;if(t!=null)for(var r=0;r<e.connections.length;r++)if(e.connections[r].sourceId==t||e.connections[r].targetId==t){n=r;break}return e.connections[n]},s=function(e,t){return jsPlumbUtil.findWithFunction(t.connections,function(t){return t.id==e.id})};jsPlumb.Endpoint=function(o){var u=o._jsPlumb,a=jsPlumbAdapter.getAttribute,f=jsPlumb.getElementObject,l=jsPlumbUtil,c=o.newConnection,h=o.newEndpoint,p=o.finaliseConnection,d=o.fireDetachEvent,v=o.fireMoveEvent,m=o.floatingConnections;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:o.connectorStyle,connectorHoverStyle:o.connectorHoverStyle,connectorClass:o.connectorClass,connectorHoverClass:o.connectorHoverClass,connectorOverlays:o.connectorOverlays,connector:o.connector,connectorTooltip:o.connectorTooltip}},this._jsPlumb.enabled=o.enabled!==!1,this._jsPlumb.visible=!0,this.element=jsPlumb.getDOMElement(o.source),this._jsPlumb.uuid=o.uuid,this._jsPlumb.floatingEndpoint=null;var g=null;this._jsPlumb.uuid&&(o.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=o.elementId,this._jsPlumb.connectionCost=o.connectionCost,this._jsPlumb.connectionsDirected=o.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var y=function(){jsPlumbAdapter.removeClass(this.element,u.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.removeClass(u.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this._jsPlumb.currentAnchorClass=this.anchor.getCssClass(),this.addClass(u.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),jsPlumbAdapter.addClass(this.element,u.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass)}.bind(this);this.setAnchor=function(e,t){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=this._jsPlumb.instance.makeAnchor(e,this.elementId,u),y(),this.anchor.bind("anchorChanged",function(e){this.fire("anchorChanged",{endpoint:this,anchor:e}),y()}.bind(this)),t||this._jsPlumb.instance.repaint(this.elementId),this};var b=o.anchor?o.anchor:o.anchors?o.anchors:u.Defaults.Anchor||"Top";this.setAnchor(b,!0);var w=function(e){this.connections.length>0?this.connections[0].setHover(e,!1):this.setHover(e)}.bind(this);o._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.setEndpoint=function(e){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy());var t=function(e,t){var n=u.getRenderMode();if(jsPlumb.Endpoints[n][e])return new jsPlumb.Endpoints[n][e](t);if(!u.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+e+"'"}},n={_jsPlumb:this._jsPlumb.instance,cssClass:o.cssClass,container:o.container,tooltip:o.tooltip,connectorTooltip:o.connectorTooltip,endpoint:this};l.isString(e)?this.endpoint=t(e,n):l.isArray(e)?(n=l.merge(e[1],n),this.endpoint=t(e[0],n)):this.endpoint=e.clone();var r=jsPlumb.extend({},n);this.endpoint.clone=function(){if(l.isString(e))return t(e,n);if(l.isArray(e))return n=l.merge(e[1],n),t(e[0],n)}.bind(this),this.type=this.endpoint.type,this.bindListeners(this.endpoint,this,w)},this.setEndpoint(o.endpoint||u.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot"),this.setPaintStyle(o.paintStyle||o.style||u.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(o.hoverPaintStyle||u.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),jsPlumb.extend(this,o,r),this.isSource=o.isSource||!1,this.isTarget=o.isTarget||!1,this._jsPlumb.maxConnections=o.maxConnections||u.Defaults.MaxConnections,this.canvas=this.endpoint.canvas,this.addClass(u.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),jsPlumbAdapter.addClass(this.element,u.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.connections=o.connections||[],this.connectorPointerEvents=o["connector-pointer-events"],this.scope=o.scope||u.getDefaultScope(),this.timestamp=null,this.reattachConnections=o.reattach||u.Defaults.ReattachConnections,this.connectionsDetachable=u.Defaults.ConnectionsDetachable;if(o.connectionsDetachable===!1||o.detachable===!1)this.connectionsDetachable=!1;this.dragAllowedWhenFull=o.dragAllowedWhenFull||!0,o.onMaxConnections&&this.bind("maxConnections",o.onMaxConnections),this.addConnection=function(e){this.connections.push(e),this[(this.connections.length>0?"add":"remove")+"Class"](u.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](u.endpointFullClass)},this.detachFromConnection=function(e,t,n){t=t==null?s(e,this):t,t>=0&&(this.connections.splice(t,1),this[(this.connections.length>0?"add":"remove")+"Class"](u.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](u.endpointFullClass)),!n&&this._deleteOnDetach&&this.connections.length===0&&u.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!1})},this.detach=function(e,t,n,r,i,o,a){var f=a==null?s(e,this):a,l=!1;return r=r!==!1,f>=0&&(n||e._forceDetach||e.isDetachable()&&e.isDetachAllowed(e)&&this.isDetachAllowed(e))&&(u.deleteObject({connection:e,fireEvent:!t&&r,originalEvent:i,deleteAttachedObjects:!1}),l=!0),l},this.detachAll=function(e,t){while(this.connections.length>0)this.detach(this.connections[0],!1,!0,e!==!1,t,this,0);return this},this.detachFrom=function(e,t,n){var r=[];for(var i=0;i<this.connections.length;i++)(this.connections[i].endpoints[1]==e||this.connections[i].endpoints[0]==e)&&r.push(this.connections[i]);for(var s=0;s<r.length;s++)this.detach(r[s],!1,!0,t,n);return this},this.getElement=function(){return this.element},this.setElement=function(e){var t=this._jsPlumb.instance.getId(e),n=this.elementId;return l.removeWithFunction(o.endpointsByElement[this.elementId],function(e){return e.id==this.id}.bind(this)),this.element=jsPlumb.getDOMElement(e),this.elementId=u.getId(this.element),u.anchorManager.rehomeEndpoint(this,n,this.element),u.dragManager.endpointAdded(this.element),l.addToList(o.endpointsByElement,t,this),this},this.makeInPlaceCopy=function(){var e=this.anchor.getCurrentLocation({element:this}),t=this.anchor.getOrientation(this),n=this.anchor.getCssClass(),r={bind:function(){},compute:function(){return[e[0],e[1]]},getCurrentLocation:function(){return[e[0],e[1]]},getOrientation:function(){return t},getCssClass:function(){return n}};return h({dropOptions:o.dropOptions,anchor:r,source:this.element,paintStyle:this.getPaintStyle(),endpoint:o.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope})},this.connectorSelector=function(){var e=this.connections[0];return this.isTarget&&e?e:this.connections.length<this._jsPlumb.maxConnections||this._jsPlumb.maxConnections==-1?null:e},this.setStyle=this.setPaintStyle,this.paint=function(e){e=e||{};var t=e.timestamp,n=e.recalc!==!1;if(!t||this.timestamp!==t){var r=u.updateOffset({elId:this.elementId,timestamp:t}),s=e.offset?e.offset.o:r.o;if(s!=null){var o=e.anchorPoint,a=e.connectorPaintStyle;if(o==null){var f=e.dimensions||r.s,l={xy:[s.left,s.top],wh:f,element:this,timestamp:t};if(n&&this.anchor.isDynamic&&this.connections.length>0){var c=i(this,e.elementWithPrecedence),h=c.endpoints[0]==this?1:0,p=h===0?c.sourceId:c.targetId,d=u.getCachedData(p),v=d.o,m=d.s;l.txy=[v.left,v.top],l.twh=m,l.tElement=c.endpoints[h]}o=this.anchor.compute(l)}this.endpoint.compute(o,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,a||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=t;for(var g=0;g<this._jsPlumb.overlays.length;g++){var y=this._jsPlumb.overlays[g];y.isVisible()&&(this._jsPlumb.overlayPlacements[g]=y.draw(this.endpoint,this._jsPlumb.paintStyleInUse),y.paint(this._jsPlumb.overlayPlacements[g]))}}}},this.repaint=this.paint;var E=!1;this.initDraggable=function(){if(!E&&jsPlumb.isDragSupported(this.element)){var r={id:null,element:null},i=null,s=!1,a=null,p=e(r,u),d=function(){i=this.connectorSelector();var e=!0;this.isEnabled()||(e=!1),i==null&&!this.isSource&&(e=!1),this.isSource&&this.isFull()&&!this.dragAllowedWhenFull&&(e=!1),i!=null&&!i.isDetachable()&&(e=!1);if(e===!1)return u.stopDrag&&u.stopDrag(this.canvas),p.stopDrag(),!1;for(var d=0;d<this.connections.length;d++)this.connections[d].setHover(!1);this.addClass("endpointDrag"),u.setConnectionBeingDragged(!0),i&&!this.isFull()&&this.isSource&&(i=null),u.updateOffset({elId:this.elementId}),g=this.makeInPlaceCopy(),g.referenceEndpoint=this,g.paint(),t(r,u);var v=f(g.canvas),y=jsPlumbAdapter.getOffset(v,this._jsPlumb.instance),b=f(this.canvas);jsPlumbAdapter.setPosition(r.element,y),this.parentAnchor&&(this.anchor=u.makeAnchor(this.parentAnchor,this.elementId,u)),u.setAttribute(this.canvas,"dragId",r.id),u.setAttribute(this.canvas,"elId",this.elementId),this._jsPlumb.floatingEndpoint=n(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,r.element,u,h),this.canvas.style.visibility="hidden";if(i==null)this.anchor.locked=!0,this.setHover(!1,!1),i=c({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:r.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:o.connectorStyle,hoverPaintStyle:o.connectorHoverStyle,connector:o.connector,overlays:o.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass}),i.pending=!0,i.addClass(u.draggingClass),this._jsPlumb.floatingEndpoint.addClass(u.draggingClass),u.fire("connectionDrag",i);else{s=!0,i.setHover(!1);var w=i.endpoints[0].id==this.id?0:1;i.floatingAnchorIndex=w,this.detachFromConnection(i,null,!0);var E=u.getDragScope(b);u.setAttribute(this.canvas,"originalScope",E);var S=u.getDropScope(b);u.setDragScope(b,S),u.fire("connectionDrag",i),w===0?(a=[i.source,i.sourceId,b,E],i.source=r.element,i.sourceId=r.id):(a=[i.target,i.targetId,b,E],i.target=r.element,i.targetId=r.id),i.endpoints[w===0?1:0].anchor.locked=!0,i.suspendedEndpoint=i.endpoints[w],i.suspendedElement=i.endpoints[w].getElement(),i.suspendedElementId=i.endpoints[w].elementId,i.suspendedElementType=w===0?"source":"target",i.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=i.suspendedEndpoint,i.endpoints[w]=this._jsPlumb.floatingEndpoint,i.addClass(u.draggingClass),this._jsPlumb.floatingEndpoint.addClass(u.draggingClass)}m[r.id]=i,u.anchorManager.addFloatingConnection(r.id,i),l.addToList(o.endpointsByElement,r.id,this._jsPlumb.floatingEndpoint),u.currentlyDragging=!0}.bind(this),v=o.dragOptions||{},y={},b=jsPlumb.dragEvents.start,w=jsPlumb.dragEvents.stop,S=jsPlumb.dragEvents.drag;v=jsPlumb.extend(y,v),v.scope=v.scope||this.scope,v[b]=l.wrap(v[b],d,!1),v[S]=l.wrap(v[S],p.drag),v[w]=l.wrap(v[w],function(){u.setConnectionBeingDragged(!1);if(i&&i.endpoints!=null){var e=u.getDropEvent(arguments),t=i.floatingAnchorIndex==null?1:i.floatingAnchorIndex;i.endpoints[t===0?1:0].anchor.locked=!1,i.removeClass(u.draggingClass),i.endpoints[t]==this._jsPlumb.floatingEndpoint&&s&&i.suspendedEndpoint&&(t===0?(i.source=a[0],i.sourceId=a[1]):(i.target=a[0],i.targetId=a[1]),u.setDragScope(a[2],a[3]),i.endpoints[t]=i.suspendedEndpoint,i.isReattach()||i._forceReattach||i._forceDetach||!i.endpoints[t===0?1:0].detach(i,!1,!1,!0,e)?(i.setHover(!1),i.floatingAnchorIndex=null,i._forceDetach=null,i._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(i),i.suspendedEndpoint.addConnection(i),u.repaint(a[1])):i.suspendedEndpoint.detachFromConnection(i)),u.remove(r.element,!1),u.deleteObject({endpoint:g}),this.deleteAfterDragStop?u.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1})),u.fire("connectionDragStop",i,e),u.currentlyDragging=!1,i=null}}.bind(this));var x=f(this.canvas);u.initDraggable(x,v,!0),E=!0}},(this.isSource||this.isTarget)&&this.initDraggable();var S=function(e,t,n,r){if((this.isTarget||t)&&jsPlumb.isDropSupported(this.element)){var i=o.dropOptions||u.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;i=jsPlumb.extend({},i),i.scope=i.scope||this.scope;var s=jsPlumb.dragEvents.drop,a=jsPlumb.dragEvents.over,f=jsPlumb.dragEvents.out,c=function(){this.removeClass(u.endpointDropAllowedClass),this.removeClass(u.endpointDropForbiddenClass);var e=u.getDropEvent(arguments),t=u.getDOMElement(u.getDragObject(arguments)),n=u.getAttribute(t,"dragId"),i=u.getAttribute(t,"elId"),s=u.getAttribute(t,"originalScope"),o=m[n];if(o!=null){var a=o.suspendedEndpoint&&(o.suspendedEndpoint.id==this.id||this.referenceEndpoint&&o.suspendedEndpoint.id==this.referenceEndpoint.id);if(a){o._forceReattach=!0;return}var f=o.floatingAnchorIndex==null?1:o.floatingAnchorIndex,l=f===0?1:0;s&&u.setDragScope(t,s);var c=r!=null?r.isEnabled():!0;this.isFull()&&this.fire("maxConnections",{endpoint:this,connection:o,maxConnections:this._jsPlumb.maxConnections},e);if(!this.isFull()&&(f!==0||!!this.isSource)&&(f!=1||!!this.isTarget)&&c){var h=!0;if(o.suspendedEndpoint&&o.suspendedEndpoint.id!=this.id){f===0?(o.source=o.suspendedEndpoint.element,o.sourceId=o.suspendedEndpoint.elementId):(o.target=o.suspendedEndpoint.element,o.targetId=o.suspendedEndpoint.elementId);if(!o.isDetachAllowed(o)||!o.endpoints[f].isDetachAllowed(o)||!o.suspendedEndpoint.isDetachAllowed(o)||!u.checkCondition("beforeDetach",o))h=!1}f===0?(o.source=this.element,o.sourceId=this.elementId):(o.target=this.element,o.targetId=this.elementId);var d=function(){o.floatingAnchorIndex=null},g=function(){o.pending=!1,o.endpoints[f].detachFromConnection(o),o.suspendedEndpoint&&o.suspendedEndpoint.detachFromConnection(o),o.endpoints[f]=this,this.addConnection(o);var t=this.getParameters();for(var n in t)o.setParameter(n,t[n]);if(!o.suspendedEndpoint)t.draggable&&jsPlumb.initDraggable(this.element,dragOptions,!0,u);else{var r=o.suspendedEndpoint.getElement(),i=o.suspendedEndpoint.elementId;v({index:f,originalSourceId:f===0?i:o.sourceId,newSourceId:f===0?this.elementId:o.sourceId,originalTargetId:f==1?i:o.targetId,newTargetId:f==1?this.elementId:o.targetId,originalSourceEndpoint:f===0?o.suspendedEndpoint:o.endpoints[0],newSourceEndpoint:f===0?this:o.endpoints[0],originalTargetEndpoint:f==1?o.suspendedEndpoint:o.endpoints[1],newTargetEndpoint:f==1?this:o.endpoints[1],connection:o},e)}f==1?u.anchorManager.updateOtherEndpoint(o.sourceId,o.suspendedElementId,o.targetId,o):u.anchorManager.sourceChanged(o.suspendedEndpoint.elementId,o.sourceId,o),p(o,null,e),d()}.bind(this),y=function(){o.suspendedEndpoint&&(o.endpoints[f]=o.suspendedEndpoint,o.setHover(!1),o._forceDetach=!0,f===0?(o.source=o.suspendedEndpoint.element,o.sourceId=o.suspendedEndpoint.elementId):(o.target=o.suspendedEndpoint.element,o.targetId=o.suspendedEndpoint.elementId),o.suspendedEndpoint.addConnection(o),o.endpoints[0].repaint(),o.repaint(),u.repaint(o.sourceId),o._forceDetach=!1),d()};h=h&&this.isDropAllowed(o.sourceId,o.targetId,o.scope,o,this),h?g():y()}u.currentlyDragging=!1}}.bind(this);i[s]=l.wrap(i[s],c),i[a]=l.wrap(i[a],function(){var e=jsPlumb.getDragObject(arguments),t=u.getAttribute(jsPlumb.getDOMElement(e),"dragId"),n=m[t];if(n!=null){var r=n.floatingAnchorIndex==null?1:n.floatingAnchorIndex,i=this.isTarget&&n.floatingAnchorIndex!==0||n.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==n.suspendedEndpoint.id;if(i){var s=u.checkCondition("checkDropAllowed",{sourceEndpoint:n.endpoints[r],targetEndpoint:this,connection:n});this[(s?"add":"remove")+"Class"](u.endpointDropAllowedClass),this[(s?"remove":"add")+"Class"](u.endpointDropForbiddenClass),n.endpoints[r].anchor.over(this.anchor,this)}}}.bind(this)),i[f]=l.wrap(i[f],function(){var e=jsPlumb.getDragObject(arguments),t=e==null?null:u.getAttribute(jsPlumb.getDOMElement(e),"dragId"),n=t?m[t]:null;if(n!=null){var r=n.floatingAnchorIndex==null?1:n.floatingAnchorIndex,i=this.isTarget&&n.floatingAnchorIndex!==0||n.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==n.suspendedEndpoint.id;i&&(this.removeClass(u.endpointDropAllowedClass),this.removeClass(u.endpointDropForbiddenClass),n.endpoints[r].anchor.out())}}.bind(this)),u.initDroppable(e,i,!0,n)}}.bind(this);return this.anchor.isFloating||S(f(this.canvas),!0,!o._transient&&!this.anchor.isFloating,this),o.type&&this.addType(o.type,o.data,u.isSuspendDrawing()),this},jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(e,t,n){this._jsPlumb.visible=e,this.canvas&&(this.canvas.style.display=e?"block":"none"),this[e?"showOverlays":"hideOverlays"]();if(!t)for(var r=0;r<this.connections.length;r++){this.connections[r].setVisible(e);if(!n){var i=this===this.connections[r].endpoints[0]?1:0;this.connections[r].endpoints[i].connections.length==1&&this.connections[r].endpoints[i].setVisible(e,!0,!0)}}},getAttachedElements:function(){return this.connections},applyType:function(e,t){e.maxConnections!=null&&(this._jsPlumb.maxConnections=e.maxConnections),e.scope&&(this.scope=e.scope),jsPlumb.extend(this,e,r),e.anchor&&(this.anchor=this._jsPlumb.instance.makeAnchor(e.anchor))},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(e){this._jsPlumb.enabled=e},cleanup:function(){jsPlumbAdapter.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.anchor=null,this.endpoint.cleanup(),this.endpoint.destroy(),this.endpoint=null;var e=jsPlumb.getElementObject(this.canvas);this._jsPlumb.instance.destroyDraggable(e),this._jsPlumb.instance.destroyDroppable(e)},setHover:function(e){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(e)},isFull:function(){return!(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(e){this._jsPlumb.connectionCost=e},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(e){this._jsPlumb.connectionsDirected=e},setElementId:function(e){this.elementId=e,this.anchor.elementId=e},setReferenceElement:function(e){this.element=jsPlumb.getDOMElement(e)},setDragAllowedWhenFull:function(e){this.dragAllowedWhenFull=e},equals:function(e){return this.anchor.equals(e.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(e){return this.anchor.compute(e)}})}(),function(){var e=function(e,t,n,r){if(!e.Defaults.DoNotThrowErrors&&jsPlumb.Connectors[t][n]==null)throw{msg:"jsPlumb: unknown connector type '"+n+"'"};return new jsPlumb.Connectors[t][n](r)},t=function(e,t,n){return e?n.makeAnchor(e,t,n):null};jsPlumb.Connection=function(e){var t=e.newConnection,n=e.newEndpoint,r=jsPlumb.getElementObject,i=jsPlumbUtil;this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=e.previousConnection,this.source=jsPlumb.getDOMElement(e.source),this.target=jsPlumb.getDOMElement(e.target),e.sourceEndpoint&&(this.source=e.sourceEndpoint.endpointWillMoveTo||e.sourceEndpoint.getElement()),e.targetEndpoint&&(this.target=e.targetEndpoint.getElement()),OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=e.scope,this.endpoints=[],this.endpointStyles=[];var s=this._jsPlumb.instance;this._jsPlumb.visible=!0,this._jsPlumb.editable=e.editable===!0,this._jsPlumb.params={cssClass:e.cssClass,container:e.container,"pointer-events":e["pointer-events"],editorParams:e.editorParams},this._jsPlumb.lastPaintedAt=null,this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}},this.makeEndpoint=function(t,r,i,o){return i=i||this._jsPlumb.instance.getId(r),this.prepareEndpoint(s,n,this,o,t?0:1,e,r,i)};var o=this.makeEndpoint(!0,this.source,this.sourceId,e.sourceEndpoint),u=this.makeEndpoint(!1,this.target,this.targetId,e.targetEndpoint);o&&i.addToList(e.endpointsByElement,this.sourceId,o),u&&i.addToList(e.endpointsByElement,this.targetId,u),this.scope||(this.scope=this.endpoints[0].scope),e.deleteEndpointsOnDetach!=null?(this.endpoints[0]._deleteOnDetach=e.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=e.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||e.connector||s.Defaults.Connector||jsPlumb.Defaults.Connector,!0),e.path&&this.connector.setPath(e.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||e.paintStyle||s.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||e.hoverPaintStyle||s.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle();var a=s.getSuspendedAt();s.updateOffset({elId:this.sourceId,timestamp:a}),s.updateOffset({elId:this.targetId,timestamp:a});if(!s.isSuspendDrawing()){var f=s.getCachedData(this.sourceId),l=f.o,c=f.s,h=s.getCachedData(this.targetId),p=h.o,d=h.s,v=a||s.timestamp(),m=this.endpoints[0].anchor.compute({xy:[l.left,l.top],wh:c,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[p.left,p.top],twh:d,tElement:this.endpoints[1],timestamp:v});this.endpoints[0].paint({anchorLoc:m,timestamp:v}),m=this.endpoints[1].anchor.compute({xy:[p.left,p.top],wh:d,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[l.left,l.top],twh:c,tElement:this.endpoints[0],timestamp:v}),this.endpoints[1].paint({anchorLoc:m,timestamp:v})}this._jsPlumb.detachable=s.Defaults.ConnectionsDetachable,e.detachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[0].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[1].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this._jsPlumb.reattach=e.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||s.Defaults.ReattachConnections,this._jsPlumb.cost=e.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=e.directed,e.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var g=jsPlumb.extend({},this.endpoints[1].getParameters());jsPlumb.extend(g,this.endpoints[0].getParameters()),jsPlumb.extend(g,this.getParameters()),this.setParameters(g);var y=[e.type,this.endpoints[0].connectionType,this.endpoints[1].connectionType].join(" ");/[^\s]/.test(y)&&this.addType(y,e.data,!0)},jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(e,t){e.detachable!=null&&this.setDetachable(e.detachable),e.reattach!=null&&this.setReattach(e.reattach),e.scope&&(this.scope=e.scope),this.setConnector(e.connector,t)},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(e,t){t&&(this.endpoints[0].addClass(e),this.endpoints[1].addClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(e)),this.connector&&this.connector.addClass(e)},removeClass:function(e,t){t&&(this.endpoints[0].removeClass(e),this.endpoints[1].removeClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(e)),this.connector&&this.connector.removeClass(e)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(e){this._jsPlumb.visible=e,this.connector&&this.connector.setVisible(e),this.repaint()},cleanup:function(){this.endpoints=null,this.source=null,this.target=null,this.connector!=null&&(this.connector.cleanup(),this.connector.destroy()),this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===!0},setDetachable:function(e){this._jsPlumb.detachable=e===!0},isReattach:function(){return this._jsPlumb.reattach===!0},setReattach:function(e){this._jsPlumb.reattach=e===!0},setHover:function(e){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(e),jsPlumbAdapter[e?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),jsPlumbAdapter[e?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getCost:function(){return this._jsPlumb.cost},setCost:function(e){this._jsPlumb.cost=e},isDirected:function(){return this._jsPlumb.directed===!0},getConnector:function(){return this.connector},setConnector:function(t,n){var r=jsPlumbUtil;this.connector!=null&&(this.connector.cleanup(),this.connector.destroy());var i={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},s=this._jsPlumb.instance.getRenderMode();r.isString(t)?this.connector=e(this._jsPlumb.instance,s,t,i):r.isArray(t)&&(t.length==1?this.connector=e(this._jsPlumb.instance,s,t[0],i):this.connector=e(this._jsPlumb.instance,s,t[0],r.merge(t[1],i))),this.bindListeners(this.connector,this,function(e){this.setHover(e,!1)}.bind(this)),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this._jsPlumb.editable&&jsPlumb.ConnectorEditors!=null&&jsPlumb.ConnectorEditors[this.connector.type]&&this.connector.isEditable()?new jsPlumb.ConnectorEditors[this.connector.type]({connector:this.connector,connection:this,params:this._jsPlumb.params.editorParams||{}}):this._jsPlumb.editable=!1,n||this.repaint()},paint:function(e){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){e=e||{};var t=e.elId,n=e.ui,r=e.recalc,i=e.timestamp,s=!1,o=s?this.sourceId:this.targetId,u=s?this.targetId:this.sourceId,a=s?0:1,f=s?1:0;if(i==null||i!=this._jsPlumb.lastPaintedAt){var l=this._jsPlumb.instance.updateOffset({elId:u,offset:n,recalc:r,timestamp:i}).o,c=this._jsPlumb.instance.updateOffset({elId:o,timestamp:i}).o,h=this.endpoints[f],p=this.endpoints[a];e.clearEdits&&(this._jsPlumb.overlayPositions=null,h.anchor.clearUserDefinedLocation(),p.anchor.clearUserDefinedLocation(),this.connector.setEdited(!1));var d=h.anchor.getCurrentLocation({xy:[l.left,l.top],wh:[l.width,l.height],element:h,timestamp:i}),v=p.anchor.getCurrentLocation({xy:[c.left,c.top],wh:[c.width,c.height],element:p,timestamp:i});this.connector.resetBounds(),this.connector.compute({sourcePos:d,targetPos:v,sourceEndpoint:this.endpoints[f],targetEndpoint:this.endpoints[a],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:l,targetInfo:c,clearEdits:e.clearEdits===!0});var m={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};for(var g=0;g<this._jsPlumb.overlays.length;g++){var y=this._jsPlumb.overlays[g];y.isVisible()&&(this._jsPlumb.overlayPlacements[g]=y.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(y)),m.minX=Math.min(m.minX,this._jsPlumb.overlayPlacements[g].minX),m.maxX=Math.max(m.maxX,this._jsPlumb.overlayPlacements[g].maxX),m.minY=Math.min(m.minY,this._jsPlumb.overlayPlacements[g].minY),m.maxY=Math.max(m.maxY,this._jsPlumb.overlayPlacements[g].maxY))}var b=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,w=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),E={xmin:Math.min(this.connector.bounds.minX-(b+w),m.minX),ymin:Math.min(this.connector.bounds.minY-(b+w),m.minY),xmax:Math.max(this.connector.bounds.maxX+(b+w),m.maxX),ymax:Math.max(this.connector.bounds.maxY+(b+w),m.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,E);for(var S=0;S<this._jsPlumb.overlays.length;S++){var x=this._jsPlumb.overlays[S];x.isVisible()&&x.paint(this._jsPlumb.overlayPlacements[S],E)}}this._jsPlumb.lastPaintedAt=i}},repaint:function(e){e=e||{},this.paint({elId:this.sourceId,recalc:e.recalc!==!1,timestamp:e.timestamp,clearEdits:e.clearEdits})},prepareEndpoint:function(e,n,r,i,s,o,u,a){var f;if(i)r.endpoints[s]=i,i.addConnection(r);else{o.endpoints||(o.endpoints=[null,null]);var l=o.endpoints[s]||o.endpoint||e.Defaults.Endpoints[s]||jsPlumb.Defaults.Endpoints[s]||e.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;o.endpointStyles||(o.endpointStyles=[null,null]),o.endpointHoverStyles||(o.endpointHoverStyles=[null,null]);var c=o.endpointStyles[s]||o.endpointStyle||e.Defaults.EndpointStyles[s]||jsPlumb.Defaults.EndpointStyles[s]||e.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;c.fillStyle==null&&o.paintStyle!=null&&(c.fillStyle=o.paintStyle.strokeStyle),c.outlineColor==null&&o.paintStyle!=null&&(c.outlineColor=o.paintStyle.outlineColor),c.outlineWidth==null&&o.paintStyle!=null&&(c.outlineWidth=o.paintStyle.outlineWidth);var h=o.endpointHoverStyles[s]||o.endpointHoverStyle||e.Defaults.EndpointHoverStyles[s]||jsPlumb.Defaults.EndpointHoverStyles[s]||e.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;o.hoverPaintStyle!=null&&(h==null&&(h={}),h.fillStyle==null&&(h.fillStyle=o.hoverPaintStyle.strokeStyle));var p=o.anchors?o.anchors[s]:o.anchor?o.anchor:t(e.Defaults.Anchors[s],a,e)||t(jsPlumb.Defaults.Anchors[s],a,e)||t(e.Defaults.Anchor,a,e)||t(jsPlumb.Defaults.Anchor,a,e),d=o.uuids?o.uuids[s]:null;f=n({paintStyle:c,hoverPaintStyle:h,endpoint:l,connections:[r],uuid:d,anchor:p,source:u,scope:o.scope,reattach:o.reattach||e.Defaults.ReattachConnections,detachable:o.detachable||e.Defaults.ConnectionsDetachable}),r.endpoints[s]=f,o.drawEndpoints===!1&&f.setVisible(!1,!0,!0)}return f}})}(),function(){jsPlumb.AnchorManager=function(e){var t={},n={},r={},i={},s={},o={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},u={},a=this,f={},l=e.jsPlumbInstance,c={},h=function(e,t,n,r,i,s){if(e===t)return{orientation:o.IDENTITY,a:["top","top"]};var u=Math.atan2(r.centery-n.centery,r.centerx-n.centerx),a=Math.atan2(n.centery-r.centery,n.centerx-r.centerx),f=n.left<=r.left&&n.right>=r.left||n.left<=r.right&&n.right>=r.right||n.left<=r.left&&n.right>=r.right||r.left<=n.left&&r.right>=n.right,l=n.top<=r.top&&n.bottom>=r.top||n.top<=r.bottom&&n.bottom>=r.bottom||n.top<=r.top&&n.bottom>=r.bottom||r.top<=n.top&&r.bottom>=n.bottom,c=function(e){return[i.isContinuous?i.verifyEdge(e[0]):e[0],s.isContinuous?s.verifyEdge(e[1]):e[1]]},h={orientation:o.DIAGONAL,theta:u,theta2:a};return!f&&!l?r.left>n.left&&r.top>n.top?h.a=["right","top"]:r.left>n.left&&n.top>r.top?h.a=["top","left"]:r.left<n.left&&r.top<n.top?h.a=["top","right"]:r.left<n.left&&r.top>n.top&&(h.a=["left","top"]):f?(h.orientation=o.HORIZONTAL,h.a=n.top<r.top?["bottom","top"]:["top","bottom"]):(h.orientation=o.VERTICAL,h.a=n.left<r.left?["right","left"]:["left","right"]),h.a=c(h.a),h},p=function(e,t,n,r,i,s,o){var u=[],a=t[i?0:1]/(r.length+1);for(var f=0;f<r.length;f++){var l=(f+1)*a,c=s*t[i?1:0];o&&(l=t[i?0:1]-l);var h=i?l:c,p=n[0]+h,d=h/t[0],v=i?c:l,m=n[1]+v,g=v/t[1];u.push([p,m,d,g,r[f][1],r[f][2]])}return u},d=function(e){return function(t,n){var r=!0;return e?r=t[0][0]<n[0][0]:r=t[0][0]>n[0][0],r===!1?-1:1}},v=function(e,t){var n=e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0],r=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];return n>r?1:e[0][1]>t[0][1]?1:-1},m={top:function(e,t){return e[0]>t[0]?1:-1},right:d(!0),bottom:d(!0),left:v},g=function(e,t){return e.sort(t)},y=function(e,t){var n=l.getCachedData(e),i=n.s,o=n.o,u=function(t,n,i,o,u,a,f){if(o.length>0){var l=g(o,m[t]),c=t==="right"||t==="top",h=p(t,n,i,l,u,a,c),d=function(e,t){r[e.id]=[t[0],t[1],t[2],t[3]],s[e.id]=f};for(var v=0;v<h.length;v++){var y=h[v][4],b=y.endpoints[0].elementId===e,w=y.endpoints[1].elementId===e;b?d(y.endpoints[0],h[v]):w&&d(y.endpoints[1],h[v])}}};u("bottom",i,[o.left,o.top],t.bottom,!0,1,[0,1]),u("top",i,[o.left,o.top],t.top,!0,0,[0,-1]),u("left",i,[o.left,o.top],t.left,!1,0,[-1,0]),u("right",i,[o.left,o.top],t.right,!1,1,[1,0])};this.reset=function(){t={},u={},f={}},this.addFloatingConnection=function(e,t){c[e]=t},this.removeFloatingConnection=function(e){delete c[e]},this.newConnection=function(e){var t=e.sourceId,n=e.targetId,r=e.endpoints,i=!0,s=function(s,o,a,f,l){t==n&&a.isContinuous&&(e._jsPlumb.instance.removeElement(r[1].canvas),i=!1),jsPlumbUtil.addToList(u,f,[l,o,a.constructor==jsPlumb.DynamicAnchor])};s(0,r[0],r[0].anchor,n,e),i&&s(1,r[1],r[1].anchor,t,e)};var b=function(e){(function(e,t){if(e){var n=function(e){return e[4]==t};jsPlumbUtil.removeWithFunction(e.top,n),jsPlumbUtil.removeWithFunction(e.left,n),jsPlumbUtil.removeWithFunction(e.bottom,n),jsPlumbUtil.removeWithFunction(e.right,n)}})(f[e.elementId],e.id)};this.connectionDetached=function(e){var t=e.connection||e,n=e.sourceId,r=e.targetId,i=t.endpoints,s=function(e,t,n,r,i){(n==null||n.constructor!=jsPlumb.FloatingAnchor)&&jsPlumbUtil.removeWithFunction(u[r],function(e){return e[0].id==i.id})};s(1,i[1],i[1].anchor,n,t),s(0,i[0],i[0].anchor,r,t),b(t.endpoints[0]),b(t.endpoints[1]),a.redraw(t.sourceId),a.redraw(t.targetId)},this.add=function(e,n){jsPlumbUtil.addToList(t,n,e)},this.changeId=function(e,n){u[n]=u[e],t[n]=t[e],delete u[e],delete t[e]},this.getConnectionsFor=function(e){return u[e]||[]},this.getEndpointsFor=function(e){return t[e]||[]},this.deleteEndpoint=function(e){jsPlumbUtil.removeWithFunction(t[e.elementId],function(t){return t.id==e.id}),b(e)},this.clearFor=function(e){delete t[e],t[e]=[]};var w=function(t,n,r,i,s,o,u,a,f,l,c,h){var p=-1,d=-1,v=i.endpoints[u],m=v.id,g=[1,0][u],y=[[n,r],i,s,o,m],b=t[f],w=v._continuousAnchorEdge?t[v._continuousAnchorEdge]:null;if(w){var E=jsPlumbUtil.findWithFunction(w,function(e){return e[4]==m});if(E!=-1){w.splice(E,1);for(var S=0;S<w.length;S++)jsPlumbUtil.addWithFunction(c,w[S][1],function(e){return e.id==w[S][1].id}),jsPlumbUtil.addWithFunction(h,w[S][1].endpoints[u],function(e){return e.id==w[S][1].endpoints[u].id}),jsPlumbUtil.addWithFunction(h,w[S][1].endpoints[g],function(e){return e.id==w[S][1].endpoints[g].id})}}for(S=0;S<b.length;S++)e.idx==1&&b[S][3]===o&&d==-1&&(d=S),jsPlumbUtil.addWithFunction(c,b[S][1],function(e){return e.id==b[S][1].id}),jsPlumbUtil.addWithFunction(h,b[S][1].endpoints[u],function(e){return e.id==b[S][1].endpoints[u].id}),jsPlumbUtil.addWithFunction(h,b[S][1].endpoints[g],function(e){return e.id==b[S][1].endpoints[g].id});if(p!=-1)b[p]=y;else{var x=a?d!=-1?d:0:b.length;b.splice(x,0,y)}v._continuousAnchorEdge=f};this.updateOtherEndpoint=function(e,t,n,r){var i=jsPlumbUtil.findWithFunction(u[e],function(e){return e[0].id===r.id}),s=jsPlumbUtil.findWithFunction(u[t],function(e){return e[0].id===r.id});i!=-1&&(u[e][i][0]=r,u[e][i][1]=r.endpoints[1],u[e][i][2]=r.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor),s>-1&&(u[t].splice(s,1),jsPlumbUtil.addToList(u,n,[r,r.endpoints[0],r.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor]))},this.sourceChanged=function(e,t,n){if(e!==t){jsPlumbUtil.removeWithFunction(u[e],function(e){return e[0].id===n.id});var r=jsPlumbUtil.findWithFunction(u[n.targetId],function(e){return e[0].id===n.id});r>-1&&(u[n.targetId][r][0]=n,u[n.targetId][r][1]=n.endpoints[0],u[n.targetId][r][2]=n.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor),jsPlumbUtil.addToList(u,t,[n,n.endpoints[1],n.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])}},this.rehomeEndpoint=function(e,n,r){var i=t[n]||[],s=l.getId(r);if(s!==n){var o=jsPlumbUtil.indexOf(i,e);if(o>-1){var u=i.splice(o,1)[0];a.add(u,s)}}for(var f=0;f<e.connections.length;f++)e.connections[f].sourceId==n?(e.connections[f].sourceId=e.elementId,e.connections[f].source=e.element,a.sourceChanged(n,e.elementId,e.connections[f])):e.connections[f].targetId==n&&(e.connections[f].targetId=e.elementId,e.connections[f].target=e.element,a.updateOtherEndpoint(e.connections[f].sourceId,n,e.elementId,e.connections[f]))},this.redraw=function(e,n,r,i,s,o){if(!l.isSuspendDrawing()){var a=t[e]||[],p=u[e]||[],d=[],v=[],m=[];r=r||l.timestamp(),i=i||{left:0,top:0},n&&(n={left:n.left+i.left,top:n.top+i.top});var g=l.updateOffset({elId:e,offset:n,recalc:!1,timestamp:r}),b={};for(var E=0;E<p.length;E++){var S=p[E][0],x=S.sourceId,T=S.targetId,N=S.endpoints[0].anchor.isContinuous,C=S.endpoints[1].anchor.isContinuous;if(N||C){var k=x+"_"+T,L=T+"_"+x,A=b[k],O=S.sourceId==e?1:0;N&&!f[x]&&(f[x]={top:[],right:[],bottom:[],left:[]}),C&&!f[T]&&(f[T]={top:[],right:[],bottom:[],left:[]}),e!=T&&l.updateOffset({elId:T,timestamp:r}),e!=x&&l.updateOffset({elId:x,timestamp:r});var M=l.getCachedData(T),_=l.getCachedData(x);T==x&&(N||C)?w(f[x],-Math.PI/2,0,S,!1,T,0,!1,"top",x,d,v):(A||(A=h(x,T,_.o,M.o,S.endpoints[0].anchor,S.endpoints[1].anchor),b[k]=A),N&&w(f[x],A.theta,0,S,!1,T,0,!1,A.a[0],x,d,v),C&&w(f[T],A.theta2,-1,S,!0,x,1,!0,A.a[1],T,d,v)),N&&jsPlumbUtil.addWithFunction(m,x,function(e){return e===x}),C&&jsPlumbUtil.addWithFunction(m,T,function(e){return e===T}),jsPlumbUtil.addWithFunction(d,S,function(e){return e.id==S.id}),(N&&O===0||C&&O===1)&&jsPlumbUtil.addWithFunction(v,S.endpoints[O],function(e){return e.id==S.endpoints[O].id})}}for(E=0;E<a.length;E++)a[E].connections.length===0&&a[E].anchor.isContinuous&&(f[e]||(f[e]={top:[],right:[],bottom:[],left:[]}),w(f[e],-Math.PI/2,0,{endpoints:[a[E],a[E]],paint:function(){}},!1,e,0,!1,"top",e,d,v),jsPlumbUtil.addWithFunction(m,e,function(t){return t===e}));for(E=0;E<m.length;E++)y(m[E],f[m[E]]);for(E=0;E<a.length;E++)a[E].paint({timestamp:r,offset:g,dimensions:g.s,recalc:o!==!0});for(E=0;E<v.length;E++){var D=l.getCachedData(v[E].elementId);v[E].paint({timestamp:r,offset:D,dimensions:D.s})}for(E=0;E<p.length;E++){var P=p[E][1];if(P.anchor.constructor==jsPlumb.DynamicAnchor){P.paint({elementWithPrecedence:e,timestamp:r}),jsPlumbUtil.addWithFunction(d,p[E][0],function(e){return e.id==p[E][0].id});for(var H=0;H<P.connections.length;H++)P.connections[H]!==p[E][0]&&jsPlumbUtil.addWithFunction(d,P.connections[H],function(e){return e.id==P.connections[H].id})}else P.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(d,p[E][0],function(e){return e.id==p[E][0].id})}var B=c[e];B&&B.paint({timestamp:r,recalc:!1,elId:e});for(E=0;E<d.length;E++){var j=r;d[E].paint({elId:e,timestamp:j,recalc:!1,clearEdits:s})}}};var E=function(e){jsPlumbUtil.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;var t=e.faces||["top","right","bottom","left"],n=e.clockwise!==!1,o={},u={top:"bottom",right:"left",left:"right",bottom:"top"},a={top:"right",right:"bottom",left:"top",bottom:"left"},f={top:"left",right:"top",left:"bottom",bottom:"right"},l=n?a:f,c=n?f:a,h=e.cssClass||"";for(var p=0;p<t.length;p++)o[t[p]]=!0;this.verifyEdge=function(e){return o[e]?e:o[u[e]]?u[e]:o[l[e]]?l[e]:o[c[e]]?c[e]:e},this.compute=function(e){return i[e.element.id]||r[e.element.id]||[0,0]},this.getCurrentLocation=function(e){return i[e.element.id]||r[e.element.id]||[0,0]},this.getOrientation=function(e){return s[e.id]||[0,0]},this.clearUserDefinedLocation=function(){delete i[e.elementId]},this.setUserDefinedLocation=function(t){i[e.elementId]=t},this.getCssClass=function(){return h},this.setCssClass=function(e){h=e}};l.continuousAnchorFactory={get:function(e){var t=n[e.elementId];return t||(t=new E(e),n[e.elementId]=t),t},clear:function(e){delete n[e]}}},jsPlumb.Anchor=function(e){this.x=e.x||0,this.y=e.y||0,this.elementId=e.elementId,this.cssClass=e.cssClass||"",this.userDefinedLocation=null,this.orientation=e.orientation||[0,0],jsPlumbUtil.EventGenerator.apply(this);var t=e.jsPlumbInstance;this.lastReturnValue=null,this.offsets=e.offsets||[0,0],this.timestamp=null,this.compute=function(e){var t=e.xy,n=e.wh,r=e.element,i=e.timestamp;return e.clearUserDefinedLocation&&(this.userDefinedLocation=null),i&&i===self.timestamp?this.lastReturnValue:(this.userDefinedLocation!=null?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[t[0]+this.x*n[0]+this.offsets[0],t[1]+this.y*n[1]+this.offsets[1]],this.timestamp=i,this.lastReturnValue)},this.getCurrentLocation=function(e){return this.lastReturnValue==null||e.timestamp!=null&&this.timestamp!=e.timestamp?this.compute(e):this.lastReturnValue}},jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(e){if(!e)return!1;var t=e.getOrientation(),n=this.getOrientation();return this.x==e.x&&this.y==e.y&&this.offsets[0]==e.offsets[0]&&this.offsets[1]==e.offsets[1]&&n[0]==t[0]&&n[1]==t[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(e){this.userDefinedLocation=e},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(e){return this.orientation},getCssClass:function(){return this.cssClass}}),jsPlumb.FloatingAnchor=function(e){jsPlumb.Anchor.apply(this,arguments);var t=e.reference,n=e.jsPlumbInstance,r=e.referenceCanvas,i=jsPlumb.getSize(r),s=0,o=0,u=null,a=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(e){var t=e.xy,n=e.element,r=[t[0]+i[0]/2,t[1]+i[1]/2];return a=r,r},this.getOrientation=function(e){if(u)return u;var n=t.getOrientation(e);return[Math.abs(n[0])*s*-1,Math.abs(n[1])*o*-1]},this.over=function(e,t){u=e.getOrientation(t)},this.out=function(){u=null},this.getCurrentLocation=function(e){return a==null?this.compute(e):a}},jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);var e=function(e,t,n){return e.constructor==jsPlumb.Anchor?e:t.makeAnchor(e,n,t)};jsPlumb.DynamicAnchor=function(t){jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0,this.anchors=[],this.elementId=t.elementId,this.jsPlumbInstance=t.jsPlumbInstance;for(var n=0;n<t.anchors.length;n++)this.anchors[n]=e(t.anchors[n],this.jsPlumbInstance,this.elementId);this.addAnchor=function(t){this.anchors.push(e(t,this.jsPlumbInstance,this.elementId))},this.getAnchors=function(){return this.anchors},this.locked=!1;var r=this.anchors.length>0?this.anchors[0]:null,i=this.anchors.length>0?0:-1,s=r,o=this,u=function(e,t,n,r,i){var s=r[0]+e.x*i[0],o=r[1]+e.y*i[1],u=r[0]+i[0]/2,a=r[1]+i[1]/2;return Math.sqrt(Math.pow(t-s,2)+Math.pow(n-o,2))+Math.sqrt(Math.pow(u-s,2)+Math.pow(a-o,2))},a=t.selector||function(e,t,n,r,i){var s=n[0]+r[0]/2,o=n[1]+r[1]/2,a=-1,f=Infinity;for(var l=0;l<i.length;l++){var c=u(i[l],s,o,e,t);c<f&&(a=l+0,f=c)}return i[a]};this.compute=function(e){var t=e.xy,n=e.wh,i=e.timestamp,u=e.txy,f=e.twh;e.clearUserDefinedLocation&&(userDefinedLocation=null),this.timestamp=i;var l=o.getUserDefinedLocation();return l!=null?l:this.locked||u==null||f==null?r.compute(e):(e.timestamp=null,r=a(t,n,u,f,this.anchors),this.x=r.x,this.y=r.y,r!=s&&this.fire("anchorChanged",r),s=r,r.compute(e))},this.getCurrentLocation=function(e){return this.getUserDefinedLocation()||(r!=null?r.getCurrentLocation(e):null)},this.getOrientation=function(e){return r!=null?r.getOrientation(e):[0,0]},this.over=function(e,t){r!=null&&r.over(e,t)},this.out=function(){r!=null&&r.out()},this.getCssClass=function(){return r&&r.getCssClass()||""}},jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);var t=function(e,t,n,r,i,s){jsPlumb.Anchors[i]=function(o){var u=o.jsPlumbInstance.makeAnchor([e,t,n,r,0,0],o.elementId,o.jsPlumbInstance);return u.type=i,s&&s(u,o),u}};t(.5,0,0,-1,"TopCenter"),t(.5,1,0,1,"BottomCenter"),t(0,.5,-1,0,"LeftMiddle"),t(1,.5,1,0,"RightMiddle"),t(.5,0,0,-1,"Top"),t(.5,1,0,1,"Bottom"),t(0,.5,-1,0,"Left"),t(1,.5,1,0,"Right"),t(.5,.5,0,0,"Center"),t(1,0,0,-1,"TopRight"),t(1,1,0,1,"BottomRight"),t(0,0,0,-1,"TopLeft"),t(0,1,0,1,"BottomLeft"),jsPlumb.Defaults.DynamicAnchors=function(e){return e.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],e.elementId,e.jsPlumbInstance)},jsPlumb.Anchors.AutoDefault=function(e){var t=e.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(e));return t.type="AutoDefault",t};var n=function(e,t){jsPlumb.Anchors[e]=function(n){var r=n.jsPlumbInstance.makeAnchor(["Continuous",{faces:t}],n.elementId,n.jsPlumbInstance);return r.type=e,r}};jsPlumb.Anchors.Continuous=function(e){return e.jsPlumbInstance.continuousAnchorFactory.get(e)},n("ContinuousLeft",["left"]),n("ContinuousTop",["top"]),n("ContinuousBottom",["bottom"]),n("ContinuousRight",["right"]),t(0,0,0,0,"Assign",function(e,t){var n=t.position||"Fixed";e.positionFinder=n.constructor==String?t.jsPlumbInstance.AnchorPositionFinders[n]:n,e.constructorParams=t}),jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(e,t,n,r){return[(e.left-t.left)/n[0],(e.top-t.top)/n[1]]},Grid:function(e,t,n,r){var i=e.left-t.left,s=e.top-t.top,o=n[0]/r.grid[0],u=n[1]/r.grid[1],a=Math.floor(i/o),f=Math.floor(s/u);return[(a*o+o/2)/n[0],(f*u+u/2)/n[1]]}},jsPlumb.Anchors.Perimeter=function(e){e=e||{};var t=e.anchorCount||60,n=e.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");var r=function(){var e=.5,n=Math.PI*2/t,r=0,i=[];for(var s=0;s<t;s++){var o=e+e*Math.sin(r),u=e+e*Math.cos(r);i.push([o,u,0,0]),r+=n}return i},i=function(e){var n=t/e.length,r=[],i=function(e,i,s,o,u){n=t*u;var a=(s-e)/n,f=(o-i)/n;for(var l=0;l<n;l++)r.push([e+a*l,i+f*l,0,0])};for(var s=0;s<e.length;s++)i.apply(null,e[s]);return r},s=function(e){var t=[];for(var n=0;n<e.length;n++)t.push([e[n][0],e[n][1],e[n][2],e[n][3],1/e.length]);return i(t)},o=function(){return s([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},u={Circle:r,Ellipse:r,Diamond:function(){return s([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:o,Square:o,Triangle:function(){return s([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(e){var t=e.points,n=[],r=0;for(var s=0;s<t.length-1;s++){var o=Math.sqrt(Math.pow(t[s][2]-t[s][0])+Math.pow(t[s][3]-t[s][1]));r+=o,n.push([t[s][0],t[s][1],t[s+1][0],t[s+1][1],o])}for(var u=0;u<n.length;u++)n[u][4]=n[u][4]/r;return i(n)}},a=function(e,t){var n=[],r=t/180*Math.PI;for(var i=0;i<e.length;i++){var s=e[i][0]-.5,o=e[i][1]-.5;n.push([.5+(s*Math.cos(r)-o*Math.sin(r)),.5+(s*Math.sin(r)+o*Math.cos(r)),e[i][2],e[i][3]])}return n};if(!u[n])throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var f=u[n](e);e.rotation&&(f=a(f,e.rotation));var l=e.jsPlumbInstance.makeDynamicAnchor(f);return l.type="Perimeter",l}}(),function(){jsPlumb.DOMElementComponent=jsPlumbUtil.extend(jsPlumb.jsPlumbUIComponent,function(e){this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(e){}}),jsPlumb.Segments={AbstractSegment:function(e){this.params=e,this.findClosestPointOnPath=function(e,t){return{d:Infinity,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(e.x1,e.x2),minY:Math.min(e.y1,e.y2),maxX:Math.max(e.x1,e.x2),maxY:Math.max(e.y1,e.y2)}}},Straight:function(e){var t=jsPlumb.Segments.AbstractSegment.apply(this,arguments),n,r,i,s,o,u,a,f=function(){n=Math.sqrt(Math.pow(o-s,2)+Math.pow(a-u,2)),r=Biltong.gradient({x:s,y:u},{x:o,y:a}),i=-1/r};this.type="Straight",this.getLength=function(){return n},this.getGradient=function(){return r},this.getCoordinates=function(){return{x1:s,y1:u,x2:o,y2:a}},this.setCoordinates=function(e){s=e.x1,u=e.y1,o=e.x2,a=e.y2,f()},this.setCoordinates({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),this.getBounds=function(){return{minX:Math.min(s,o),minY:Math.min(u,a),maxX:Math.max(s,o),maxY:Math.max(u,a)}},this.pointOnPath=function(e,t){if(e===0&&!t)return{x:s,y:u};if(e==1&&!t)return{x:o,y:a};var r=t?e>0?e:n+e:e*n;return Biltong.pointOnLine({x:s,y:u},{x:o,y:a},r)},this.gradientAtPoint=function(e){return r},this.pointAlongPathFrom=function(e,t,n){var r=this.pointOnPath(e,n),i=t<=0?{x:s,y:u}:{x:o,y:a};return t<=0&&Math.abs(t)>1&&(t*=-1),Biltong.pointOnLine(r,i,t)};var l=function(e,t,n){return n>=Math.min(e,t)&&n<=Math.max(e,t)},c=function(e,t,n){return Math.abs(n-e)<Math.abs(n-t)?e:t};this.findClosestPointOnPath=function(e,t){var f={d:Infinity,x:null,y:null,l:null,x1:s,x2:o,y1:u,y2:a};if(r===0)f.y=u,f.x=l(s,o,e)?e:c(s,o,e);else if(r==Infinity||r==-Infinity)f.x=s,f.y=l(u,a,t)?t:c(u,a,t);else{var h=u-r*s,p=t-i*e,d=(p-h)/(r-i),v=r*d+h;f.x=l(s,o,d)?d:c(s,o,d),f.y=l(u,a,v)?v:c(u,a,v)}var g=Biltong.lineLength([f.x,f.y],[s,u]);return f.d=Biltong.lineLength([e,t],[f.x,f.y]),f.l=g/n,f}},Arc:function(e){var t=jsPlumb.Segments.AbstractSegment.apply(this,arguments),n=function(t,n){return Biltong.theta([e.cx,e.cy],[t,n])},r=function(e,t){if(e.anticlockwise){var n=e.startAngle<e.endAngle?e.startAngle+i:e.startAngle,r=Math.abs(n-e.endAngle);return n-r*t}var s=e.endAngle<e.startAngle?e.endAngle+i:e.endAngle,o=Math.abs(s-e.startAngle);return e.startAngle+o*t},i=2*Math.PI;this.radius=e.r,this.anticlockwise=e.ac,this.type="Arc",e.startAngle&&e.endAngle?(this.startAngle=e.startAngle,this.endAngle=e.endAngle,this.x1=e.cx+this.radius*Math.cos(e.startAngle),this.y1=e.cy+this.radius*Math.sin(e.startAngle),this.x2=e.cx+this.radius*Math.cos(e.endAngle),this.y2=e.cy+this.radius*Math.sin(e.endAngle)):(this.startAngle=n(e.x1,e.y1),this.endAngle=n(e.x2,e.y2),this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2),this.endAngle<0&&(this.endAngle+=i),this.startAngle<0&&(this.startAngle+=i),this.segment=Biltong.quadrant([this.x1,this.y1],[this.x2,this.y2]);var s=this.endAngle<this.startAngle?this.endAngle+i:this.endAngle;this.sweep=Math.abs(s-this.startAngle),this.anticlockwise&&(this.sweep=i-this.sweep);var o=2*Math.PI*this.radius,u=this.sweep/i,a=o*u;this.getLength=function(){return a},this.getBounds=function(){return{minX:e.cx-e.r,maxX:e.cx+e.r,minY:e.cy-e.r,maxY:e.cy+e.r}};var f=1e-10,l=function(e){var t=Math.floor(e),n=Math.ceil(e);return e-t<f?t:n-e<f?n:e};this.pointOnPath=function(t,n){if(t===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(t==1)return{x:this.x2,y:this.y2,theta:this.endAngle};n&&(t/=a);var i=r(this,t),s=e.cx+e.r*Math.cos(i),o=e.cy+e.r*Math.sin(i);return{x:l(s),y:l(o),theta:i}},this.gradientAtPoint=function(t,n){var r=this.pointOnPath(t,n),i=Biltong.normal([e.cx,e.cy],[r.x,r.y]);return!this.anticlockwise&&(i==Infinity||i==-Infinity)&&(i*=-1),i},this.pointAlongPathFrom=function(t,n,r){var i=this.pointOnPath(t,r),s=n/o*2*Math.PI,u=this.anticlockwise?-1:1,a=i.theta+u*s,f=e.cx+this.radius*Math.cos(a),l=e.cy+this.radius*Math.sin(a);return{x:f,y:l}}},Bezier:function(e){var t=jsPlumb.Segments.AbstractSegment.apply(this,arguments),n=[{x:e.x1,y:e.y1},{x:e.cp1x,y:e.cp1y},{x:e.cp2x,y:e.cp2y},{x:e.x2,y:e.y2}],r={minX:Math.min(e.x1,e.x2,e.cp1x,e.cp2x),minY:Math.min(e.y1,e.y2,e.cp1y,e.cp2y),maxX:Math.max(e.x1,e.x2,e.cp1x,e.cp2x),maxY:Math.max(e.y1,e.y2,e.cp1y,e.cp2y)};this.type="Bezier";var i=function(e,t,n){return n&&(t=jsBezier.locationAlongCurveFrom(e,t>0?0:1,t)),t};this.pointOnPath=function(e,t){return e=i(n,e,t),jsBezier.pointOnCurve(n,e)},this.gradientAtPoint=function(e,t){return e=i(n,e,t),jsBezier.gradientAtPoint(n,e)},this.pointAlongPathFrom=function(e,t,r){return e=i(n,e,r),jsBezier.pointAlongCurveFrom(n,e,t)},this.getLength=function(){return jsBezier.getLength(n)},this.getBounds=function(){return r}}};var e=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}},this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(t){e.apply(this,arguments);var n=[],r=!1,i=0,s=[],o=[],u=t.stub||0,a=jsPlumbUtil.isArray(u)?u[0]:u,f=jsPlumbUtil.isArray(u)?u[1]:u,l=t.gap||0,c=jsPlumbUtil.isArray(l)?l[0]:l,h=jsPlumbUtil.isArray(l)?l[1]:l,p=null,d=!1,v=null;this.isEditable=function(){return!1},this.setEdited=function(e){d=e},this.getPath=function(){},this.setPath=function(e){},this.findSegmentForPoint=function(e,t){var r={d:Infinity,s:null,x:null,y:null,l:null};for(var i=0;i<n.length;i++){var s=n[i].findClosestPointOnPath(e,t);s.d<r.d&&(r.d=s.d,r.l=s.l,r.x=s.x,r.y=s.y,r.s=n[i],r.x1=s.x1,r.x2=s.x2,r.y1=s.y1,r.y2=s.y2,r.index=i)}return r};var m=function(){var e=0;for(var t=0;t<n.length;t++){var r=n[t].getLength();o[t]=r/i,s[t]=[e,e+=r/i]}},g=function(e,t){t&&(e=e>0?e/i:(i+e)/i);var r=s.length-1,u=1;for(var a=0;a<s.length;a++)if(s[a][1]>=e){r=a,u=e==1?1:e===0?0:(e-s[a][0])/o[a];break}return{segment:n[r],proportion:u,index:r}},y=function(e,t,r){if(r.x1==r.x2&&r.y1==r.y2)return;var s=new jsPlumb.Segments[t](r);n.push(s),i+=s.getLength(),e.updateBounds(s)},b=function(){i=n.length=s.length=o.length=0};this.setSegments=function(e){p=[],i=0;for(var t=0;t<e.length;t++)p.push(e[t]),i+=e[t].getLength()};var w=function(e){this.lineWidth=e.lineWidth;var t=Biltong.quadrant(e.sourcePos,e.targetPos),n=e.targetPos[0]<e.sourcePos[0],r=e.targetPos[1]<e.sourcePos[1],i=e.lineWidth||1,s=e.sourceEndpoint.anchor.getOrientation(e.sourceEndpoint),o=e.targetEndpoint.anchor.getOrientation(e.targetEndpoint),u=n?e.targetPos[0]:e.sourcePos[0],l=r?e.targetPos[1]:e.sourcePos[1],p=Math.abs(e.targetPos[0]-e.sourcePos[0]),d=Math.abs(e.targetPos[1]-e.sourcePos[1]);if(s[0]===0&&s[1]===0||o[0]===0&&o[1]===0){var v=p>d?0:1,m=[1,0][v];s=[],o=[],s[v]=e.sourcePos[v]>e.targetPos[v]?-1:1,o[v]=e.sourcePos[v]>e.targetPos[v]?1:-1,s[m]=0,o[m]=0}var g=n?p+c*s[0]:c*s[0],y=r?d+c*s[1]:c*s[1],b=n?h*o[0]:p+h*o[0],w=r?h*o[1]:d+h*o[1],E=s[0]*o[0]+s[1]*o[1],S={sx:g,sy:y,tx:b,ty:w,lw:i,xSpan:Math.abs(b-g),ySpan:Math.abs(w-y),mx:(g+b)/2,my:(y+w)/2,so:s,to:o,x:u,y:l,w:p,h:d,segment:t,startStubX:g+s[0]*a,startStubY:y+s[1]*a,endStubX:b+o[0]*f,endStubY:w+o[1]*f,isXGreaterThanStubTimes2:Math.abs(g-b)>a+f,isYGreaterThanStubTimes2:Math.abs(y-w)>a+f,opposite:E==-1,perpendicular:E===0,orthogonal:E==1,sourceAxis:s[0]===0?"y":"x",points:[u,l,p,d,g,y,b,w]};return S.anchorOrientation=S.opposite?"opposite":S.orthogonal?"orthogonal":"perpendicular",S};this.getSegments=function(){return n},this.updateBounds=function(e){var t=e.getBounds();this.bounds.minX=Math.min(this.bounds.minX,t.minX),this.bounds.maxX=Math.max(this.bounds.maxX,t.maxX),this.bounds.minY=Math.min(this.bounds.minY,t.minY),this.bounds.maxY=Math.max(this.bounds.maxY,t.maxY)};var E=function(){console.log("SEGMENTS:");for(var e=0;e<n.length;e++)console.log(n[e].type,n[e].getLength(),s[e])};return this.pointOnPath=function(e,t){var n=g(e,t);return n.segment&&n.segment.pointOnPath(n.proportion,!1)||[0,0]},this.gradientAtPoint=function(e,t){var n=g(e,t);return n.segment&&n.segment.gradientAtPoint(n.proportion,!1)||0},this.pointAlongPathFrom=function(e,t,n){var r=g(e,n);return r.segment&&r.segment.pointAlongPathFrom(r.proportion,t,!1)||[0,0]},this.compute=function(e){d||(v=w.call(this,e)),b(),this._compute(v,e),this.x=v.points[0],this.y=v.points[1],this.w=v.points[2],this.h=v.points[3],this.segment=v.segment,m()},{addSegment:y,prepareCompute:w,sourceStub:a,targetStub:f,maxStub:Math.max(a,f),sourceGap:c,targetGap:h,maxGap:Math.max(c,h)}},jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,e);var t=jsPlumb.Connectors.Straight=function(){this.type="Straight";var e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t,n){e.addSegment(this,"Straight",{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY}),e.addSegment(this,"Straight",{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY}),e.addSegment(this,"Straight",{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(t,"Straight"),jsPlumb.Endpoints.AbstractEndpoint=function(t){e.apply(this,arguments);var n=this.compute=function(e,t,n,r){var i=this._compute.apply(this,arguments);return this.x=i[0],this.y=i[1],this.w=i[2],this.h=i[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,i};return{compute:n,cssClass:t.cssClass}},jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,e),jsPlumb.Endpoints.Dot=function(e){this.type="Dot";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);e=e||{},this.radius=e.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(e,t,n,r){this.radius=n.radius||this.radius;var i=e[0]-this.radius,s=e[1]-this.radius,o=this.radius*2,u=this.radius*2;if(n.strokeStyle){var a=n.lineWidth||1;i-=a,s-=a,o+=a*2,u+=a*2}return[i,s,o,u,this.radius]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint),jsPlumb.Endpoints.Rectangle=function(e){this.type="Rectangle";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);e=e||{},this.width=e.width||20,this.height=e.height||20,this._compute=function(e,t,n,r){var i=n.width||this.width,s=n.height||this.height,o=e[0]-i/2,u=e[1]-s/2;return[o,u,i,s]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);var n=function(e){jsPlumb.DOMElementComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(n,jsPlumb.DOMElementComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(e){this._jsPlumb.displayElements.push(e)}}),jsPlumb.Endpoints.Image=function(e){this.type="Image",n.apply(this,arguments),jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var t=e.onload,r=e.src||e.url,i=e.cssClass?" "+e.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=e.width,this._jsPlumb.heightToUse=e.height,this._jsPlumb.endpoint=e.endpoint,this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,t&&t(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(e,n){var r=e.constructor==String?e:e.src;t=n,this._jsPlumb.img.src=r,this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(r,t),this._compute=function(e,t,n,r){return this.anchorPoint=e,this._jsPlumb.ready?[e[0]-this._jsPlumb.widthToUse/2,e[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=document.createElement("img"),this.canvas.style.margin=0,this.canvas.style.padding=0,this.canvas.style.outline=0,this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.instance.endpointClass+i,this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.attachListeners(this.canvas,this),this.actuallyPaint=function(e,t,n){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var r=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,i=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;jsPlumbUtil.sizeElement(this.canvas,r,i,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(e,t){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(e,t):window.setTimeout(function(){this.paint(e,t)}.bind(this),200))}},jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[n,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null}}),jsPlumb.Endpoints.Blank=function(e){var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank",n.apply(this,arguments),this._compute=function(e,t,n,r){return[e[0],e[1],10,0]},this.canvas=document.createElement("div"),this.canvas.style.display="block",this.canvas.style.width="1px",this.canvas.style.height="1px",this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.endpointClass,jsPlumb.appendElement(this.canvas),this.paint=function(e,t){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,n],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),jsPlumb.Endpoints.Triangle=function(e){this.type="Triangle";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);e=e||{},e.width=e.width||55,e.height=e.height||55,this.width=e.width,this.height=e.height,this._compute=function(e,t,n,r){var i=n.width||self.width,s=n.height||self.height,o=e[0]-i/2,u=e[1]-s/2;return[o,u,i,s]}};var r=jsPlumb.Overlays.AbstractOverlay=function(e){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=e.component,this.loc=e.location==null?.5:e.location,this.endpointLoc=e.endpointLocation==null?[.5,.5]:e.endpointLocation};r.prototype={cleanup:function(){this.component=null,this.canvas=null,this.endpointLoc=null},setVisible:function(e){this.visible=e,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(e){this.loc+=e,this.component.repaint()},setLocation:function(e){this.loc=e,this.component.repaint()},getLocation:function(){return this.loc}},jsPlumb.Overlays.Arrow=function(e){this.type="Arrow",r.apply(this,arguments),this.isAppendedAtTopLevel=!1,e=e||{};var t=jsPlumbUtil,n=Biltong;this.length=e.length||20,this.width=e.width||20,this.id=e.id;var i=(e.direction||1)<0?-1:1,s=e.paintStyle||{lineWidth:1},o=e.foldback||.623;this.computeMaxSize=function(){return self.width*1.5},this.draw=function(e,r){var u,a,f,l,c;if(e.pointAlongPathFrom){if(t.isString(this.loc)||this.loc>1||this.loc<0){var h=parseInt(this.loc,10),p=this.loc<0?1:0;u=e.pointAlongPathFrom(p,h,!1),a=e.pointAlongPathFrom(p,h-i*this.length/2,!1),f=n.pointOnLine(u,a,this.length)}else if(this.loc==1){u=e.pointOnPath(this.loc),a=e.pointAlongPathFrom(this.loc,-this.length),f=n.pointOnLine(u,a,this.length);if(i==-1){var d=f;f=u,u=d}}else if(this.loc===0){f=e.pointOnPath(this.loc),a=e.pointAlongPathFrom(this.loc,this.length),u=n.pointOnLine(f,a,this.length);if(i==-1){var v=f;f=u,u=v}}else u=e.pointAlongPathFrom(this.loc,i*this.length/2),a=e.pointOnPath(this.loc),f=n.pointOnLine(u,a,this.length);l=n.perpendicularLineTo(u,f,this.width),c=n.pointOnLine(u,f,o*this.length);var m={hxy:u,tail:l,cxy:c},g=s.strokeStyle||r.strokeStyle,y=s.fillStyle||r.strokeStyle,b=s.lineWidth||r.lineWidth,w={component:e,d:m,lineWidth:b,strokeStyle:g,fillStyle:y,minX:Math.min(u.x,l[0].x,l[1].x),maxX:Math.max(u.x,l[0].x,l[1].x),minY:Math.min(u.y,l[0].y,l[1].y),maxY:Math.max(u.y,l[0].y,l[1].y)};return w}return{component:e,minX:0,maxX:0,minY:0,maxY:0}}},jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,r),jsPlumb.Overlays.PlainArrow=function(e){e=e||{};var t=jsPlumb.extend(e,{foldback:1});jsPlumb.Overlays.Arrow.call(this,t),this.type="PlainArrow"},jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow),jsPlumb.Overlays.Diamond=function(e){e=e||{};var t=e.length||40,n=jsPlumb.extend(e,{length:t/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,n),this.type="Diamond"},jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);var i=function(e){return e._jsPlumb.cachedDimensions==null&&(e._jsPlumb.cachedDimensions=e.getDimensions()),e._jsPlumb.cachedDimensions},s=function(e){jsPlumb.DOMElementComponent.apply(this,arguments),r.apply(this,arguments),this.id=e.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=e.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=e.create,this.getElement=function(){if(this._jsPlumb.div==null){var t=this._jsPlumb.div=jsPlumb.getDOMElement(this._jsPlumb.create(this._jsPlumb.component));t.style.position="absolute";var n=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:e.cssClass?e.cssClass:"");t.className=n,this._jsPlumb.instance.appendElement(t),this._jsPlumb.instance.getId(t),this.attachListeners(t,this),this.canvas=t}return this._jsPlumb.div},this.draw=function(e,t,n){var r=i(this);if(r!=null&&r.length==2){var s={x:0,y:0};if(n)s={x:n[0],y:n[1]};else if(e.pointOnPath){var o=this.loc,u=!1;if(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1)o=parseInt(this.loc,10),u=!0;s=e.pointOnPath(o,u)}else{var a=this.loc.constructor==Array?this.loc:this.endpointLoc;s={x:a[0]*e.w,y:a[1]*e.h}}var f=s.x-r[0]/2,l=s.y-r[1]/2;return{component:e,d:{minx:f,miny:l,td:r,cxy:s},minX:f,maxX:f+r[0],minY:l,maxY:l+r[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(s,[jsPlumb.DOMElementComponent,r],{getDimensions:function(){return jsPlumb.getSize(this.getElement())},setVisible:function(e){this._jsPlumb.div.style.display=e?"block":"none"},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){this._jsPlumb.div!=null&&this._jsPlumb.instance.removeElement(this._jsPlumb.div)},computeMaxSize:function(){var e=i(this);return Math.max(e[0],e[1])},reattachListeners:function(e){this._jsPlumb.div&&this.reattachListenersForElement(this._jsPlumb.div,this,e)},paint:function(e,t){this._jsPlumb.initialised||(this.getElement(),e.component.appendDisplayElement(this._jsPlumb.div),this.attachListeners(this._jsPlumb.div,e.component),this._jsPlumb.initialised=!0),this._jsPlumb.div.style.left=e.component.x+e.d.minx+"px",this._jsPlumb.div.style.top=e.component.y+e.d.miny+"px"}}),jsPlumb.Overlays.Custom=function(e){this.type="Custom",s.apply(this,arguments)},jsPlumbUtil.extend(jsPlumb.Overlays.Custom,s),jsPlumb.Overlays.GuideLines=function(){var e=this;e.length=50,e.lineWidth=5,this.type="GuideLines",r.apply(this,arguments),jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.draw=function(t,n){var r=t.pointAlongPathFrom(e.loc,e.length/2),i=t.pointOnPath(e.loc),s=Biltong.pointOnLine(r,i,e.length),o=Biltong.perpendicularLineTo(r,s,40),u=Biltong.perpendicularLineTo(s,r,20);return{connector:t,head:r,tail:s,headLine:u,tailLine:o,minX:Math.min(r.x,s.x,u[0].x,u[1].x),minY:Math.min(r.y,s.y,u[0].y,u[1].y),maxX:Math.max(r.x,s.x,u[0].x,u[1].x),maxY:Math.max(r.y,s.y,u[0].y,u[1].y)}}},jsPlumb.Overlays.Label=function(e){this.labelStyle=e.labelStyle;var t=null,n=null,r=null,i=null;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var s=jsPlumb.extend({create:function(){return document.createElement("div")}},e);jsPlumb.Overlays.Custom.call(this,s),this.type="Label",this.label=e.label||"",this.labelText=null;if(this.labelStyle){var o=this.getElement();this.labelStyle.font=this.labelStyle.font||"12px sans-serif",o.style.font=this.labelStyle.font,o.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(o.style.background=this.labelStyle.fillStyle);if(this.labelStyle.borderWidth>0){var u=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";o.style.border=this.labelStyle.borderWidth+"px solid "+u}this.labelStyle.padding&&(o.style.padding=this.labelStyle.padding)}},jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(e){this.label=e,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),s.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var e=this.label(this);this.getElement().innerHTML=e.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))}})}(),function(){var e=function(e){this.type="Flowchart",e=e||{},e.stub=e.stub==null?30:e.stub;var t=this,n=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),r=e.midpoint==null?.5:e.midpoint,i=[],s=[],o=e.grid,u=e.alwaysRespectStubs,a=null,f=null,l=null,c,h=e.cornerRadius!=null?e.cornerRadius:0,p=function(e){return e<0?-1:e===0?0:1},d=function(e,t,n,r){if(f==t&&l==n)return;var i=f==null?r.sx:f,s=l==null?r.sy:l,o=i==t?"v":"h",u=p(t-i),a=p(n-s);f=t,l=n,e.push([i,s,t,n,o,u,a])},v=function(e){return Math.sqrt(Math.pow(e[0]-e[2],2)+Math.pow(e[1]-e[3],2))},m=function(e){var t=[];return t.push.apply(t,e),t},g=function(e){t.bounds.minX=Math.min(t.bounds.minX,e[2]),t.bounds.maxX=Math.max(t.bounds.maxX,e[2]),t.bounds.minY=Math.min(t.bounds.minY,e[3]),t.bounds.maxY=Math.max(t.bounds.maxY,e[3])},y=function(e,t,r){var i,s;for(var o=0;o<t.length-1;o++){i=i||m(t[o]),s=m(t[o+1]);if(h>0&&i[4]!=s[4]){var u=Math.min(h,v(i),v(s));i[2]-=i[5]*u,i[3]-=i[6]*u,s[0]+=s[5]*u,s[1]+=s[6]*u;var a=i[6]==s[5]&&s[5]==1||i[6]==s[5]&&s[5]===0&&i[5]!=s[6]||i[6]==s[5]&&s[5]==-1,f=s[1]>i[3]?1:-1,l=s[0]>i[2]?1:-1,c=f==l,p=c&&a||!c&&!a?s[0]:i[2],d=c&&a||!c&&!a?i[3]:s[1];n.addSegment(e,"Straight",{x1:i[0],y1:i[1],x2:i[2],y2:i[3]}),n.addSegment(e,"Arc",{r:u,x1:i[2],y1:i[3],x2:s[0],y2:s[1],cx:p,cy:d,ac:a})}else{var g=i[2]==i[0]?0:i[2]>i[0]?r.lw/2:-(r.lw/2),y=i[3]==i[1]?0:i[3]>i[1]?r.lw/2:-(r.lw/2);n.addSegment(e,"Straight",{x1:i[0]-g,y1:i[1]-y,x2:i[2]+g,y2:i[3]+y})}i=s}s!=null&&n.addSegment(e,"Straight",{x1:s[0],y1:s[1],x2:s[2],y2:s[3]})};this.setSegments=function(e){a=e},this.isEditable=function(){return!0},this.getOriginalSegments=function(){return a||s},this._compute=function(e,t){t.clearEdits&&(a=null);if(a!=null){y(this,a,e);return}s=[],f=null,l=null,c=null;var i=e.startStubX+(e.endStubX-e.startStubX)*r,o=e.startStubY+(e.endStubY-e.startStubY)*r,h=function(e,t,r,i){return e+(t*(1-r)*i+n.maxStub)},p={x:[0,1],y:[1,0]},v=function(t){return[e.startStubX,e.startStubY,e.endStubX,e.endStubY]},m={perpendicular:v,orthogonal:v,opposite:function(t){var n=e,r=t=="x"?0:1,i={x:function(){return n.so[r]==1&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||n.so[r]==-1&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return n.so[r]==1&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||n.so[r]==-1&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}};return!u&&i[t]()?{x:[(e.sx+e.tx)/2,e.startStubY,(e.sx+e.tx)/2,e.endStubY],y:[e.startStubX,(e.sy+e.ty)/2,e.endStubX,(e.sy+e.ty)/2]}[t]:[e.startStubX,e.startStubY,e.endStubX,e.endStubY]}},g={perpendicular:function(t,n,r,s,u){var a=e,f={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},l={x:[[a.startStubX,a.endStubX],null,[a.endStubX,a.startStubX]],y:[[a.startStubY,a.endStubY],null,[a.endStubY,a.startStubY]]},c={x:[[i,a.startStubY],[i,a.endStubY]],y:[[a.startStubX,o],[a.endStubX,o]]},h={x:[[a.endStubX,a.startStubY]],y:[[a.startStubX,a.endStubY]]},d={x:[[a.startStubX,a.endStubY],[a.endStubX,a.endStubY]],y:[[a.endStubX,a.startStubY],[a.endStubX,a.endStubY]]},v={x:[[a.startStubX,o],[a.endStubX,o],[a.endStubX,a.endStubY]],y:[[i,a.startStubY],[i,a.endStubY],[a.endStubX,a.endStubY]]},m={x:[a.startStubY,a.endStubY],y:[a.startStubX,a.endStubX]},g=p[t][0],y=p[t][1],b=a.so[g]+1,w=a.to[y]+1,E=a.to[y]==-1&&m[t][1]<m[t][0]||a.to[y]==1&&m[t][1]>m[t][0],S=l[t][b][0],x=l[t][b][1],T=f[t][b][w];if(a.segment==T[3]||a.segment==T[2]&&E)return c[t];if(a.segment==T[2]&&x<S)return h[t];if(a.segment==T[2]&&x>=S||a.segment==T[1]&&!E)return v[t];if(a.segment==T[0]||a.segment==T[1]&&E)return d[t]},orthogonal:function(t,n,r,i,s){var o=e,u={x:o.so[0]==-1?Math.min(n,i):Math.max(n,i),y:o.so[1]==-1?Math.min(n,i):Math.max(n,i)}[t];return{x:[[u,r],[u,s],[i,s]],y:[[r,u],[s,u],[s,i]]}[t]},opposite:function(r,s,u,a,f){var l=e,c={x:"y",y:"x"}[r],h={x:"height",y:"width"}[r],p=l["is"+r.toUpperCase()+"GreaterThanStubTimes2"];if(t.sourceEndpoint.elementId==t.targetEndpoint.elementId){var d=u+(1-t.sourceEndpoint.anchor[c])*t.sourceInfo[h]+n.maxStub;return{x:[[s,d],[a,d]],y:[[d,s],[d,a]]}[r]}if(!p||l.so[w]==1&&s>a||l.so[w]==-1&&s<a)return{x:[[s,o],[a,o]],y:[[i,s],[i,a]]}[r];if(l.so[w]==1&&s<a||l.so[w]==-1&&s>a)return{x:[[i,l.sy],[i,l.ty]],y:[[l.sx,o],[l.tx,o]]}[r]}},b=m[e.anchorOrientation](e.sourceAxis),w=e.sourceAxis=="x"?0:1,E=e.sourceAxis=="x"?1:0,S=b[w],x=b[E],T=b[w+2],N=b[E+2];d(s,b[0],b[1],e);var C=g[e.anchorOrientation](e.sourceAxis,S,x,T,N);if(C)for(var k=0;k<C.length;k++)d(s,C[k][0],C[k][1],e);d(s,b[2],b[3],e),d(s,e.tx,e.ty,e),y(this,s,e)},this.getPath=function(){var e=null,t=null,n=[],r=a||s;for(var i=0;i<r.length;i++){var o=r[i],u=o[4],f=u=="v"?3:2;if(e!=null&&t===u)e[f]=o[f];else if(o[0]!=o[2]||o[1]!=o[3])n.push({start:[o[0],o[1]],end:[o[2],o[3]]}),e=o,t=o[4]}return n},this.setPath=function(e){a=[];for(var t=0;t<e.length;t++){var n=e[t].start[0],r=e[t].start[1],i=e[t].end[0],s=e[t].end[1],o=n==i?"v":"h",u=p(i-n),f=p(s-r);a.push([n,r,i,s,o,u,f])}}};jsPlumbUtil.extend(e,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(e,"Flowchart")}(),function(){var e=function(e,t,n,r){this.m=(r-t)/(n-e),this.b=-1*(this.m*e-t),this.rectIntersect=function(e,t,n,r){var i=[],s,o;s=(t-this.b)/this.m,s>=e&&s<=e+n&&i.push([s,this.m*s+this.b]),o=this.m*(e+n)+this.b,o>=t&&o<=t+r&&i.push([(o-this.b)/this.m,o]),s=(t+r-this.b)/this.m,s>=e&&s<=e+n&&i.push([s,this.m*s+this.b]),o=this.m*e+this.b,o>=t&&o<=t+r&&i.push([(o-this.b)/this.m,o]);if(i.length==2){var u=(i[0][0]+i[1][0])/2,a=(i[0][1]+i[1][1])/2;i.push([u,a]);var f=u<=e+n/2?-1:1,l=a<=t+r/2?-1:1;return i.push([f,l]),i}return null}},t=function(e,t,n,r){return e<=n&&r<=t?1:e<=n&&t<=r?2:n<=e&&r>=t?3:4},n=function(e,t,n,r,i,s,o,u,a){if(u<=a)return[e,t];if(n===1)return r[3]<=0&&i[3]>=1?[e+(r[2]<.5?-1*s:s),t]:r[2]>=1&&i[2]<=0?[e,t+(r[3]<.5?-1*o:o)]:[e+ -1*s,t+ -1*o];if(n===2)return r[3]>=1&&i[3]<=0?[e+(r[2]<.5?-1*s:s),t]:r[2]>=1&&i[2]<=0?[e,t+(r[3]<.5?-1*o:o)]:[e+1*s,t+ -1*o];if(n===3)return r[3]>=1&&i[3]<=0?[e+(r[2]<.5?-1*s:s),t]:r[2]<=0&&i[2]>=1?[e,t+(r[3]<.5?-1*o:o)]:[e+ -1*s,t+ -1*o];if(n===4)return r[3]<=0&&i[3]>=1?[e+(r[2]<.5?-1*s:s),t]:r[2]<=0&&i[2]>=1?[e,t+(r[3]<.5?-1*o:o)]:[e+1*s,t+ -1*o]},r=function(e){e=e||{},this.type="StateMachine";var r=this,i=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),s=e.curviness||10,o=e.margin||5,u=e.proximityLimit||80,a=e.orientation&&e.orientation==="clockwise",f=e.loopbackRadius||25,l=e.showLoopback!==!1;this._compute=function(e,r){var c=Math.abs(r.sourcePos[0]-r.targetPos[0]),h=Math.abs(r.sourcePos[1]-r.targetPos[1]),p=Math.min(r.sourcePos[0],r.targetPos[0]),d=Math.min(r.sourcePos[1],r.targetPos[1]);if(!l||r.sourceEndpoint.elementId!==r.targetEndpoint.elementId){var v=r.sourcePos[0]<r.targetPos[0]?0:c,m=r.sourcePos[1]<r.targetPos[1]?0:h,g=r.sourcePos[0]<r.targetPos[0]?c:0,y=r.sourcePos[1]<r.targetPos[1]?h:0;r.sourcePos[2]===0&&(v-=o),r.sourcePos[2]===1&&(v+=o),r.sourcePos[3]===0&&(m-=o),r.sourcePos[3]===1&&(m+=o),r.targetPos[2]===0&&(g-=o),r.targetPos[2]===1&&(g+=o),r.targetPos[3]===0&&(y-=o),r.targetPos[3]===1&&(y+=o);var b=(v+g)/2,w=(m+y)/2,E=-1*b/w,S=Math.atan(E),x=E==Infinity||E==-Infinity?0:Math.abs(s/2*Math.sin(S)),T=E==Infinity||E==-Infinity?0:Math.abs(s/2*Math.cos(S)),N=t(v,m,g,y),C=Math.sqrt(Math.pow(g-v,2)+Math.pow(y-m,2)),k=n(b,w,N,r.sourcePos,r.targetPos,s,s,C,u);i.addSegment(this,"Bezier",{x1:g,y1:y,x2:v,y2:m,cp1x:k[0],cp1y:k[1],cp2x:k[0],cp2y:k[1]})}else{var L=r.sourcePos[0],A=r.sourcePos[0],O=r.sourcePos[1]-o,M=r.sourcePos[1]-o,_=L,D=O-f,P=2*f,H=2*f,B=_-f,j=D-f;e.points[0]=B,e.points[1]=j,e.points[2]=P,e.points[3]=H,i.addSegment(this,"Arc",{loopback:!0,x1:L-B+4,y1:O-j,startAngle:0,endAngle:2*Math.PI,r:f,ac:!a,x2:L-B-4,y2:O-j,cx:_-B,cy:D-j})}}};jsPlumb.registerConnectorType(r,"StateMachine")}(),function(){var e=function(e){e=e||{};var t=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),n=e.stub||50,r=e.curviness||150,i=10;this.type="Bezier",this.getCurviness=function(){return r},this._findControlPoint=function(e,t,n,s,o){var u=s.anchor.getOrientation(s),a=o.anchor.getOrientation(o),f=u[0]!=a[0]||u[1]==a[1],l=[];return f?(a[0]===0?l.push(n[0]<t[0]?e[0]+i:e[0]-i):l.push(e[0]+r*a[0]),a[1]===0?l.push(n[1]<t[1]?e[1]+i:e[1]-i):l.push(e[1]+r*u[1])):(u[0]===0?l.push(t[0]<n[0]?e[0]+i:e[0]-i):l.push(e[0]-r*u[0]),u[1]===0?l.push(t[1]<n[1]?e[1]+i:e[1]-i):l.push(e[1]+r*a[1])),l},this._compute=function(e,n){var r=n.sourcePos,i=n.targetPos,s=Math.abs(r[0]-i[0]),o=Math.abs(r[1]-i[1]),u=r[0]<i[0]?s:0,a=r[1]<i[1]?o:0,f=r[0]<i[0]?0:s,l=r[1]<i[1]?0:o,c=this._findControlPoint([u,a],r,i,n.sourceEndpoint,n.targetEndpoint),h=this._findControlPoint([f,l],i,r,n.targetEndpoint,n.sourceEndpoint);t.addSegment(this,"Bezier",{x1:u,y1:a,x2:f,y2:l,cp1x:c[0],cp1y:c[1],cp2x:h[0],cp2y:h[1]})}};jsPlumbUtil.extend(e,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(e,"Bezier")}(),function(){var e={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},t="stroke-dasharray",n="dashstyle",r="linearGradient",i="radialGradient",s="defs",o="fill",u="stop",a="stroke",f="stroke-width",l="style",c="none",h="jsplumb_gradient_",p="lineWidth",d={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},v=function(e,t){for(var n in t)e.setAttribute(n,""+t[n])},m=function(e,t){var n=document.createElementNS(d.svg,e);return t=t||{},t.version="1.1",t.xmlns=d.xhtml,v(n,t),n},g=function(e){return"position:absolute;left:"+e[0]+"px;top:"+e[1]+"px"},y=function(e){for(var t=0;t<e.childNodes.length;t++)(e.childNodes[t].tagName==s||e.childNodes[t].tagName==r||e.childNodes[t].tagName==i)&&e.removeChild(e.childNodes[t])},b=function(e,t,n,f,l){var c=h+l._jsPlumb.instance.idstamp();y(e);var p;n.gradient.offset?p=m(i,{id:c}):p=m(r,{id:c,gradientUnits:"userSpaceOnUse"});var d=m(s);e.appendChild(d),d.appendChild(p);for(var v=0;v<n.gradient.stops.length;v++){var g=l.segment==1||l.segment==2?v:n.gradient.stops.length-1-v,b=jsPlumbUtil.convertStyle(n.gradient.stops[g][1],!0),w=m(u,{offset:Math.floor(n.gradient.stops[v][0]*100)+"%","stop-color":b});p.appendChild(w)}var E=n.strokeStyle?a:o;t.setAttribute(E,"url(#"+c+")")},w=function(r,i,s,u,h){i.setAttribute(o,s.fillStyle?jsPlumbUtil.convertStyle(s.fillStyle,!0):c),i.setAttribute(a,s.strokeStyle?jsPlumbUtil.convertStyle(s.strokeStyle,!0):c),s.gradient?b(r,i,s,u,h):(y(r),i.setAttribute(l,"")),s.lineWidth&&i.setAttribute(f,s.lineWidth);if(s[n]&&s[p]&&!s[t]){var d=s[n].indexOf(",")==-1?" ":",",v=s[n].split(d),m="";v.forEach(function(e){m+=Math.floor(e*s.lineWidth)+d}),i.setAttribute(t,m)}else s[t]&&i.setAttribute(t,s[t]);for(var g in e)s[g]&&i.setAttribute(e[g],s[g])},E=function(e){var t=/([0-9].)(p[xt])\s(.*)/,n=e.match(t);return{size:n[1]+n[2],font:n[3]}},S=function(e,t,n){e.childNodes.length>n?e.insertBefore(t,e.childNodes[n]):e.appendChild(t)};jsPlumbUtil.svg={node:m,attr:v,pos:g};var x=function(e){var t=e.pointerEventsSpec||"all",n={};jsPlumb.jsPlumbUIComponent.apply(this,e.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var r=e.cssClass+" "+(e.originalArgs[0].cssClass||""),i={style:"",width:0,height:0,"pointer-events":t,position:"absolute"};this.svg=m("svg",i),e.useDivWrapper?(this.canvas=document.createElement("div"),this.canvas.style.position="absolute",jsPlumbUtil.sizeElement(this.canvas,0,0,1,1),this.canvas.className=r):(v(this.svg,{"class":r}),this.canvas=this.svg),e._jsPlumb.appendElement(this.canvas,e.originalArgs[0].parent),e.useDivWrapper&&this.canvas.appendChild(this.svg);var s=[this.canvas];return this.getDisplayElements=function(){return s},this.appendDisplayElement=function(e){s.push(e)},this.paint=function(t,r,i){if(t!=null){var s=[this.x,this.y],o=[this.w,this.h],u;i!=null&&(i.xmin<0&&(s[0]+=i.xmin),i.ymin<0&&(s[1]+=i.ymin),o[0]=i.xmax+(i.xmin<0?-i.xmin:0),o[1]=i.ymax+(i.ymin<0?-i.ymin:0)),e.useDivWrapper?(jsPlumbUtil.sizeElement(this.canvas,s[0],s[1],o[0],o[1]),s[0]=0,s[1]=0,u=g([0,0])):u=g([s[0],s[1]]),n.paint.apply(this,arguments),v(this.svg,{style:u,width:o[0],height:o[1]})}},{renderer:n}};jsPlumbUtil.extend(x,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.bgCanvas=null,this.path=null,this.group=null},setVisible:function(e){this.canvas&&(this.canvas.style.display=e?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=e?"block":"none")}});var T=jsPlumb.ConnectorRenderers.svg=function(e){var t=this,n=x.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]);n.renderer.paint=function(n,r,i){var s=t.getSegments(),o="",u=[0,0];i.xmin<0&&(u[0]=-i.xmin),i.ymin<0&&(u[1]=-i.ymin);if(s.length>0){for(var a=0;a<s.length;a++)o+=jsPlumb.Segments.svg.SegmentRenderer.getPath(s[a]),o+=" ";var f={d:o,transform:"translate("+u[0]+","+u[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},l=null,c=[t.x,t.y,t.w,t.h],h={mouseenter:function(e){var n=e.relatedTarget;return n==null||n!=t.path&&n!=t.bgPath},mouseout:function(e){var n=e.relatedTarget;return n==null||n!=t.path&&n!=t.bgPath}};if(n.outlineColor){var p=n.outlineWidth||1,d=n.lineWidth+2*p;l=jsPlumb.extend({},n),l.strokeStyle=jsPlumbUtil.convertStyle(n.outlineColor),l.lineWidth=d,t.bgPath==null?(t.bgPath=m("path",f),S(t.svg,t.bgPath,0),t.attachListeners(t.bgPath,t,h)):v(t.bgPath,f),w(t.svg,t.bgPath,l,c,t)}t.path==null?(t.path=m("path",f),S(t.svg,t.path,n.outlineColor?1:0),t.attachListeners(t.path,t,h)):v(t.path,f),w(t.svg,t.path,n,c,t)}},this.reattachListeners=function(){this.bgPath&&this.reattachListenersForElement(this.bgPath,this),this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,x),jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(e){return{Straight:function(){var t=e.getCoordinates();return"M "+t.x1+" "+t.y1+" L "+t.x2+" "+t.y2},Bezier:function(){var t=e.params;return"M "+t.x1+" "+t.y1+" C "+t.cp1x+" "+t.cp1y+" "+t.cp2x+" "+t.cp2y+" "+t.x2+" "+t.y2},Arc:function(){var t=e.params,n=e.sweep>Math.PI?1:0,r=e.anticlockwise?0:1;return"M"+e.x1+" "+e.y1+" A "+e.radius+" "+t.r+" 0 "+n+","+r+" "+e.x2+" "+e.y2}}[e.type]()}}};var N=window.SvgEndpoint=function(e){var t=x.apply(this,[{cssClass:e._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:e._jsPlumb}]);t.renderer.paint=function(e){var t=jsPlumb.extend({},e);t.outlineColor&&(t.strokeWidth=t.outlineWidth,t.strokeStyle=jsPlumbUtil.convertStyle(t.outlineColor,!0)),this.node==null?(this.node=this.makeNode(t),this.svg.appendChild(this.node),this.attachListeners(this.node,this)):this.updateNode!=null&&this.updateNode(this.node),w(this.svg,this.node,t,[this.x,this.y,this.w,this.h],this),g(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(N,x,{reattachListeners:function(){this.node&&this.reattachListenersForElement(this.node,this)}}),jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),N.apply(this,arguments),this.makeNode=function(e){return m("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(e){v(e,{cx:this.w/2,cy:this.h/2,r:this.radius})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,N]),jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),N.apply(this,arguments),this.makeNode=function(e){return m("rect",{width:this.w,height:this.h})},this.updateNode=function(e){v(e,{width:this.w,height:this.h})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,N]),jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var C=function(e,t){e.apply(this,t),jsPlumb.jsPlumbUIComponent.apply(this,t),this.isAppendedAtTopLevel=!1;var n=this;this.path=null,this.paint=function(e,n){if(e.component.svg&&n){this.path==null&&(this.path=m("path",{"pointer-events":"all"}),e.component.svg.appendChild(this.path),this.canvas=e.component.svg,this.attachListeners(this.path,e.component),this.attachListeners(this.path,this));var i=t&&t.length==1?t[0].cssClass||"":"",s=[0,0];n.xmin<0&&(s[0]=-n.xmin),n.ymin<0&&(s[1]=-n.ymin),v(this.path,{d:r(e.d),"class":i,stroke:e.strokeStyle?e.strokeStyle:null,fill:e.fillStyle?e.fillStyle:null,transform:"translate("+s[0]+","+s[1]+")"})}};var r=function(e){return"M"+e.hxy.x+","+e.hxy.y+" L"+e.tail[0].x+","+e.tail[0].y+" L"+e.cxy.x+","+e.cxy.y+" L"+e.tail[1].x+","+e.tail[1].y+" L"+e.hxy.x+","+e.hxy.y};this.reattachListeners=function(){this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(C,[jsPlumb.jsPlumbUIComponent,jsPlumb.Overlays.AbstractOverlay],{cleanup:function(){this.path!=null&&this._jsPlumb.instance.removeElement(this.path)},setVisible:function(e){this.path!=null&&(this.path.style.display=e?"block":"none")}}),jsPlumb.Overlays.svg.Arrow=function(){C.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,C]),jsPlumb.Overlays.svg.PlainArrow=function(){C.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,C]),jsPlumb.Overlays.svg.Diamond=function(){C.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,C]),jsPlumb.Overlays.svg.GuideLines=function(){var e=null,t=this,n,r;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(s,o){e==null&&(e=m("path"),s.connector.svg.appendChild(e),t.attachListeners(e,s.connector),t.attachListeners(e,t),n=m("path"),s.connector.svg.appendChild(n),t.attachListeners(n,s.connector),t.attachListeners(n,t),r=m("path"),s.connector.svg.appendChild(r),t.attachListeners(r,s.connector),t.attachListeners(r,t));var u=[0,0];o.xmin<0&&(u[0]=-o.xmin),o.ymin<0&&(u[1]=-o.ymin),v(e,{d:i(s.head,s.tail),stroke:"red",fill:null,transform:"translate("+u[0]+","+u[1]+")"}),v(n,{d:i(s.tailLine[0],s.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+u[0]+","+u[1]+")"}),v(r,{d:i(s.headLine[0],s.headLine[1]),stroke:"green",fill:null,transform:"translate("+u[0]+","+u[1]+")"})};var i=function(e,t){return"M "+e.x+","+e.y+" L"+t.x+","+t.y}},jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)}(),function(){var e={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},t=null;if(document.createStyleSheet&&document.namespaces){var n=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],r="behavior:url(#default#VML);position:absolute;";t=document.createStyleSheet();for(var i=0;i<n.length;i++)t.addRule(n[i],r);document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var s=1e3,o=function(e,t){for(var n in t)e[n]=t[n]},u=function(e,t,n,r,i,s){n=n||{};var u=document.createElement("jsplumb:"+e);return s?i.appendElement(u,r):r.appendChild(u),u.className=(n["class"]?n["class"]+" ":"")+"jsplumb_vml",a(u,t),o(u,n),u},a=function(e,t,n){e.style.left=t[0]+"px",e.style.top=t[1]+"px",e.style.width=t[2]+"px",e.style.height=t[3]+"px",e.style.position="absolute",n&&(e.style.zIndex=n)},f=jsPlumb.vml.convertValue=function(e){return Math.floor(e*s)},l=function(e,t,n,r){"transparent"===t?r.setOpacity(n,"0.0"):r.setOpacity(n,"1.0")},c=function(e,t,n,r){var i={};if(t.strokeStyle){i.stroked="true";var s=jsPlumbUtil.convertStyle(t.strokeStyle,!0);i.strokecolor=s,l(i,s,"stroke",n),i.strokeweight=t.lineWidth+"px"}else i.stroked="false";if(t.fillStyle){i.filled="true";var a=jsPlumbUtil.convertStyle(t.fillStyle,!0);i.fillcolor=a,l(i,a,"fill",n)}else i.filled="false";if(t.dashstyle)n.strokeNode==null?n.strokeNode=u("stroke",[0,0,0,0],{dashstyle:t.dashstyle},e,r):n.strokeNode.dashstyle=t.dashstyle;else if(t["stroke-dasharray"]&&t.lineWidth){var f=t["stroke-dasharray"].indexOf(",")==-1?" ":",",c=t["stroke-dasharray"].split(f),h="";for(var p=0;p<c.length;p++)h+=Math.floor(c[p]/t.lineWidth)+f;n.strokeNode==null?n.strokeNode=u("stroke",[0,0,0,0],{dashstyle:h},e,r):n.strokeNode.dashstyle=h}o(e,i)},h=function(){var e=this,t={};jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(t){e.opacityNodes.stroke=u("stroke",[0,0,1,1],{opacity:"0.0"},t,e._jsPlumb.instance),e.opacityNodes.fill=u("fill",[0,0,1,1],{opacity:"0.0"},t,e._jsPlumb.instance)},this.setOpacity=function(t,n){var r=e.opacityNodes[t];r&&(r.opacity=""+n)};var n=[];this.getDisplayElements=function(){return n},this.appendDisplayElement=function(t,r){r||e.canvas.parentNode.appendChild(t),n.push(t)}};jsPlumbUtil.extend(h,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&this.bgCanvas.parentNode.removeChild(this.bgCanvas),this.canvas&&this.canvas.parentNode.removeChild(this.canvas)}});var p=jsPlumb.ConnectorRenderers.vml=function(t){this.strokeNode=null,this.canvas=null,h.apply(this,arguments);var n=this._jsPlumb.instance.connectorClass+(t.cssClass?" "+t.cssClass:"");this.paint=function(r){if(r!==null){this.w=Math.max(this.w,1),this.h=Math.max(this.h,1);var i=this.getSegments(),f={path:""},l=[this.x,this.y,this.w,this.h];for(var h=0;h<i.length;h++)f.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(i[h]),f.path+=" ";if(r.outlineColor){var p=r.outlineWidth||1,d=r.lineWidth+2*p,v={strokeStyle:jsPlumbUtil.convertStyle(r.outlineColor),lineWidth:d};for(var m in e)v[m]=r[m];this.bgCanvas==null?(f["class"]=n,f.coordsize=l[2]*s+","+l[3]*s,this.bgCanvas=u("shape",l,f,t.parent,this._jsPlumb.instance,!0),a(this.bgCanvas,l),this.appendDisplayElement(this.bgCanvas,!0),this.attachListeners(this.bgCanvas,this),this.initOpacityNodes(this.bgCanvas,["stroke"])):(f.coordsize=l[2]*s+","+l[3]*s,a(this.bgCanvas,l),o(this.bgCanvas,f)),c(this.bgCanvas,v,this)}this.canvas==null?(f["class"]=n,f.coordsize=l[2]*s+","+l[3]*s,this.canvas=u("shape",l,f,t.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.attachListeners(this.canvas,this),this.initOpacityNodes(this.canvas,["stroke"])):(f.coordsize=l[2]*s+","+l[3]*s,a(this.canvas,l),o(this.canvas,f)),c(this.canvas,r,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(p,h,{reattachListeners:function(){this.canvas&&this.reattachListenersForElement(this.canvas,this)},setVisible:function(e){this.canvas&&(this.canvas.style.display=e?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=e?"block":"none")}});var d=window.VmlEndpoint=function(e){h.apply(this,arguments),this._jsPlumb.vml=null,this.canvas=document.createElement("div"),this.canvas.style.position="absolute",this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(e.cssClass?" "+e.cssClass:""),e._jsPlumb.appendElement(this.canvas,e.parent),this.paint=function(e,t){var n={},r=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),this._jsPlumb.vml==null?(n["class"]=this._jsPlumb.clazz,r=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],n,t,this.canvas,this._jsPlumb.instance),this.attachListeners(r,this),this.appendDisplayElement(r,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(r,["fill"])):(a(r,[0,0,this.w,this.h]),o(r,n)),c(r,e,this)}};jsPlumbUtil.extend(d,h,{reattachListeners:function(){this._jsPlumb.vml&&this.reattachListenersForElement(this._jsPlumb.vml,this)}}),jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(e){return{Straight:function(e){var t=e.params;return"m"+f(t.x1)+","+f(t.y1)+" l"+f(t.x2)+","+f(t.y2)+" e"},Bezier:function(e){var t=e.params;return"m"+f(t.x1)+","+f(t.y1)+" c"+f(t.cp1x)+","+f(t.cp1y)+","+f(t.cp2x)+","+f(t.cp2y)+","+f(t.x2)+","+f(t.y2)+" e"},Arc:function(e){var t=e.params,n=Math.min(t.x1,t.x2),r=Math.max(t.x1,t.x2),i=Math.min(t.y1,t.y2),s=Math.max(t.y1,t.y2),o=e.anticlockwise?1:0,u=e.anticlockwise?"at ":"wa ",a=function(){if(t.loopback)return"0,0,"+f(2*t.r)+","+f(2*t.r);var r=[null,[function(){return[n,i]},function(){return[n-t.r,i-t.r]}],[function(){return[n-t.r,i]},function(){return[n,i-t.r]}],[function(){return[n-t.r,i-t.r]},function(){return[n,i]}],[function(){return[n,i-t.r]},function(){return[n-t.r,i]}]][e.segment][o]();return f(r[0])+","+f(r[1])+","+f(r[0]+2*t.r)+","+f(r[1]+2*t.r)};return u+" "+a()+","+f(t.x1)+","+f(t.y1)+","+f(t.x2)+","+f(t.y2)+" e"}}[e.type](e)}}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),d.apply(this,arguments),this.getVml=function(e,t,n,r,i){return u("oval",e,t,r,i)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,d),jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),d.apply(this,arguments),this.getVml=function(e,t,n,r,i){return u("rect",e,t,r,i)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,d),jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var v=function(e,t){e.apply(this,t),h.apply(this,t);var n=this,r=null;this.canvas=null,this.isAppendedAtTopLevel=!0;var i=function(e){return"m "+f(e.hxy.x)+","+f(e.hxy.y)+" l "+f(e.tail[0].x)+","+f(e.tail[0].y)+" "+f(e.cxy.x)+","+f(e.cxy.y)+" "+f(e.tail[1].x)+","+f(e.tail[1].y)+" x e"};this.paint=function(e,r){if(e.component.canvas&&r){var f={},l=e.d,c=e.component;e.strokeStyle&&(f.stroked="true",f.strokecolor=jsPlumbUtil.convertStyle(e.strokeStyle,!0)),e.lineWidth&&(f.strokeweight=e.lineWidth+"px"),e.fillStyle&&(f.filled="true",f.fillcolor=e.fillStyle);var h=Math.min(l.hxy.x,l.tail[0].x,l.tail[1].x,l.cxy.x),p=Math.min(l.hxy.y,l.tail[0].y,l.tail[1].y,l.cxy.y),d=Math.max(l.hxy.x,l.tail[0].x,l.tail[1].x,l.cxy.x),v=Math.max(l.hxy.y,l.tail[0].y,l.tail[1].y,l.cxy.y),m=Math.abs(d-h),g=Math.abs(v-p),y=[h,p,m,g];f.path=i(l),f.coordsize=c.w*s+","+c.h*s,y[0]=c.x,y[1]=c.y,y[2]=c.w,y[3]=c.h;if(n.canvas==null){var b=c._jsPlumb.overlayClass||"",w=t&&t.length==1?t[0].cssClass||"":"";f["class"]=w+" "+b,n.canvas=u("shape",y,f,c.canvas.parentNode,c._jsPlumb.instance,!0),c.appendDisplayElement(n.canvas,!0),n.attachListeners(n.canvas,c),n.attachListeners(n.canvas,n)}else a(n.canvas,y),o(n.canvas,f)}},this.reattachListeners=function(){this.canvas&&this.reattachListenersForElement(n.canvas,this)},this.cleanup=function(){this.canvas!=null&&this._jsPlumb.instance.removeElement(this.canvas)}};jsPlumbUtil.extend(v,[h,jsPlumb.Overlays.AbstractOverlay],{setVisible:function(e){this.canvas.style.display=e?"block":"none"}}),jsPlumb.Overlays.vml.Arrow=function(){v.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,v]),jsPlumb.Overlays.vml.PlainArrow=function(){v.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,v]),jsPlumb.Overlays.vml.Diamond=function(){v.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,v])}(),function(){var e=function(e,n){var r=e[n?"_internalKatavorio":"_katavorio"],i=t(e);return r||(r=new Katavorio({bind:i.on,unbind:i.off,getSize:jsPlumb.getSize,getPosition:function(t){var n=jsPlumbAdapter.getOffset(t,e);return[n.left,n.top]},setPosition:function(e,t){e.style.left=t[0]+"px",e.style.top=t[1]+"px"},addClass:jsPlumbAdapter.addClass,removeClass:jsPlumbAdapter.removeClass,intersects:Biltong.intersects,indexOf:jsPlumbUtil.indexOf,css:{noSelect:e.dragSelectClass,droppable:"jsplumb-droppable",draggable:"jsplumb-draggable",drag:"jsplumb-drag",selected:"jsplumb-drag-selected",active:"jsplumb-drag-active",hover:"jsplumb-drag-hover"}}),e[n?"_internalKatavorio":"_katavorio"]=r,e.bind("zoom",r.setZoom)),r},t=function(e){var t=e._mottle;return t||(t=e._mottle=new Mottle),t},n=function(e,t){var n=function(n){if(t[n]){if(jsPlumbUtil.isString(t[n])){var r=t[n].match(/-=/)?-1:1,i=t[n].substring(2);return e[n]+r*i}return t[n]}return e[n]};return[n("left"),n("top")]};jsPlumb.extend(jsPlumbInstance.prototype,{getDOMElement:function(e){return e==null?null:(e=typeof e=="string"?e:e.length!=null?e[0]:e,typeof e=="string"?document.getElementById(e):e)},getElementObject:function(e){return e},removeElement:function(n){e(this).elementRemoved(n),t(this).remove(n)},doAnimate:function(e,t,r){r=r||{};var i=jsPlumbAdapter.getOffset(e,this),s=n(i,t),o=s[0]-i.left,u=s[1]-i.top,a=r.duration||250,f=15,l=a/f,c=f/a*o,h=f/a*u,p=0,d=setInterval(function(){jsPlumbAdapter.setPosition(e,{left:i.left+c*(p+1),top:i.top+h*(p+1)}),r.step!=null&&r.step(),p++,p>=l&&(window.clearInterval(d),r.complete!=null&&r.complete())},f)},getSelector:function(e,t){var n=null;return arguments.length==1?n=e.nodeType!=null?e:document.querySelectorAll(e):n=e.querySelectorAll(t),n},destroyDraggable:function(t){e(this).destroyDraggable(t)},destroyDroppable:function(t){e(this).destroyDroppable(t)},initDraggable:function(t,n,r){e(this,r).draggable(t,n)},initDroppable:function(t,n,r){e(this,r).droppable(t,n)},isAlreadyDraggable:function(e){return e._katavorioDrag!=null},isDragSupported:function(e,t){return!0},isDropSupported:function(e,t){return!0},getDragObject:function(e){return e[0].drag.getDragElement()},getDragScope:function(e){return e._katavorioDrag&&e._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(e){return e[0].e},getDropScope:function(e){return e._katavorioDrop&&e._katavorioDrop.scopes.join(" ")||""},getUIPosition:function(e,t){return{left:e[0].pos[0],top:e[0].pos[1]}},isDragFilterSupported:function(){return!0},setDragFilter:function(e,t){e._katavorioDrag&&e._katavorioDrag.setFilter(t)},setElementDraggable:function(e,t){e=jsPlumb.getDOMElement(e),e._katavorioDrag&&e._katavorioDrag.setEnabled(t)},setDragScope:function(e,t){e._katavorioDrag&&e._katavorioDrag.k.setDragScope(e,t)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},animEvents:{step:"step",complete:"complete"},stopDrag:function(e){e._katavorioDrag&&e._katavorioDrag.abort()},addToDragSelection:function(t){e(this).select(t)},removeFromDragSelection:function(t){e(this).deselect(t)},clearDragSelection:function(){e(this).deselectAll()},trigger:function(e,n,r){t(this).trigger(e,n,r)},getOriginalEvent:function(e){return e},on:function(e,n,r){t(this).on.apply(this,arguments)},off:function(e,n,r){t(this).off.apply(this,arguments)}});var r=function(e){var t=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body!="1.6.2"&&document.body!=null?e():setTimeout(t,9)};t()};r(jsPlumb.init)}.call(this),jsPlumb}),define("App",["happy/app/BaseApp","happy/utils/Network","Tree","jsPlumb"],function(e,t,n,r){var i=new t,s=function(){var e=this,t,r;e.setup=function(){var i=e.container.dataset.indexPath||"nodes/index.json";r=new n,r.nodeAdded.add(function(e){console.log("nodeAdded",e)}),r.nodeRemoved.add(function(e){console.log("nodeRemoved",e)}),r.connectionAdded.add(function(e){console.log("connectionAdded",e)}),r.connectionRemoved.add(function(e){console.log("connectionRemoved",e)}),global=r,e.container.classList.add("loading"),s(i).then(function(n){e.container.classList.remove("loading"),t=n}).catch(function(t){e.container.classList.remove("loading"),a(t)})};var s=function(e){var t;return new Promise(function(n,r){u(e).then(function(e){return t=e,o(e)}).then(function(){n(t)}).catch(function(e){r(e)})})},o=function(e){var t=[];for(var n in e)(function(n){var r=new Promise(function(t,r){u(e[n]).then(function(r){e[n]=r,t(r)}).catch(function(e){r(e)})});t.push(r)})(n);return Promise.all(t)},u=function(e){return new Promise(function(t,n){i.ajax({url:e,onSuccess:function(e){t(JSON.parse(e.responseText))},onError:n})})},a=function(e){e.stack?console.error(e.stack):console.error(e)};e.onReposition=function(e,t){},e.onResize=function(e,t){},e.update=function(e,t){}};return s.prototype=new e,s}),define("happy/utils/DOM",[],function(){var e=function(){var e=this,t=function(e,t){return typeof e.classList=="undefined"?e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)")):e.classList.contains(t)},n=function(e,t){typeof e.classList=="undefined"?this.hasClass(e,t)||(e.className+=" "+t):e.classList.add(t)},r=function(e,n){if(typeof e.classList=="undefined"){if(t(e,n)){var r=new RegExp("(\\s|^)"+n+"(\\s|$)");e.className=e.className.replace(r," ")}}else e.classList.remove(n)},i=function(e){while(e.lastChild)e.removeChild(e.lastChild)},s=function(e){var t=e.offsetWidth,n=e.offsetHeight;return{width:t,height:n}},o=function(e){var t=0,n=0;if(e&&e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return{x:t,y:n}};Object.defineProperty(e,"hasClass",{value:t}),Object.defineProperty(e,"addClass",{value:n}),Object.defineProperty(e,"removeClass",{value:r}),Object.defineProperty(e,"empty",{value:i}),Object.defineProperty(e,"measure",{value:s}),Object.defineProperty(e,"calculatePosition",{value:o})};return e}),define("happy/_libs/mout/object/hasOwn",[],function(){function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return e}),define("happy/_libs/mout/lang/kindOf",[],function(){function r(r){return r===null?"Null":r===n?"Undefined":e.exec(t.call(r))[1]}var e=/^\[object (.*)\]$/,t=Object.prototype.toString,n;return r}),define("happy/_libs/mout/lang/isPlainObject",[],function(){function e(e){return!!e&&typeof e=="object"&&e.constructor===Object}return e}),define("happy/_libs/mout/object/forIn",[],function(){function n(){t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],e=!0;for(var n in{toString:null})e=!1}function r(r,s,o){var u,a=0;e==null&&n();for(u in r)if(i(s,r,u,o)===!1)break;if(e)while(u=t[a++])if(r[u]!==Object.prototype[u]&&i(s,r,u,o)===!1)break}function i(e,t,n,r){return e.call(r,t[n],n,t)}var e,t;return r}),define("happy/_libs/mout/object/forOwn",["./hasOwn","./forIn"],function(e,t){function n(n,r,i){t(n,function(t,s){if(e(n,s))return r.call(i,n[s],s,n)})}return n}),define("happy/_libs/mout/object/mixIn",["./forOwn"],function(e){function t(t,r){var i=0,s=arguments.length,o;while(++i<s)o=arguments[i],o!=null&&e(o,n,t);return t}function n(e,t){this[t]=e}return t}),define("happy/_libs/mout/lang/clone",["./kindOf","./isPlainObject","../object/mixIn"],function(e,t,n){function r(t){switch(e(t)){case"Object":return i(t);case"Array":return u(t);case"RegExp":return s(t);case"Date":return o(t);default:return t}}function i(e){return t(e)?n({},e):e}function s(e){var t="";return t+=e.multiline?"m":"",t+=e.global?"g":"",t+=e.ignorecase?"i":"",new RegExp(e.source,t)}function o(e){return new Date(+e)}function u(e){return e.slice()}return r}),define("happy/_libs/mout/lang/deepClone",["./clone","../object/forOwn","./kindOf","./isPlainObject"],function(e,t,n,r){function i(t,r){switch(n(t)){case"Object":return s(t,r);case"Array":return o(t,r);default:return e(t)}}function s(e,n){if(r(e)){var s={};return t(e,function(e,t){this[t]=i(e,n)},s),s}return n?n(e):e}function o(e,t){var n=[],r=-1,s=e.length,o;while(++r<s)n[r]=i(e[r],t);return n}return i}),define("happy/_libs/mout/lang/isKind",["./kindOf"],function(e){function t(t,n){return e(t)===n}return t}),define("happy/_libs/mout/lang/isObject",["./isKind"],function(e){function t(t){return e(t,"Object")}return t}),define("happy/_libs/mout/object/merge",["./hasOwn","../lang/deepClone","../lang/isObject"],function(e,t,n){function r(){var i=1,s,o,u,a;a=t(arguments[0]);while(u=arguments[i++])for(s in u){if(!e(u,s))continue;o=u[s],n(o)&&n(a[s])?a[s]=r(a[s],o):a[s]=t(o)}return a}return r}),define("happy/app/Runner",["../utils/DOM","../utils/Vendor","../_libs/mout/object/merge"],function(e,t,n){var r=new t,i=new e,s=r.validateMethod("requestAnimationFrame"),o=r.validateConstructor("MutationObserver"),u=function(e){function A(){c(A);var t=N();l=t-a,a=t;var n=t-u;e.update.apply(e,[l,n]),e.draw.apply(e,[l,n])}var t=this,n=e.container,u,a,f,l,c;n.tabIndex="1",n.addEventListener("keyup",function(t){e.onKeyUp.apply(e,[t])},!1),n.addEventListener("keydown",function(t){e.onKeyDown.apply(e,[t])},!1),n.addEventListener("mouseover",function(t){e.onMouseOver.apply(e,[t])},!1),n.addEventListener("mouseout",function(t){e.onMouseOut.apply(e,[t])},!1),n.addEventListener("mousedown",function(t){e.onMouseDown.apply(e,[t])},!1),n.addEventListener("mouseup",function(t){e.onMouseUp.apply(e,[t])},!1),n.addEventListener("mousemove",function(t){e.onMouseMove.apply(e,[t])},!1),n.addEventListener("click",function(t){e.onClick.apply(e,[t])},!1),n.addEventListener("dblclick",function(t){e.onDoubleClick.apply(e,[t])},!1);var h=i.measure(n),p=i.calculatePosition(n),d=function(){var t=i.measure(n),r=i.calculatePosition(n);(t.width!=h.width||t.height!=h.height)&&e.onResize.apply(e,[t,r]),h=t,(r.x!=p.x||r.y!=p.y)&&e.onReposition.apply(e,[r,t]),p=r};window.addEventListener("resize",d,!1),window.addEventListener("scroll",d,!1);if(o){var v=new o(d);v.observe(document.body,{subtree:!0,childList:!0,characterData:!0,attribute:!0})}var m=function(){r.validateMethod("cancelFullScreen",document).apply(document)},g=function(){r.validateMethod("requestFullScreen",n).apply(n,[Element.ALLOW_KEYBOARD_INPUT])},y=!1,b=function(){y=!0,g(),n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.minWidth="100%",n.style.minHeight="100%",n.style.maxWidth="100%",n.style.maxHeight="100%"},w=function(){y=!1,n.removeAttribute("style"),m()},E=function(){y?w():b()},S=function(){return y},x=function(e){e<0&&(e=0);switch(e){case"auto":s?c=s:c=function(e){setTimeout(e,1e3/60)};break;case 0:c=function(e){};break;default:c=function(t){setTimeout(t,1e3/e)}}},T=function(){return 1/l},N;window.performance&&window.performance.now?N=function(){return window.performance.now()*.001}:window.performance&&window.performance.webkitNow?N=function(){return window.performance.webkitNow()*.001}:N=function(){return(new Date).getTime()*.001};var C=function(){return u},k=function(){return N()-u},L=function(){return l};Object.defineProperty(e,"setDesiredFPS",{value:x}),Object.defineProperty(e,"enterFullscreen",{value:b}),Object.defineProperty(e,"exitFullscreen",{value:w}),Object.defineProperty(e,"toggleFullscreen",{value:E}),Object.defineProperty(e,"isFullscreen",{get:S}),Object.defineProperty(e,"time",{get:N}),Object.defineProperty(e,"startTime",{get:C}),Object.defineProperty(e,"runTime",{get:k}),Object.defineProperty(e,"deltaTime",{get:L}),Object.defineProperty(e,"fps",{get:T}),x("auto"),e.setup.apply(e),e.onReposition.apply(e,[p,h]),e.onResize.apply(e,[h,p]),u=N(),a=u,f=0,l,A()};return u}),require(["App","happy/app/Runner"],function(e,t){var n=new e;n.container=document.body;var r=new t(n)}),define("main",function(){});